/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t={6182:(e,t,a)=>{"use strict";a.d(t,{v:()=>s,w:()=>r});const s=e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey,r=(e,t)=>{let a=e;do{var s,r;if("a"===(null===(s=a)||void 0===s?void 0:s.tagName.toLowerCase()))return a;const e=null===(r=a)||void 0===r?void 0:r.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)}},3528:(e,t,a)=>{"use strict";a.d(t,{V:()=>l});var s=a(3185),r=a(4286),n=a(1243),i=a(6182),o=a(6791);const c={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},p=({children:e,navigateToUrl:t,currentAppId:a,...n})=>{const p=(0,r.useRef)(null),l=(0,r.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:s})=>{if(!t||!s)return;const r=e.target,n=(0,i.w)(r,t);if(!n)return;const o=n.href,c=""===n.target||"_self"===n.target,p=0===e.button;o&&c&&p&&!e.defaultPrevented&&!(0,i.v)(e)&&(e.preventDefault(),a(n.href))})({event:e,currentAppId:a,navigateToUrl:t,container:p.current})),[a,t]);return(0,o.jsx)("div",(0,s.default)({onClick:l,ref:p,css:c,"data-test-subj":"kbnRedirectAppLink"},n),e)},l=({children:e,...t})=>(0,o.jsx)(p,(0,s.default)({},(0,n.A$)(),t),e)},1243:(e,t,a)=>{"use strict";a.d(t,{A$:()=>l,gx:()=>c,m4:()=>p});var s=a(4286),r=a.n(s),n=a(7880),i=a(6791);const o=r().createContext(null),c=({children:e,...t})=>{const{navigateToUrl:a,currentAppId:s}=t;return(0,i.jsx)(o.Provider,{value:{navigateToUrl:a,currentAppId:s}},e)},p=({children:e,coreStart:t})=>{const{navigateToUrl:a,currentAppId$:s}=t.application,r=(0,n.A)(s,void 0);return(0,i.jsx)(o.Provider,{value:{navigateToUrl:a,currentAppId:r}},e)};function l(){const e=(0,s.useContext)(o);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}},2787:(e,t,a)=>{"use strict";a.d(t,{Bo:()=>h,Du:()=>u,E5:()=>o,FK:()=>s,O1:()=>i,O8:()=>d,eW:()=>n,f8:()=>g,fd:()=>p,i3:()=>l,wU:()=>c,wY:()=>r});const s="default",r="*",n="?",i=8,o=2,c="/spaces/enter",p="classic",l="all",u="read",d="custom",h={public:{v1:"2023-10-31"}},g="showSpaceSolutionTour"},3216:(e,t,a)=>{"use strict";a.r(t),a.d(t,{API_VERSIONS:()=>r.Bo,DEFAULT_SPACE_ID:()=>r.FK,ENTER_SPACE_PATH:()=>r.wU,MAX_SPACE_INITIALS:()=>r.E5,SPACE_SEARCH_COUNT_THRESHOLD:()=>r.O1,addSpaceIdToPath:()=>p,getRouteUrlForSpace:()=>n,getSpaceIdFromPath:()=>c,isReservedSpace:()=>s.N});var s=a(6514),r=a(2787);function n(e,t){return t?`/s/${t}${e}`:e}const i="default",o=/^\/s\/([a-z0-9_\-]+)/;function c(e,t){null==e&&(e="/"),null==t&&(t="/");const a=function(e,t){return t&&"/"!==t&&e.startsWith(t)?e.substr(t.length):e}(e,t),s=a.match(o);if(!s||0===s.length)return{spaceId:i,pathHasExplicitSpaceIdentifier:!1};const[,r]=s;if(!r)throw new Error(`Unable to determine Space ID from request path: ${e}`);return{spaceId:r,pathHasExplicitSpaceIdentifier:!0}}function p(e="/",t="",a=""){if(a&&!a.startsWith("/"))throw new Error("path must start with a /");const s=e.endsWith("/")?e.slice(0,-1):e;return t&&t!==i?`${s}/s/${t}${a}`:`${s}${a}`||"/"}},6514:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});var s=a(770);function r(e){return(0,s.get)(e,"_reserved",!1)}},4023:(e,t,a)=>{"use strict";a.d(t,{q:()=>n,v:()=>i});var s=a(5008);let r;const n=()=>(r||(r=s.i18n.translate("xpack.spaces.featureDescription",{defaultMessage:"Organize Kibana into spaces with dedicated navigation, privileges and objects."})),r),i=s.i18n.translate("xpack.spaces.shareToSpace.objectNoun",{defaultMessage:"object"})},9613:(e,t,a)=>{"use strict";a.d(t,{l:()=>r}),a(4286);var s=a(6791);const r=async()=>{const{CopyToSpaceFlyoutInternal:e}=await a.e(158).then(a.bind(a,158));return t=>(0,s.jsx)(e,t)}},4301:(e,t,a)=>{"use strict";a.r(t),a.d(t,{getSpaceColor:()=>D.As,getSpaceImageUrl:()=>D.bp,getSpaceInitials:()=>D.qJ,plugin:()=>z});var s=a(8915),r=a(190),n=a(3721);let i=function(e){return e.SPACE_SOLUTION_CHANGED="space_solution_changed",e.SPACE_CHANGED="space_changed",e}({}),o=function(e){return e.ACTION="action",e.SPACE_ID="space_id",e.SPACE_ID_PREV="space_id_prev",e.SOLUTION="solution",e.SOLUTION_PREV="solution_prev",e}({});class EventTracker{constructor(e){this.analytics=e}track(e,t){try{this.analytics.reportEvent(e,t)}catch(e){n.error(e)}}spaceSolutionChanged({spaceId:e,action:t,solution:a,solutionPrev:s}){this.track(i.SPACE_SOLUTION_CHANGED,{[o.SPACE_ID]:e,[o.SOLUTION]:a,[o.SOLUTION_PREV]:s,[o.ACTION]:t})}changeSpace({prevSpaceId:e,prevSolution:t,nextSpaceId:a,nextSolution:s}){this.track(i.SPACE_CHANGED,{[o.SPACE_ID]:a,[o.SPACE_ID_PREV]:e,[o.SOLUTION]:s,[o.SOLUTION_PREV]:t})}}const c={[o.SPACE_ID]:{[o.SPACE_ID]:{type:"keyword",_meta:{description:"The ID of the space."}}},[o.SPACE_ID_PREV]:{[o.SPACE_ID_PREV]:{type:"keyword",_meta:{description:"The previous ID of the space (before switching space)."}}},[o.SOLUTION]:{[o.SOLUTION]:{type:"keyword",_meta:{description:"The solution set for the space."}}},[o.SOLUTION_PREV]:{[o.SOLUTION_PREV]:{type:"keyword",_meta:{description:"The previous solution value before editing the space.",optional:!0}}},[o.ACTION]:{[o.ACTION]:{type:"keyword",_meta:{description:"The user action, either create or edit a space."}}}},p=[{eventType:i.SPACE_SOLUTION_CHANGED,schema:{...c[o.SPACE_ID],...c[o.SOLUTION_PREV],...c[o.SOLUTION],...c[o.ACTION]}},{eventType:i.SPACE_CHANGED,schema:{...c[o.SPACE_ID],...c[o.SPACE_ID_PREV],...c[o.SOLUTION_PREV],...c[o.SOLUTION]}}];var l=a(5008),u=a(4023),d=a(4286),h=a.n(d),g=a(2874),S=a.n(g);const v=__kbnSharedDeps__.ReactRouterDom;var f=a(409),b=a(3528),_=a(1243),y=a(6791);const m=({children:e,...t})=>{if((e=>void 0!==e.coreStart)(t)){const{coreStart:a,...s}=t,r=(0,y.jsx)(b.V,s,e);return(0,y.jsx)(_.m4,{coreStart:a},r)}const{navigateToUrl:a,currentAppId:s,...r}=t,n=(0,y.jsx)(b.V,r,e);return(0,y.jsx)(_.gx,{currentAppId:s,navigateToUrl:a},n)},w=__kbnSharedDeps__.KbnSharedUxRouter,x=Object.freeze({id:"spaces",create({getStartServices:e,spacesManager:t,config:s,logger:r,eventTracker:n,getIsRoleManagementEnabled:i,getRolesAPIClient:o,getPrivilegesAPIClient:c,isServerless:p,getSecurityLicense:u}){const d=l.i18n.translate("xpack.spaces.displayName",{defaultMessage:"Spaces"});return{id:this.id,order:2,title:d,async mount({element:h,setBreadcrumbs:S,history:b}){const[[_,{features:x}],{SpacesGridPage:T},{CreateSpacePage:A},{EditSpacePage:P}]=await Promise.all([e(),a.e(2).then(a.bind(a,8002)),Promise.all([a.e(346),a.e(804)]).then(a.bind(a,8804)),a.e(338).then(a.bind(a,6338))]),C={text:d,href:"/"},{notifications:E,application:I,chrome:k,http:j,overlays:O,docLinks:M}=_,L=M.links.security.enableElasticSearchSecurityFeatures;return k.docTitle.change(d),(0,g.render)(_.rendering.addContext((0,y.jsx)(f.KibanaContextProvider,{services:_},(0,y.jsx)(m,{coreStart:_},(0,y.jsx)(w.Router,{history:b},(0,y.jsx)(w.Routes,null,(0,y.jsx)(w.Route,{path:["","/"],exact:!0},(0,y.jsx)((()=>(S([{...C,href:void 0}]),(0,y.jsx)(T,{capabilities:I.capabilities,getFeatures:x.getFeatures,notifications:E,spacesManager:t,serverBasePath:j.basePath.serverBasePath,history:b,getUrlForApp:I.getUrlForApp,maxSpaces:s.maxSpaces,allowSolutionVisibility:s.allowSolutionVisibility,isServerless:p}))),null)),(0,y.jsx)(w.Route,{path:"/create"},(0,y.jsx)((()=>(S([C,{text:l.i18n.translate("xpack.spaces.management.createSpaceBreadcrumb",{defaultMessage:"Create"})}]),(0,y.jsx)(A,{capabilities:I.capabilities,getFeatures:x.getFeatures,notifications:E,spacesManager:t,history:b,allowFeatureVisibility:s.allowFeatureVisibility,allowSolutionVisibility:s.allowSolutionVisibility,eventTracker:n}))),null)),(0,y.jsx)(w.Route,{path:["/edit/:spaceId","/edit/:spaceId/:selectedTabId"],exact:!0},(0,y.jsx)((()=>{const{spaceId:e,selectedTabId:a}=(0,v.useParams)(),n=e=>l.i18n.translate("xpack.spaces.management.editSpaceBreadcrumb",{defaultMessage:'Edit "{space}"',values:{space:e.name}});return(0,y.jsx)(P,{capabilities:I.capabilities,getUrlForApp:I.getUrlForApp,navigateToUrl:I.navigateToUrl,getSecurityLicense:u,serverBasePath:j.basePath.serverBasePath,getFeatures:x.getFeatures,http:j,overlays:O,notifications:E,userProfile:_.userProfile,theme:_.theme,i18n:_.i18n,logger:r,spacesManager:t,spaceId:e,onLoadSpace:e=>{S([C,{text:n(e)}])},history:b,selectedTabId:a,getIsRoleManagementEnabled:i,getRolesAPIClient:o,allowFeatureVisibility:s.allowFeatureVisibility,allowSolutionVisibility:s.allowSolutionVisibility,getPrivilegesAPIClient:c,enableSecurityLink:L})}),null))))))),h),()=>{k.docTitle.reset(),(0,g.unmountComponentAtNode)(h)}}}}});class ManagementService{constructor(){(0,s.default)(this,"registeredSpacesManagementApp",void 0)}setup({getStartServices:e,management:t,spacesManager:a,config:s,logger:r,getIsRoleManagementEnabled:n,getRolesAPIClient:i,eventTracker:o,getPrivilegesAPIClient:c,isServerless:p,getSecurityLicense:l}){this.registeredSpacesManagementApp=t.sections.section.kibana.registerApp(x.create({getStartServices:e,spacesManager:a,config:s,logger:r,getIsRoleManagementEnabled:n,getRolesAPIClient:i,eventTracker:o,getPrivilegesAPIClient:c,isServerless:p,getSecurityLicense:l}))}stop(){this.disableSpacesApp()}disableSpacesApp(){this.registeredSpacesManagementApp&&this.registeredSpacesManagementApp.disable()}}var T=a(1319),A=a(3530),P=a(3803),C=a(4350);const E=Object.freeze({id:"space_selector",create({application:e,getStartServices:t,spacesManager:s}){e.register({id:this.id,title:l.i18n.translate("xpack.spaces.spaceSelector.appTitle",{defaultMessage:"Select a space"}),chromeless:!0,appRoute:"/spaces/space_selector",mount:async({element:e})=>{const[[r],{renderSpaceSelectorApp:n}]=await Promise.all([t(),a.e(905).then(a.bind(a,5011))]);return n(r,{element:e},{spacesManager:s,serverBasePath:r.http.basePath.serverBasePath,customBranding$:r.customBranding.customBranding$})}})}});const I=a(3216).API_VERSIONS.public.v1;class SpacesManager{constructor(e){(0,s.default)(this,"activeSpace$",new r.BehaviorSubject(null)),(0,s.default)(this,"serverBasePath",void 0),(0,s.default)(this,"_onActiveSpaceChange$",void 0),this.http=e,this.serverBasePath=e.basePath.serverBasePath,this._onActiveSpaceChange$=this.activeSpace$.asObservable().pipe((0,r.skipWhile)((e=>null==e)))}get onActiveSpaceChange$(){return this.activeSpace$.value||this.refreshActiveSpace(),this._onActiveSpaceChange$}async getSpaces(e={}){const{purpose:t,includeAuthorizedPurposes:a}=e,s={purpose:t,include_authorized_purposes:a};return await this.http.get("/api/spaces/space",{query:s,version:I})}async getSpace(e){return await this.http.get(`/api/spaces/space/${encodeURIComponent(e)}`,{version:I})}async getActiveSpace({forceRefresh:e=!1}={}){if(this.isAnonymousPath())throw new Error("Cannot retrieve the active space for anonymous paths");return!e&&this.activeSpace$.value||await this.refreshActiveSpace(),this.activeSpace$.value}async createSpace(e){await this.http.post("/api/spaces/space",{body:JSON.stringify(e),version:I})}async updateSpace(e){await this.http.put(`/api/spaces/space/${encodeURIComponent(e.id)}`,{query:{overwrite:!0},body:JSON.stringify(e),version:I});const t=(await this.getActiveSpace()).id;e.id===t&&this.refreshActiveSpace()}async deleteSpace(e){await this.http.delete(`/api/spaces/space/${encodeURIComponent(e.id)}`,{version:I})}async disableLegacyUrlAliases(e){await this.http.post("/api/spaces/_disable_legacy_url_aliases",{body:JSON.stringify({aliases:e})})}async copySavedObjects(e,t,a,s,r){return this.http.post("/api/spaces/_copy_saved_objects",{body:JSON.stringify({objects:e,spaces:t,includeReferences:a,createNewCopies:s,...s?{overwrite:!1}:{overwrite:r}})})}async resolveCopySavedObjectsErrors(e,t,a,s){return this.http.post("/api/spaces/_resolve_copy_saved_objects_errors",{body:JSON.stringify({objects:e,includeReferences:a,createNewCopies:s,retries:t})})}async getShareSavedObjectPermissions(e){return this.http.get("/internal/security/_share_saved_object_permissions",{query:{type:e}}).catch((e=>{var t;if(404===(null==e||null===(t=e.body)||void 0===t?void 0:t.statusCode))return{shareToAllSpaces:!0};throw e}))}async getShareableReferences(e){const t=await this.http.post("/api/spaces/_get_shareable_references",{body:JSON.stringify({objects:e})}),a=e.reduce(((e,{type:t,id:a})=>e.add(`${t}:${a}`)),new Set);return{objects:t.objects.filter((({type:e,id:t})=>"tag"!==e||a.has(`${e}:${t}`)))}}async updateSavedObjectsSpaces(e,t,a){return this.http.post("/api/spaces/_update_objects_spaces",{body:JSON.stringify({objects:e,spacesToAdd:t,spacesToRemove:a})})}redirectToSpaceSelector(){window.location.href=`${this.serverBasePath}/spaces/space_selector`}async refreshActiveSpace(){if(this.isAnonymousPath())return;const e=await this.http.get("/internal/spaces/_active_space");this.activeSpace$.next(e)}isAnonymousPath(){return this.http.anonymousPaths.isAnonymous(window.location.pathname)}getContentForSpace(e){return this.http.get(`/internal/spaces/${e}/content_summary`)}getRolesForSpace(e){return this.http.get(`/internal/security/roles/${e}`)}}var k=a(6524),j=a.n(k);class SuspenseErrorBoundary extends d.Component{constructor(...e){super(...e),(0,s.default)(this,"state",{error:null})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e){const{notifications:t}=this.props;if(t){const a=l.i18n.translate("xpack.spaces.uiApi.errorBoundaryToastTitle",{defaultMessage:"Failed to load Kibana asset"}),s=l.i18n.translate("xpack.spaces.uiApi.errorBoundaryToastMessage",{defaultMessage:"Reload page to continue."});t.toasts.addError(e,{title:a,toastMessage:s})}}render(){const{children:e,notifications:t,showLoadingSpinner:a=!0}=this.props,{error:s}=this.state;if(!t||s)return null;const r=a?(0,y.jsx)(T.EuiLoadingSpinner,null):null;return(0,y.jsx)(d.Suspense,{fallback:r},e)}}const O=({fn:e,getStartServices:t,showLoadingSpinner:a,props:s})=>{const{value:r=[{notifications:void 0}]}=j()(t),[{notifications:n}]=r,i=(0,d.useMemo)((()=>(0,d.lazy)((()=>e().then((e=>({default:e})))))),[e]);return n?(0,y.jsx)(SuspenseErrorBoundary,{notifications:n,showLoadingSpinner:a},(0,y.jsx)(i,s)):null};var M=a(9613),L=a(3185);function R(e){return async function({path:t,aliasPurpose:a,objectNoun:s=u.v}){const[{notifications:n,application:i}]=await e(),{currentAppId$:o,navigateToApp:c}=i,p=await o.pipe((0,r.first)()).toPromise();if("savedObjectConversion"===a){const e=l.i18n.translate("xpack.spaces.redirectLegacyUrlToast.title",{defaultMessage:"We redirected you to a new URL"}),t=l.i18n.translate("xpack.spaces.redirectLegacyUrlToast.text",{defaultMessage:"The {objectNoun} you're looking for has a new location. Use this URL from now on.",values:{objectNoun:s}});n.toasts.addInfo({title:e,text:t})}await c(p,{replace:!0,path:t})}}var U=a(770);const N=async()=>{const{ShareToSpaceFlyoutInternal:e}=await a.e(290).then(a.bind(a,8290));return h().memo((t=>(0,y.jsx)(e,t)),((e,t)=>e.behaviorContext===t.behaviorContext&&e.savedObjectTarget.id===t.savedObjectTarget.id&&e.savedObjectTarget.type===t.savedObjectTarget.type&&(0,U.isEqual)(e.savedObjectTarget.namespaces,t.savedObjectTarget.namespaces)))};var D=a(2778);const $=async()=>{const{SpaceListInternal:e}=await a.e(843).then(a.bind(a,3843));return t=>(0,y.jsx)(e,t)};var V=a(7841);const B=({spacesManager:e,getStartServices:t})=>{function s(e,a={}){const{showLoadingSpinner:s}=a;return a=>(0,y.jsx)(O,{fn:e,getStartServices:t,props:a,showLoadingSpinner:s})}return{getSpacesContextProvider:s((()=>(0,V.b)({spacesManager:e,getStartServices:t}))),getShareToSpaceFlyout:s(N,{showLoadingSpinner:!1}),getCopyToSpaceFlyout:s(M.l,{showLoadingSpinner:!1}),getSpaceList:s($),getEmbeddableLegacyUrlConflict:s((()=>(async e=>{const{EmbeddableLegacyUrlConflictInternal:t}=await a.e(580).then(a.bind(a,9580));return a=>(0,y.jsx)(t,(0,L.default)({},e,a))})({spacesManager:e,getStartServices:t}))),getLegacyUrlConflict:s((()=>(async e=>{const{LegacyUrlConflictInternal:t}=await a.e(710).then(a.bind(a,7710));return a=>(0,y.jsx)(t,(0,L.default)({},e,a))})({getStartServices:t}))),getSpaceAvatar:s(D.nn)}},F=({spacesManager:e,getStartServices:t})=>({components:B({spacesManager:e,getStartServices:t}),redirectLegacyUrl:R(t),useSpaces:V.j});class SpacesPlugin{constructor(e){(0,s.default)(this,"spacesManager",void 0),(0,s.default)(this,"spacesApi",void 0),(0,s.default)(this,"solutionViewTourManager",void 0),(0,s.default)(this,"eventTracker",void 0),(0,s.default)(this,"managementService",void 0),(0,s.default)(this,"config",void 0),(0,s.default)(this,"isServerless",void 0),this.initializerContext=e,this.config=this.initializerContext.config.get(),this.isServerless="serverless"===this.initializerContext.env.packageInfo.buildFlavor}setup(e,t){if(void 0===this.config.allowSolutionVisibility)throw new Error("allowSolutionVisibility has not been set in the Spaces plugin config.");const a=1===this.config.maxSpaces;if(this.spacesManager=new SpacesManager(e.http),this.solutionViewTourManager=new C.I((()=>e.getStartServices().then((([e])=>e))),this.spacesManager),this.spacesApi={ui:F({spacesManager:this.spacesManager,getStartServices:e.getStartServices}),getActiveSpace$:()=>this.spacesManager.onActiveSpaceChange$,getActiveSpace:()=>this.spacesManager.getActiveSpace(),hasOnlyDefaultSpace:a,isSolutionViewEnabled:this.config.allowSolutionVisibility,solutionViewTourManager:this.solutionViewTourManager},function(e){const{analytics:t}=e;for(const e of p)t.registerEventType(e)}(e),this.eventTracker=new EventTracker(e.analytics),!this.isServerless||!a){const a=async()=>{const{security:t}=await e.plugins.onSetup("security");if(!t.found)throw new Error("Security plugin is not available as runtime dependency.");return t.contract.authz.isRoleManagementEnabled},s=async()=>{const{security:t}=await e.plugins.onSetup("security");if(!t.found)throw new Error("Security plugin is not available as runtime dependency.");return t.contract.authz.roles},r=async()=>{const{security:t}=await e.plugins.onSetup("security");if(!t.found)throw new Error("Security plugin is not available as runtime dependency.");return t.contract.authz.privileges},n=async()=>{const{security:t}=await e.plugins.onSetup("security");if(!t.found)throw new Error("Security plugin is not available as runtime dependency.");return t.contract.license};t.home&&t.home.featureCatalogue.register({id:"spaces",title:l.i18n.translate("xpack.spaces.spacesTitle",{defaultMessage:"Spaces"}),description:(0,u.q)(),icon:"spacesApp",path:"/app/management/kibana/spaces",showOnHomePage:!1,category:"admin"}),t.management&&(this.managementService=new ManagementService,this.managementService.setup({management:t.management,getStartServices:e.getStartServices,spacesManager:this.spacesManager,config:this.config,logger:this.initializerContext.logger.get(),getIsRoleManagementEnabled:a,getRolesAPIClient:s,eventTracker:this.eventTracker,getPrivilegesAPIClient:r,isServerless:this.isServerless,getSecurityLicense:n})),E.create({getStartServices:e.getStartServices,application:e.application,spacesManager:this.spacesManager})}var s,n;return s=e.analytics,n=this.spacesManager.onActiveSpaceChange$,s.registerContextProvider({name:"Spaces Metadata",context$:n.pipe((0,r.map)((e=>({spaceSolution:e.solution})))),schema:{spaceSolution:{type:"keyword",_meta:{description:"The Space solution view",optional:!0}}}}),{hasOnlyDefaultSpace:a,isSolutionViewEnabled:this.config.allowSolutionVisibility}}start(e){return this.isServerless&&1===this.config.maxSpaces||function(e,t,s,r,n){const i=new A.QueryClient({defaultOptions:{queries:{staleTime:0,networkMode:"always"}}});t.chrome.navControls.registerLeft({order:1e3,mount(o){if(t.http.anonymousPaths.isAnonymous(window.location.pathname))return()=>null;const c=(0,d.lazy)((()=>a.e(939).then(a.bind(a,3939)).then((({NavControlPopover:e})=>({default:e})))));return S().render(t.rendering.addContext((0,y.jsx)(A.QueryClientProvider,{client:i},(0,y.jsx)(d.Suspense,{fallback:(0,y.jsx)(T.EuiSkeletonRectangle,{css:(0,y.css)("margin-inline:",P.euiThemeVars.euiSizeS,";",""),borderRadius:"m",contentAriaLabel:"Loading navigation"})},(0,y.jsx)(c,{spacesManager:e,serverBasePath:t.http.basePath.serverBasePath,anchorPosition:"downLeft",capabilities:t.application.capabilities,navigateToApp:t.application.navigateToApp,navigateToUrl:t.application.navigateToUrl,allowSolutionVisibility:s.allowSolutionVisibility,eventTracker:r,showTour$:n.showTour$,onFinishTour:()=>n.finishTour(),manageSpacesDocsLink:t.docLinks.links.spaces.kibanaManageSpaces,manageSpacesLink:t.http.basePath.prepend("/app/management/kibana/spaces")})))),o),()=>{S().unmountComponentAtNode(o)}}})}(this.spacesManager,e,this.config,this.eventTracker,this.solutionViewTourManager),this.spacesApi}stop(){this.managementService&&(this.managementService.stop(),this.managementService=void 0)}}const z=e=>new SpacesPlugin(e)},4350:(e,t,a)=>{"use strict";a.d(t,{V:()=>b,I:()=>TourManager});var s=a(8915),r=a(190),n=a(2787);class TourManager{constructor(e,t){(0,s.default)(this,"tourState$",new r.BehaviorSubject("not_started")),(0,s.default)(this,"showTour$",this.tourState$.pipe((0,r.map)((e=>"in_progress"===e)))),this.core=e,this.spacesManager=t}async startTour(){const e=await this.core();return!i(e)||o(e)?{result:"not_available"}:await p(this.spacesManager)?(this.tourState$.next("in_progress"),{result:"started"}):(await c(e),{result:"not_available"})}async finishTour(){this.tourState$.next("ended"),await c(await this.core())}async waitForTourEnd(){return(0,r.firstValueFrom)(this.tourState$.pipe((0,r.first)((e=>"ended"===e)),(0,r.map)((()=>{}))))}}const i=e=>{var t;return!0===(null===(t=e.application.capabilities.spaces)||void 0===t?void 0:t.manage)},o=e=>!1===e.settings.globalClient.get(n.f8),c=async e=>{try{await e.settings.globalClient.set(n.f8,!1)}catch(e){}},p=async e=>{try{const t=await e.getSpaces();if(t.length>1)return!1;const a=t.find((e=>e.id===n.FK));return!!a&&!(!a.solution||a.solution===n.fd)}catch(e){return!1}};var l=a(1319),u=a(4286),d=a.n(u),h=a(5008),g=a(5879),S=a(6182),v=a(6791);const f={es:h.i18n.translate("xpack.spaces.navControl.tour.esSolution",{defaultMessage:"Elasticsearch"}),security:h.i18n.translate("xpack.spaces.navControl.tour.securitySolution",{defaultMessage:"Elastic Security"}),oblt:h.i18n.translate("xpack.spaces.navControl.tour.obltSolution",{defaultMessage:"Elastic Observability"}),chat:h.i18n.translate("xpack.spaces.navControl.tour.chatSolution",{defaultMessage:"Elastic Workchat"})},b=({children:e,solution:t,isTourOpen:a,onFinishTour:s,manageSpacesLink:r,manageSpacesDocsLink:i,navigateToUrl:o})=>{const c=t&&t!==n.fd?f[t]:"";return c?(0,v.jsx)(l.EuiTourStep,{content:(0,v.jsx)(l.EuiText,{size:"s"},(0,v.jsx)("p",null,(0,v.jsx)(g.FormattedMessage,{id:"xpack.spaces.navControl.tour.content",defaultMessage:"Only {solution} features are visible.{br}To access feature from other solutions, edit your {spacesLink} or create new spaces.{br}{learnMore}",values:{solution:c,spacesLink:(0,v.jsx)(l.EuiLink,{href:r,onClick:e=>{(0,S.v)(e)||(e.preventDefault(),s(),o(r))}},h.i18n.translate("xpack.spaces.navControl.tour.spaceSettingsLink",{defaultMessage:"space settings"})),learnMore:(0,v.jsx)(l.EuiLink,{href:i,target:"_blank",external:!0},h.i18n.translate("xpack.spaces.navControl.tour.learnMore",{defaultMessage:"Learn more"})),br:(0,v.jsx)("br",null)}}))),isStepOpen:a,minWidth:300,maxWidth:360,onFinish:s,step:1,stepsTotal:1,repositionOnScroll:!0,title:h.i18n.translate("xpack.spaces.navControl.tour.title",{defaultMessage:"This space uses the {solution} solution view",values:{solution:c}}),anchorPosition:"downCenter",footerAction:[(0,v.jsx)(l.EuiButtonEmpty,{size:"s",color:"text",onClick:s,"data-test-subj":"closeTourBtn"},h.i18n.translate("xpack.spaces.navControl.tour.closeBtn",{defaultMessage:"Close"}))],panelProps:{"data-test-subj":"spaceSolutionTour"}},(0,v.jsx)(d().Fragment,null,e)):e}},2778:(e,t,a)=>{"use strict";a.d(t,{nn:()=>r,As:()=>n.As,bp:()=>n.bp,qJ:()=>n.qJ}),a(4286);var s=a(6791);const r=async()=>{const{SpaceAvatarInternal:e}=await a.e(713).then(a.bind(a,6713));return t=>(0,s.jsx)(e,t)};var n=a(5555)},5555:(e,t,a)=>{"use strict";a.d(t,{As:()=>i,bp:()=>c,qJ:()=>o});var s=a(1319),r=a(3216);const n=97;function i(e={}){const{color:t,name:a=""}=e;if(t)return t;const r=a.codePointAt(0)||n;return s.VISUALIZATION_COLORS[r%s.VISUALIZATION_COLORS.length]}function o(e={}){const{initials:t,name:a=""}=e;if(t)return t;const s=a.split(" "),n=Math.min(r.MAX_SPACE_INITIALS,s.length);return s.splice(n,s.length),s.map((e=>e.substring(0,1))).join("")}function c(e={}){const{imageUrl:t}=e;return t||""}},2813:(e,t,a)=>{"use strict";a.d(t,{Q:()=>l,j:()=>p});var s=a(4286),r=a.n(s);const{useContext:n,createElement:i,createContext:o}=r(),c=o({}),p=()=>n(c),l=(e,t,a)=>{const s={spacesManager:t,spacesDataPromise:a,services:e};return{value:s,Provider:({children:e})=>i(c.Provider,{value:s,children:e}),Consumer:c.Consumer}}},7841:(e,t,a)=>{"use strict";a.d(t,{b:()=>i,j:()=>s.j});var s=a(2813),r=a(3185),n=(a(4286),a(6791));const i=async e=>{const{SpacesContextWrapperInternal:t}=await a.e(97).then(a.bind(a,1097));return({children:a,...s})=>(0,n.jsx)(t,(0,r.default)({},e,s,{children:a}))}},6563:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNavigator=t.isBrowser=t.off=t.on=t.noop=void 0,t.noop=function(){},t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e&&e.addEventListener&&e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)},t.isBrowser="undefined"!=typeof window,t.isNavigator="undefined"!=typeof navigator},6943:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(4286),r=a(6563).isBrowser?s.useLayoutEffect:s.useEffect;t.default=r},7880:(e,t,a)=>{"use strict";var s=a(1941),r=a(4286),n=s.__importDefault(a(6943));t.A=function(e,t){var a=r.useState(t),s=a[0],i=a[1];return n.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),s}},6448:(e,t,a)=>{a.p=window.__kbnPublicPath__.spaces},8744:(e,t,a)=>{a.r(t);var s=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},9118:(e,t,a)=>{a.r(t);var s=__kbnBundles__.get("plugin/features/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},409:(e,t,a)=>{a.r(t);var s=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},3721:(e,t,a)=>{e.exports=a(2497)(4971)},3185:(e,t,a)=>{e.exports=a(2497)(51858)},8915:(e,t,a)=>{e.exports=a(2497)(67493)},5927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},5804:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaMount},1728:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxErrorBoundary},3803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},2874:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDom},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},6524:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useAsync},4048:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useAsyncFn},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},a={};function s(e){var r=a[e];if(void 0!==r)return r.exports;var n=a[e]={id:e,exports:{}};return t[e](n,n.exports,s),n.exports}s.m=t,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,a)=>(s.f[a](e,t),t)),[])),s.u=e=>"spaces.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},s.l=(t,a,r,n)=>{if(e[t])e[t].push(a);else{var i,o;if(void 0!==r)for(var c=document.getElementsByTagName("script"),p=0;p<c.length;p++){var l=c[p];if(l.getAttribute("src")==t){i=l;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.src=t),e[t]=[a];var u=(a,s)=>{i.onerror=i.onload=null,clearTimeout(d);var r=e[t];if(delete e[t],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((e=>e(s))),a)return a(s)},d=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),o&&document.head.appendChild(i)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=a[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={494:0};s.f.j=(t,a)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var n=new Promise(((a,s)=>r=e[t]=[a,s]));a.push(r[2]=n);var i=s.p+s.u(t),o=new Error;s.l(i,(a=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var n=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",o.name="ChunkLoadError",o.type=n,o.request=i,r[1](o)}}),"chunk-"+t,t)}};var t=(t,a)=>{var r,n,[i,o,c]=a,p=0;if(i.some((t=>0!==e[t]))){for(r in o)s.o(o,r)&&(s.m[r]=o[r]);c&&c(s)}for(t&&t(a);p<i.length;p++)n=i[p],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},a=self.spaces_bundle_jsonpfunction=self.spaces_bundle_jsonpfunction||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),s.nc=void 0,s(6448),__kbnBundles__.define("plugin/spaces/public",s,4301),__kbnBundles__.define("plugin/spaces/common",s,3216)})();