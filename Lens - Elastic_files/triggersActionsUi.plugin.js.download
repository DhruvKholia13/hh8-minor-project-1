/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,a,r={6878:(e,t,a)=>{"use strict";a.d(t,{GI:()=>l,t9:()=>s,w_:()=>i,n3:()=>n});var r=a(5008);const s=Object.freeze({id:"recovered",name:r.i18n.translate("alertingTypes.builtinActionGroups.recovered",{defaultMessage:"Recovered"})}),n="Error validating circuit breaker";let i=function(e){return e.CHANGE="onActionGroupChange",e.ACTIVE="onActiveAlert",e.THROTTLE="onThrottleInterval",e}({});const l=[1,2,3,4,5,6,7]},6252:(e,t,a)=>{"use strict";a.d(t,{FQ:()=>X.F,_S:()=>V,GA:()=>J,AT:()=>h,FI:()=>te,x1:()=>G,UZ:()=>I,kU:()=>Q,A0:()=>ee.A,h0:()=>pe,Cr:()=>ce,D4:()=>B.Wp,Y8:()=>ge.Y,Hl:()=>B.Hl,ut:()=>B.ut});var r=a(3185),s=a(4286),n=a.n(s),i=a(5008),l=a(1319),o=a(454),u=a(6791);const c=i.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.activeLabel",{defaultMessage:"Active"}),d=i.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.recoveredLabel",{defaultMessage:"Recovered"}),p=i.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.flappingLabel",{defaultMessage:"Flapping"}),g=i.i18n.translate("alertsUIShared.components.alertLifecycleStatusBadge.untrackedLabel",{defaultMessage:"Untracked"}),h=(0,s.memo)((e=>{const{alertStatus:t,flapping:a}=e,{label:s,color:n,iconProps:i,isDisabled:h}=((e,t)=>e===o.AR?{label:g,color:"default",isDisabled:!0}:e===o.O3?{label:d,color:"success"}:t?{label:p,color:"danger",iconProps:{iconType:"visGauge"}}:{label:c,color:"danger"})(t,null!=a&&a);return(0,u.jsx)(l.EuiBadge,(0,r.default)({"data-test-subj":"alertLifecycleStatusBadge",isDisabled:h,color:n},i),s)}));let m=function(e){return e.Running="running",e.Upcoming="upcoming",e.Finished="finished",e.Archived="archived",e}({});var b=a(3530);const y=({http:e,notifications:{toasts:t}},{enabled:a})=>(0,b.useQuery)(["GET",f],(({signal:t})=>(async(e,t)=>(await e.fetch("/internal/alerting/rules/maintenance_window/_active",{method:"GET",signal:t})).map((e=>(({expiration_date:e,r_rule:t,created_by:a,updated_by:r,created_at:s,updated_at:n,event_start_time:i,event_end_time:l,category_ids:o,...u})=>({...u,expirationDate:e,rRule:t,createdBy:a,updatedBy:r,createdAt:s,updatedAt:n,eventStartTime:i,eventEndTime:l,categoryIds:o}))(e))))(e,t)),{enabled:a,refetchInterval:6e4,onError:e=>{t.addError(e,{title:v,toastMessage:S})}}),f="/internal/alerting/rules/maintenance_window/_active",v=i.i18n.translate("alertsUIShared.maintenanceWindowCallout.fetchError",{defaultMessage:"Failed to check if maintenance windows are active"}),S=i.i18n.translate("alertsUIShared.maintenanceWindowCallout.fetchErrorDescription",{defaultMessage:"Some rule notifications may be stopped while maintenance windows are running."}),_="maintenanceWindow",x=i.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowActiveDescription",{defaultMessage:"Some rule notifications may be stopped while maintenance windows are running."}),A=i.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowActiveNoCategories",{defaultMessage:"One or more maintenance windows are running"}),T=i.i18n.translate("alertsUIShared.maintenanceWindowCallout.maintenanceWindowPageLinkText",{defaultMessage:"Go to Maintenance Windows"}),E="/app/management/insightsAndAlerting/maintenanceWindows";function I({kibanaServices:e,categories:t}){var a,r;const{application:{capabilities:n},http:i}=e,o=!(null!==(a=n[_])&&void 0!==a&&a.show||null!==(r=n[_])&&void 0!==r&&r.save),{data:c=[]}=y(e,{enabled:!o}),d=(0,s.useMemo)((()=>!!c&&0!==c.length&&(!Array.isArray(t)||c.some((({status:e,categoryIds:a})=>e===m.Running&&(!Array.isArray(a)||a.some((e=>t.includes(e)))))))),[t,c]);if(o)return null;if(!d)return null;const p=(0,u.jsx)(l.EuiLink,{href:i.basePath.prepend(E),"data-test-subj":"maintenanceWindowPageLink"},T);return(0,u.jsx)(l.EuiCallOut,{title:A,color:"warning",iconType:"info","data-test-subj":"maintenanceWindowCallout"},x," ",p)}const w={truncatedText:(0,u.css)("text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:",2,";-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;","")},j=({text:e})=>(0,u.jsx)(l.EuiText,{size:"xs",color:"subdued",css:w.truncatedText},e);j.displayName="TruncatedText";const R=n().memo(j),C=i.i18n.translate("alertsUIShared.components.addMessageVariables.loadingMessage",{defaultMessage:"Loading variables"}),k=i.i18n.translate("alertsUIShared.components.addMessageVariables.noVariablesFound",{defaultMessage:"No variables found"}),F=i.i18n.translate("alertsUIShared.components.addMessageVariables.noVariablesAvailable",{defaultMessage:"No variables available"}),M=i.i18n.translate("alertsUIShared.components.addMessageVariables.deprecatedVariablesAreShown",{defaultMessage:"Deprecated variables are shown"}),O=i.i18n.translate("alertsUIShared.components.addMessageVariables.deprecatedVariablesAreHidden",{defaultMessage:"Deprecated variables are hidden"}),L=i.i18n.translate("alertsUIShared.components.addMessageVariables.hideDeprecatedVariables",{defaultMessage:"Hide"}),P=i.i18n.translate("alertsUIShared.components.addMessageVariables.showAllDeprecatedVariables",{defaultMessage:"Show all"}),U=i.i18n.translate("alertsUIShared.components.addMessageVariables.addVariablePopoverButton",{defaultMessage:"Add variable"}),D=i.i18n.translate("alertsUIShared.components.addMessageVariables.addRuleVariableTitle",{defaultMessage:"Add variable"}),V=({buttonTitle:e,messageVariables:t,paramsProperty:a,onSelectEventHandler:r,showButtonTitle:i=!1})=>{var o;const[c,d]=(0,s.useState)(!1),[p,g]=(0,s.useState)(!1),{euiTheme:h}=(0,l.useEuiTheme)(),m=(0,s.useMemo)((()=>null==t?void 0:t.reduce(((e,t)=>({...e,[t.name]:t})),{})),[t]),b=(0,s.useMemo)((()=>c?t:null==t?void 0:t.filter((e=>!e.deprecated))),[t,c]),y=(0,s.useMemo)((()=>null==b?void 0:b.map((e=>({label:e.name,...e.deprecated?{disabled:!0}:{},data:{description:e.description},"data-test-subj":`${e.name}-selectableOption`})))),[b]),f=null!=t&&t.length?e||D:F,v=(0,s.useMemo)((()=>i?(0,u.jsx)(l.EuiButtonEmpty,{id:`${a}AddVariableButton`,"data-test-subj":`${a}AddVariableButton-Title`,size:"xs",onClick:()=>g(!0),"aria-label":U,disabled:!(null!=t&&t.length)},f):(0,u.jsx)(l.EuiButtonIcon,{id:`${a}AddVariableButton`,"data-test-subj":`${a}AddVariableButton`,title:f,onClick:()=>g(!0),iconType:"indexOpen","aria-label":U,disabled:!(null!=t&&t.length)})),[f,null==t?void 0:t.length,a,i]);if(0===(null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0))return v;const S=({description:e,label:t})=>(0,u.jsx)(n().Fragment,null,(0,u.jsx)(l.EuiText,{size:"s",style:{fontWeight:h.font.weight.bold}},t),(0,u.jsx)(l.EuiSpacer,{size:"s"}),(0,u.jsx)("hr",null),(0,u.jsx)(l.EuiSpacer,{size:"s"}),(0,u.jsx)(l.EuiText,{size:"xs"},e));return(0,u.jsx)(l.EuiPopover,{button:v,isOpen:p,closePopover:()=>g(!1),panelPaddingSize:"s",anchorPosition:"upRight",panelStyle:{minWidth:350}},(0,u.jsx)(l.EuiSelectable,{searchable:!0,height:300,"data-test-subj":"messageVariablesSelectableList",isLoading:!1,options:y,listProps:{rowHeight:70,showIcons:!1,paddingSize:"none",textWrap:"wrap"},loadingMessage:C,noMatchesMessage:k,emptyMessage:F,renderOption:(e,t)=>(0,u.jsx)(l.EuiFlexGroup,{"data-test-subj":`variableMenuButton-${e.label}`},(0,u.jsx)(l.EuiFlexItem,null,(0,u.jsx)(l.EuiText,{size:"s",style:{fontWeight:h.font.weight.bold}},(0,u.jsx)(l.EuiHighlight,{search:t},e.label)),(0,u.jsx)(l.EuiSpacer,{size:"xs"}),e.description&&(0,u.jsx)(n().Fragment,null,(0,u.jsx)(l.EuiToolTip,{display:"block",position:"top",content:(0,u.jsx)(S,{description:e.description,label:e.label}),"data-test-subj":`${e.label}-tooltip`},(0,u.jsx)(R,{text:e.description||""}))))),onChange:e=>{e.map((e=>{"on"===e.checked&&m&&r(m[e.label])})),g(!1)},singleSelection:!0,searchProps:{"data-test-subj":"messageVariablesSelectableSearch"}},((e,t)=>(0,u.jsx)(n().Fragment,null,t,(0,u.jsx)(l.EuiSpacer,{size:"xs"}),e,(0,u.jsx)(l.EuiPopoverFooter,{style:{paddingTop:0,paddingBottom:0}},(0,u.jsx)(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween",responsive:!1,wrap:!0},(0,u.jsx)(l.EuiFlexItem,{grow:!1},(0,u.jsx)(l.EuiText,{color:"grey",size:"xs"},c?M:O)),(0,u.jsx)(l.EuiFlexItem,{grow:!1},(0,u.jsx)(l.EuiButtonEmpty,{"data-test-subj":"showDeprecatedVariablesButton",size:"xs",onClick:()=>d(!c)},c?L:P))))))))};var B=a(4490),N=a(2708);a(7346);const z=[],W=i.i18n.translate("alertsUIShared.component.alertsSearchBar.placeholder",{defaultMessage:"Search alerts (e.g. kibana.alert.evaluation.threshold > 75)"}),q={type:"alerts",fields:{}},G=({appName:e,disableQueryLanguageSwitcher:t=!1,ruleTypeIds:a=[],query:r,filters:n,onQueryChange:i,onQuerySubmit:l,onFiltersUpdated:o,rangeFrom:u,rangeTo:c,showFilterBar:d=!1,showDatePicker:p=!0,showSubmitButton:g=!0,placeholder:h=W,submitOnBlur:m=!1,http:b,toasts:y,unifiedSearchBar:f,dataService:v,fetchUnifiedAlertsFields:S=!1})=>{var _;const[x,A]=(0,s.useState)("kuery"),{dataView:T}=(0,B.Wp)({ruleTypeIds:a,http:b,toasts:y,dataViewsService:v.dataViews,fetchUnifiedAlertsFields:S}),{data:{fields:E}={}}=(0,B.YN)({http:b,ruleTypeIds:a,toasts:y},{enabled:S}),I=(0,s.useMemo)((()=>{var e;return a.length>0&&null!=T&&null!==(e=T.fields)&&void 0!==e&&e.length?[{title:a.join(","),fields:T.fields}]:T?[T]:null!=E&&E.length?[{title:a.length?a.join(","):"all-rule-types",fields:E}]:null}),[T,a,E]),w=null!==(_=null==a?void 0:a.some(N.L$))&&void 0!==_&&_,j=(0,s.useCallback)((({dateRange:e,query:t})=>{var a;l({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0}),A(null!==(a=null==t?void 0:t.language)&&void 0!==a?a:"kuery")}),[l,A]),R=(0,s.useCallback)((({dateRange:e,query:t})=>{var a;null==i||i({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0}),A(null!==(a=null==t?void 0:t.language)&&void 0!==a?a:"kuery")}),[i,A]);return f({appName:e,disableQueryLanguageSwitcher:t,indexPatterns:I||z,placeholder:h,query:{query:null!=r?r:"",language:x},filters:n,dateRangeFrom:u,dateRangeTo:c,displayStyle:"inPage",showFilterBar:d,onQuerySubmit:j,onFiltersUpdated:e=>{v.query.filterManager.setFilters(e),null==o||o(e)},onRefresh:({dateRange:e})=>{l({dateRange:e})},showDatePicker:p,showQueryInput:!0,allowSavingQueries:!0,showSubmitButton:g,submitOnBlur:m,onQueryChange:R,suggestionsAbstraction:w&&!S?void 0:q})},H=[25,50,100];var $=a(8915);class Storage{constructor(){(0,$.default)(this,"engine",window.localStorage),(0,$.default)(this,"prefix","tablePersist")}encode(e){return JSON.stringify(e)}decode(e){if("string"==typeof e)return JSON.parse(e)}encodeKey(e){return`${this.prefix}:${e}`}set(e,t){return this.engine.setItem(this.encodeKey(e),this.encode(t)),t}has(e){return null!=this.engine.getItem(this.encodeKey(e))}get(e,t){return this.has(e)?this.decode(this.engine.getItem(this.encodeKey(e))):t}}const K={box:{incremental:!0,placeholder:i.i18n.translate("alertsUIShared.alertFieldsTable.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."}),schema:!0}},Y=[{field:"key",name:i.i18n.translate("alertsUIShared.alertFieldsTable.field",{defaultMessage:"Field"}),width:"30%"},{field:"value",name:i.i18n.translate("alertsUIShared.alertFieldsTable.value",{defaultMessage:"Value"}),width:"70%"}],Q=e=>(0,u.jsx)(l.EuiTabbedContent,(0,r.default)({css:(0,u.css)("display:flex;flex-direction:column;flex:1;& [role='tabpanel']{display:flex;flex:1 0 0;",(0,l.useEuiOverflowScroll)("y",!0),";}","")},e)),Z=[25,50,100],J=(0,s.memo)((({alert:e,fields:t})=>{const{euiTheme:a}=(0,l.useEuiTheme)(),r=(0,l.useEuiFontSize)("xs").fontSize,{pageSize:n,sorting:i,onTableChange:o}=function({tableId:e,customOnTableChange:t,initialSort:a,initialPageSize:r,pageSizeOptions:n}){var i;const l=new Storage,o=l.get(e,void 0),{pageSize:u,sort:c}=((e,t)=>{const a=null==e?void 0:e.pageSize,r=null==e?void 0:e.sort;let s=a,n=r;if(a&&!t.includes(a)&&(s=void 0),r){const e=r.field,t=r.direction;"string"==typeof e&&["asc","desc"].includes(t)||(n=void 0)}return{pageSize:s,sort:n}})(o,null!=n?n:H),[d,p]=(0,s.useState)(null!==(i=null!=u?u:r)&&void 0!==i?i:50),[g,h]=(0,s.useState)(null!=c?c:a);return{pageSize:d,sorting:!g||{sort:g},onTableChange:(0,s.useCallback)((a=>{var r,s,n,i,o,d,g;let m;t&&t(a);const b=""===(null===(r=a.sort)||void 0===r||null===(s=r.field)||void 0===s?void 0:s.toString());null!==(n=a.sort)&&void 0!==n&&n.field&&null!==(i=a.sort)&&void 0!==i&&i.direction&&(m=a.sort),(null!==(o=a.sort)&&void 0!==o&&o.field||null!==(d=a.sort)&&void 0!==d&&d.direction)&&h(m);const y=null===(g=a.page)||void 0===g?void 0:g.size;if(y&&p(y),y&&y!==u||m&&m!==c||b){const t={pageSize:y,sort:m};l.set(e,t)}}),[t,l,u,c,e])}}({tableId:"obltAlertFields",initialPageSize:25}),c=(0,s.useMemo)((()=>{let a=Object.entries(e).map((([e,t])=>({key:e,value:t})));return null!=t&&t.length&&(a=a.filter((e=>t.includes(e.key)))),a}),[e,t]);return(0,u.jsx)(l.EuiInMemoryTable,{items:c,itemId:"key",columns:Y,onTableChange:o,pagination:{pageSize:n,pageSizeOptions:Z},sorting:i,search:K,css:(0,u.css)("& .euiTableRow{font-size:",r,";font-family:",a.font.familyCode,";}","")})}));var X=a(8190),ee=a(5406);let te=function(e){return e.ruleId="rule.id",e.ruleName="rule.name",e.ruleSpaceId="rule.spaceId",e.ruleTags="rule.tags",e.ruleType="rule.type",e.ruleUrl="rule.url",e.ruleParams="rule.params",e.date="date",e.alertId="alert.id",e.alertUuid="alert.uuid",e.alertActionGroup="alert.actionGroup",e.alertActionGroupName="alert.actionGroupName",e.alertActionSubgroup="alert.actionSubgroup",e.alertFlapping="alert.flapping",e.kibanaBaseUrl="kibanaBaseUrl",e.alertConsecutiveMatches="alert.consecutiveMatches",e}({}),ae=function(e){return e.alertId="alertId",e.alertName="alertName",e.alertInstanceId="alertInstanceId",e.alertActionGroup="alertActionGroup",e.alertActionGroupName="alertActionGroupName",e.alertActionSubgroup="alertActionSubgroup",e.tags="tags",e.spaceId="spaceId",e.params="params",e}({}),re=function(e){return e.newAlertsCount="alerts.new.count",e.newAlertsData="alerts.new.data",e.ongoingAlertsCount="alerts.ongoing.count",e.ongoingAlertsData="alerts.ongoing.data",e.recoveredAlertsCount="alerts.recovered.count",e.recoveredAlertsData="alerts.recovered.data",e.allAlertsCount="alerts.all.count",e.allAlertsData="alerts.all.data",e}({});const se=Object.freeze({[ae.alertId]:{description:i.i18n.translate("alertsUIShared.actionVariables.legacyAlertIdLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.ruleId}}),deprecated:!0},[ae.alertName]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacyAlertNameLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.ruleName}})},[ae.alertInstanceId]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacyAlertInstanceIdLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.alertId}})},[ae.alertActionGroup]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacyAlertActionGroupLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.alertActionGroup}})},[ae.alertActionGroupName]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacyAlertActionGroupNameLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.alertActionGroupName}})},[ae.tags]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacyTagsLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.ruleTags}})},[ae.spaceId]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacySpaceIdLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.ruleSpaceId}})},[ae.params]:{deprecated:!0,description:i.i18n.translate("alertsUIShared.actionVariables.legacyParamsLabel",{defaultMessage:"This has been deprecated in favor of {variable}.",values:{variable:te.ruleParams}})},[te.date]:{description:i.i18n.translate("alertsUIShared.actionVariables.dateLabel",{defaultMessage:"The date the rule scheduled the action."})},[te.kibanaBaseUrl]:{description:i.i18n.translate("alertsUIShared.actionVariables.kibanaBaseUrlLabel",{defaultMessage:"The configured server.publicBaseUrl value or empty string if not configured."})},[te.ruleId]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleIdLabel",{defaultMessage:"The ID of the rule."})},[te.ruleName]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleNameLabel",{defaultMessage:"The name of the rule."})},[te.ruleSpaceId]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleSpaceIdLabel",{defaultMessage:"The space ID of the rule."})},[te.ruleType]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleTypeLabel",{defaultMessage:"The type of rule."})},[te.ruleTags]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleTagsLabel",{defaultMessage:"The tags of the rule."})},[te.ruleParams]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleParamsLabel",{defaultMessage:"The parameters of the rule."})},[te.ruleUrl]:{description:i.i18n.translate("alertsUIShared.actionVariables.ruleUrlLabel",{defaultMessage:"The URL to the rule that generated the alert. This will be an empty string if the server.publicBaseUrl is not configured."}),usesPublicBaseUrl:!0},[te.alertId]:{description:i.i18n.translate("alertsUIShared.actionVariables.alertIdLabel",{defaultMessage:"The ID of the alert that scheduled actions for the rule."})},[te.alertUuid]:{description:i.i18n.translate("alertsUIShared.actionVariables.alertUuidLabel",{defaultMessage:"The UUID of the alert that scheduled actions for the rule."})},[te.alertActionGroup]:{description:i.i18n.translate("alertsUIShared.actionVariables.alertActionGroupLabel",{defaultMessage:"The action group of the alert that scheduled actions for the rule."})},[te.alertActionGroupName]:{description:i.i18n.translate("alertsUIShared.actionVariables.alertActionGroupNameLabel",{defaultMessage:"The human readable name of the action group of the alert that scheduled actions for the rule."})},[te.alertFlapping]:{description:i.i18n.translate("alertsUIShared.actionVariables.alertFlappingLabel",{defaultMessage:"A flag on the alert that indicates whether the alert status is changing repeatedly."})},[te.alertConsecutiveMatches]:{description:i.i18n.translate("alertsUIShared.actionVariables.alertConsecutiveMatchesLabel",{defaultMessage:"The number of consecutive runs that meet the rule conditions."})}}),ne=Object.freeze({...se,[re.allAlertsCount]:{description:i.i18n.translate("alertsUIShared.actionVariables.allAlertsCountLabel",{defaultMessage:"The count of all alerts."})},[re.allAlertsData]:{description:i.i18n.translate("alertsUIShared.actionVariables.allAlertsDataLabel",{defaultMessage:"An array of objects for all alerts."})},[re.newAlertsCount]:{description:i.i18n.translate("alertsUIShared.actionVariables.newAlertsCountLabel",{defaultMessage:"The count of new alerts."})},[re.newAlertsData]:{description:i.i18n.translate("alertsUIShared.actionVariables.newAlertsDataLabel",{defaultMessage:"An array of objects for new alerts."})},[re.ongoingAlertsCount]:{description:i.i18n.translate("alertsUIShared.actionVariables.ongoingAlertsCountLabel",{defaultMessage:"The count of ongoing alerts."})},[re.ongoingAlertsData]:{description:i.i18n.translate("alertsUIShared.actionVariables.ongoingAlertsDataLabel",{defaultMessage:"An array of objects for ongoing alerts."})},[re.recoveredAlertsCount]:{description:i.i18n.translate("alertsUIShared.actionVariables.recoveredAlertsCountLabel",{defaultMessage:"The count of recovered alerts."})},[re.recoveredAlertsData]:{description:i.i18n.translate("alertsUIShared.actionVariables.recoveredAlertsDataLabel",{defaultMessage:"An array of objects for recovered alerts."})}});var ie=a(770),le=a(3268);const oe=(e,t)=>e.map((e=>({...e,name:`${t}${e.name}`}))),ue=(e,t)=>{if(!e)return[];const a=t?"all"===t?(0,ie.pick)(e,le.Be):(0,ie.pick)(e,[...le.Be,...le.bD]):e,r=oe(a.params,"rule.params."),s=a.context?oe(a.context,"context."):[],n=a.state?oe(a.state,"state."):[];return s.concat(r,n)},ce=(e,t,a,r)=>{if(r){const e=de(ne),r=ue(t,a);return e.concat(r)}const s=de(se),n=ue(e,a);return s.concat(n)},de=e=>Object.entries(e).map((([e,t])=>({...t,name:e}))),pe=(e,t,a,r)=>{const s=ce(e,t,null==a?void 0:a.omitMessageVariables,r);return(0,ie.partition)(s,(e=>!0!==e.deprecated)).reduce(((e,t)=>[...e,...t.sort(((e,t)=>e.name.toUpperCase().localeCompare(t.name.toUpperCase())))]),[])};var ge=a(8202)},5406:(e,t,a)=>{"use strict";a.d(t,{A:()=>p,W:()=>d}),a(4286);var r=a(770),s=a(5008),n=a(1319),i=a(5879),l=a(7346),o=a(6791);const u=e=>({isEnabled:!1,message:s.i18n.translate("alertsUIShared.checkActionTypeEnabled.actionTypeDisabledByLicenseMessage",{defaultMessage:"This connector requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:(0,r.upperFirst)(e.minimumLicenseRequired)}}),messageCard:(0,o.jsx)(n.EuiCard,{titleSize:"xs",title:s.i18n.translate("alertsUIShared.licenseCheck.actionTypeDisabledByLicenseMessageTitle",{defaultMessage:"This feature requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:(0,r.upperFirst)(e.minimumLicenseRequired)}}),description:s.i18n.translate("alertsUIShared.licenseCheck.actionTypeDisabledByLicenseMessageDescription",{defaultMessage:"To re-enable this action, please upgrade your license."}),className:"actCheckActionTypeEnabled__disabledActionWarningCard",children:(0,o.jsx)(n.EuiLink,{href:l.cY,target:"_blank"},(0,o.jsx)(i.FormattedMessage,{defaultMessage:"View license options",id:"alertsUIShared.licenseCheck.actionTypeDisabledByLicenseLinkTitle"}))})}),c={isEnabled:!1,message:s.i18n.translate("alertsUIShared.checkActionTypeEnabled.actionTypeDisabledByConfigMessage",{defaultMessage:"This connector is disabled by the Kibana configuration."}),messageCard:(0,o.jsx)(n.EuiCard,{title:s.i18n.translate("alertsUIShared.licenseCheck.actionTypeDisabledByConfigMessageTitle",{defaultMessage:"This feature is disabled by the Kibana configuration."}),description:"",className:"actCheckActionTypeEnabled__disabledActionWarningCard"})},d=(e,t=!1)=>!1===(null==e?void 0:e.enabledInLicense)?u(e):!1===(null==e?void 0:e.enabledInConfig)&&!1===t?c:{isEnabled:!0},p=(e,t)=>!1===(null==e?void 0:e.enabledInLicense)?u(e):!1!==(null==e?void 0:e.enabledInConfig)||t.find((t=>t.actionTypeId===e.id))?{isEnabled:!0}:c},208:(e,t,a)=>{"use strict";a.d(t,{n5:()=>s,MG:()=>i,bL:()=>n});var r=a(7346);async function s({http:e}){const t=await e.get(`${r.Gl}/_health`),a=n(t.alerting_framework_health);return{...i(t),alertingFrameworkHealth:a}}const n=({decryption_health:e,execution_health:t,read_health:a,...r})=>({decryptionHealth:e,executionHealth:t,readHealth:a,...r}),i=({is_sufficiently_secure:e,has_permanent_encryption_key:t,alerting_framework_health:a,...r})=>({isSufficientlySecure:e,hasPermanentEncryptionKey:t,alertingFrameworkHealth:a,...r})},5772:(e,t,a)=>{"use strict";a.d(t,{v:()=>s});var r=a(7346);const s=({http:e,ruleTypeIds:t})=>e.get(`${r.Gm}/browser_fields`,{query:{ruleTypeIds:t}})},5953:(e,t,a)=>{"use strict";a.d(t,{I:()=>s});var r=a(7346);const s=async({http:e,ruleTypeIds:t})=>{const{index_name:a=[]}=await e.get(`${r.Gm}/index`,{query:{ruleTypeIds:t}});return a}},7623:(e,t,a)=>{"use strict";a.d(t,{D:()=>s});var r=a(7346);const s=async({http:e,featureId:t,includeSystemActions:a=!1})=>{const s=a?`${r.WR}/connector_types`:`${r.S9}/connector_types`;return(t?await e.get(s,{query:{feature_id:t}}):await e.get(s,{})).map((e=>(({enabled_in_config:e,enabled_in_license:t,minimum_license_required:a,supported_feature_ids:r,is_system_action_type:s,sub_feature:n,...i})=>({enabledInConfig:e,enabledInLicense:t,minimumLicenseRequired:a,supportedFeatureIds:r,isSystemActionType:s,subFeature:n,...i}))(e)))}},3673:(e,t,a)=>{"use strict";a.d(t,{H:()=>i});const r=e=>e.map((e=>s(e))),s=({connector_type_id:e,is_preconfigured:t,is_deprecated:a,referenced_by_count:r,is_missing_secrets:s,is_system_action:n,...i})=>({actionTypeId:e,isPreconfigured:t,isDeprecated:a,referencedByCount:r,isMissingSecrets:s,isSystemAction:n,...i});var n=a(7346);async function i({http:e,includeSystemActions:t=!1}){const a=t?`${n.WR}/connectors`:`${n.S9}/connectors`,s=await e.get(a);return r(s)}},5495:(e,t,a)=>{"use strict";a.d(t,{i:()=>i,f:()=>n});var r=a(770),s=a(7346);const n=(e,t)=>{var a,s,n,i;let l=t[e];return(0,r.isEmpty)(null!==(a=null===(s=l)||void 0===s?void 0:s.description)&&void 0!==a?a:"")&&e.includes("kibana.alert.")&&(l=t[e.replace("kibana.alert.","")]),null!==(n=null===(i=l)||void 0===i?void 0:i.description)&&void 0!==n?n:""},i=async({http:e,ruleTypeId:t})=>t?(await e.get(`${s.Gm}/browser_fields`,{query:{ruleTypeIds:[t]}})).fields:s.Lv},6920:(e,t,a)=>{"use strict";a.d(t,{v:()=>n,_:()=>r});const r={ALERTS_ERROR:"alertsError",ENCRYPTION_ERROR:"encryptionError",API_KEYS_DISABLED_ERROR:"apiKeysDisabledError",API_KEYS_AND_ENCRYPTION_ERROR:"apiKeysAndEncryptionError"};var s=a(7346);const n=async({http:e})=>{const t=await e.get(`${s.g6}/_health`);return t?{isRulesAvailable:t.isAlertsAvailable}:t}},3869:(e,t,a)=>{"use strict";a.d(t,{_J:()=>s._,fY:()=>r.f,i0:()=>r.i}),a(208),a(5772),a(5953),a(3673),a(7623);var r=a(5495),s=a(6920)},7379:(e,t,a)=>{"use strict";a.d(t,{i:()=>l,z:()=>i});var r=a(6878),s=a(1783),n=a.n(s);const i=r.GI.map((e=>({id:String(e),label:n()().isoWeekday(e).format("dd")}))),l=r.GI.map((e=>({id:String(e),label:n()().isoWeekday(e).format("ddd")})))},7346:(e,t,a)=>{"use strict";a.d(t,{VW:()=>i,S9:()=>d,Gl:()=>l,Gm:()=>u,g6:()=>c,Iq:()=>r,Lv:()=>s,i9:()=>n.i,WR:()=>p,Ye:()=>o,cY:()=>g});const r=10,s=[];var n=a(7379);const i="alerts",l="/api/alerting",o="/internal/alerting",u="/internal/rac/alerts",c="/internal/triggers_actions_ui",d="/api/actions",p="/internal/actions",g="https://www.elastic.co/subscriptions"},4490:(e,t,a)=>{"use strict";a.d(t,{Wp:()=>r.W,YN:()=>h,Hl:()=>p.H,ut:()=>d});var r=a(2937),s=(a(2291),a(5008)),n=a(3530),i=a(7346),l=a(4286),o=a(208),u=a(6920),c=a(3869);const d=e=>{const{http:t}=e,{data:a,isLoading:r,isInitialLoading:s}=(e=>{const{http:t}=e,{data:a,isSuccess:r,isLoading:s,isFetching:i,isInitialLoading:l,isError:o,error:c}=(0,n.useQuery)({queryKey:["useLoadUiHealth"],queryFn:()=>(0,u.v)({http:t}),refetchOnWindowFocus:!1});return{data:a,isLoading:s||i,isInitialLoading:l,isSuccess:r,isError:o,error:c}})({http:t}),{data:i,isLoading:d,isInitialLoading:p}=(e=>{const{http:t}=e,{data:a,isSuccess:r,isFetching:s,isLoading:i,isInitialLoading:l,isError:u,error:c}=(0,n.useQuery)({queryKey:["useLoadAlertingFrameworkHealth"],queryFn:()=>(0,o.n5)({http:t}),refetchOnWindowFocus:!1});return{data:a,isLoading:i||s,isInitialLoading:l,isSuccess:r,isError:u,error:c}})({http:t}),g=(0,l.useMemo)((()=>r||d),[r,d]),h=(0,l.useMemo)((()=>s||p),[s,p]),m=(0,l.useMemo)((()=>g||h||!a||!i?null:a.isRulesAvailable?{...a,isSufficientlySecure:i.isSufficientlySecure,hasPermanentEncryptionKey:i.hasPermanentEncryptionKey}:{...a,isSufficientlySecure:!1,hasPermanentEncryptionKey:!1}),[g,h,a,i]),b=(0,l.useMemo)((()=>{const{isRulesAvailable:e,isSufficientlySecure:t=!1,hasPermanentEncryptionKey:a=!1}=m||{};return g||h||!m||t&&a?null:e?t||a?a?c._J.API_KEYS_DISABLED_ERROR:c._J.ENCRYPTION_ERROR:c._J.API_KEYS_AND_ENCRYPTION_ERROR:c._J.ALERTS_ERROR}),[g,h,m]);return{isLoading:g,isInitialLoading:h,error:b}};var p=a(7188);const g=["alerts","fetchUnifiedAlertsFields"],h=({http:e,...t},a)=>{const{ruleTypeIds:r,toasts:l}=t;return(0,n.useQuery)({queryKey:g.concat(r),queryFn:()=>(({http:e,ruleTypeIds:t})=>e.get(`${i.Gm}/fields`,{query:{rule_type_ids:t}}))({http:e,ruleTypeIds:r}),placeholderData:{fields:[]},staleTime:6e4,refetchOnWindowFocus:!1,...a,enabled:null==(null==a?void 0:a.enabled)||a.enabled,onError:()=>{l.addDanger(s.i18n.translate("alertsUIShared.hooks.useFetchUnifiedAlertsFields.fetchErrorMessage",{defaultMessage:"Unable to load alert fields"}))}})}},2937:(e,t,a)=>{"use strict";a.d(t,{W:()=>c});var r=a(4286),s=a(5008),n=a(2708),i=a(3530);const l=["alerts","dataView"];var o=a(865),u=a(2291);const c=({http:e,dataViewsService:t,toasts:a,ruleTypeIds:c,fetchUnifiedAlertsFields:d=!1})=>{const p=c.some(n.L$),g=c.length>0&&c.every(n.L$),h=!g&&p,{data:m,isError:b,isLoading:y,isInitialLoading:f}=(0,u.n)({http:e,ruleTypeIds:c},{enabled:!!c.length&&(g||!p)&&!d}),{data:v,isError:S,isLoading:_,isInitialLoading:x}=(0,o.q)({http:e,ruleTypeIds:c},{enabled:!!c.length&&!p&&!d}),{data:A,isError:T}=(({dataViewsService:e,indexNames:t},a)=>{const s=(0,i.useQuery)({queryKey:l.concat(null!=t?t:[]),queryFn:()=>e.create({title:(null!=t?t:[]).join(","),allowNoIndex:!0}),enabled:!(null==t||!t.length),staleTime:1/0,refetchOnWindowFocus:!1,...a});return(0,r.useEffect)((()=>{if(s.data)return()=>{e.clearInstanceCache(s.data.id)}}),[e,s.data]),s})({dataViewsService:t,indexNames:m},{enabled:g&&!(null==m||!m.length)});(0,r.useEffect)((()=>{(b||S||T)&&a.addDanger(s.i18n.translate("alertsUIShared.hooks.useAlertDataView.fetchErrorMessage",{defaultMessage:"Unable to load alert data view"}))}),[S,b,T,a]);const E=(0,r.useMemo)((()=>(({isError:e,fields:t,indexNames:a,virtualDataView:r})=>{if(!e){if(r)return r;var s;if(a)return{title:a.join(","),fieldFormatMap:{},fields:(null!==(s=null==t?void 0:t.fields)&&void 0!==s?s:[]).map((e=>({...e,...e.esTypes&&e.esTypes.includes("flattened")?{type:"string"}:{}})))}}})({isError:b||S||T,fields:v,indexNames:m,virtualDataView:g?A:void 0})),[v,m,S,b,g,T,A]);return(0,r.useMemo)((()=>{let e;return e=!(!c.length||h||d)&&(g?f||y||!E:f||y||x||_),{dataView:E,isLoading:e}}),[E,c.length,h,x,f,_,y,g,d])}},865:(e,t,a)=>{"use strict";a.d(t,{q:()=>l});var r=a(2708),s=a(3530),n=a(5772);const i=["alerts","fetchAlertsFields"],l=({http:e,...t},a)=>{const{ruleTypeIds:l}=t,o=l.filter((e=>!(0,r.L$)(e)));return(0,s.useQuery)({queryKey:i.concat(l),queryFn:()=>(0,n.v)({http:e,ruleTypeIds:o}),placeholderData:{browserFields:{},fields:[]},staleTime:6e4,refetchOnWindowFocus:!1,...a,enabled:o.length>0&&(null==(null==a?void 0:a.enabled)||a.enabled)})}},2291:(e,t,a)=>{"use strict";a.d(t,{n:()=>i});var r=a(3530),s=a(5953);const n=["alerts","fetchAlertsIndexNames"],i=({http:e,ruleTypeIds:t},a)=>(0,r.useQuery)({queryKey:n.concat(t),queryFn:()=>(0,s.I)({http:e,ruleTypeIds:t}),enabled:t.length>0,staleTime:6e4,refetchOnWindowFocus:!1,...a})},8202:(e,t,a)=>{"use strict";a.d(t,{Y:()=>n});var r=a(3530),s=a(7346);const n=e=>{const{http:t,enabled:a,onSuccess:n}=e,{data:i,isFetching:l,isError:o,isLoadingError:u,isLoading:c,isInitialLoading:d}=(0,r.useQuery)({queryKey:["fetchFlappingSettings"],queryFn:()=>(async({http:e})=>(({look_back_window:e,status_change_threshold:t,created_at:a,created_by:r,updated_at:s,updated_by:n,...i})=>({...i,lookBackWindow:e,statusChangeThreshold:t,createdAt:a,createdBy:r,updatedAt:s,updatedBy:n}))(await e.get(`${s.Ye}/rules/settings/_flapping`)))({http:t}),onSuccess:n,enabled:a,refetchOnWindowFocus:!1,retry:!1});return{isInitialLoading:d,isLoading:c||l,isError:o||u,data:i}}},7188:(e,t,a)=>{"use strict";a.d(t,{H:()=>c});var r=a(4286),s=a(770),n=a(3530),i=a(9921);const l=a(2029).l.getRuleTypes;var o=a(5008),u=a(7346);const c=({http:e,toasts:t,filteredRuleTypes:a,registeredRuleTypes:c,context:d,enabled:p=!0})=>{const{data:g,isSuccess:h,isFetching:m,isInitialLoading:b,isLoading:y,error:f}=(({http:e},{onError:t,enabled:a,context:r})=>(0,n.useQuery)({queryKey:l(),queryFn:()=>(0,i.i)({http:e}),refetchOnWindowFocus:!1,staleTime:6e4,onError:t,enabled:a,context:r}))({http:e},{onError:e=>{e&&t.addDanger(o.i18n.translate("alertsUIShared.hooks.useLoadRuleTypesQuery.unableToLoadRuleTypesMessage",{defaultMessage:"Unable to load rule types"}))},enabled:p,context:d}),v=(0,r.useMemo)((()=>g?(({data:e,filteredRuleTypes:t,registeredRuleTypes:a})=>{const r=new Map,n=a?(0,s.keyBy)(a,"id"):{};for(const t of e){const e={...t};a?n[t.id]&&(e.description=n[t.id].description,r.set(t.id,e)):r.set(t.id,e)}let i=r;return null!=t&&t.length&&(i=new Map([...r].filter((([e,a])=>t.includes(a.id))))),i})({data:g,filteredRuleTypes:a,registeredRuleTypes:c}):new Map),[g,a,c]),S=v.size>0,_=(0,r.useMemo)((()=>[...v.values()]),[v]),x=_.some((e=>{var t;return null===(t=e.authorizedConsumers[u.VW])||void 0===t?void 0:t.all})),A=x||_.some((e=>{var t;return null===(t=e.authorizedConsumers[u.VW])||void 0===t?void 0:t.read}));return{ruleTypesState:{isInitialLoad:b,isLoading:y||m,data:v,error:f},hasAnyAuthorizedRuleType:S,authorizedRuleTypes:_,authorizedToReadAnyRules:A,authorizedToCreateAnyRules:x,isSuccess:h}}},2657:(e,t,a)=>{"use strict";a.d(t,{O:()=>TypeRegistry});var r=a(8915),s=a(5008);class TypeRegistry{constructor(){(0,r.default)(this,"objectTypes",new Map)}has(e){return this.objectTypes.has(e)}register(e){if(this.has(e.id))throw new Error(s.i18n.translate("alertsUIShared.typeRegistry.register.duplicateObjectTypeErrorMessage",{defaultMessage:'Object type "{id}" is already registered.',values:{id:e.id}}));this.objectTypes.set(e.id,e)}get(e){if(!this.has(e))throw new Error(s.i18n.translate("alertsUIShared.typeRegistry.get.missingActionTypeErrorMessage",{defaultMessage:'Object type "{id}" is not registered.',values:{id:e}}));return this.objectTypes.get(e)}list(){return Array.from(this.objectTypes).map((([e,t])=>t))}}},8190:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});let r=function(e){return e.Test="test",e.ActionForm="actionForm",e}({})},2708:(e,t,a)=>{"use strict";a.d(t,{L$:()=>i,Ov:()=>s,T1:()=>n});var r=a(3614);const s={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",STREAMS:"streams",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml",STACK_ALERTS:"stackAlerts",EXAMPLE:"AlertingExample",MONITORING:"monitoring",ALERTS:"alerts",DISCOVER:"discover"},n=[s.OBSERVABILITY],i=(Object.values(s).map((e=>e)),e=>e.startsWith("siem.")||e===r.ZJ)},454:(e,t,a)=>{"use strict";a.d(t,{AR:()=>n,O3:()=>s,R5:()=>r});const r="active",s="recovered",n="untracked"},2745:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>c,O:()=>s,U5:()=>l,U7:()=>r,WK:()=>n,ed:()=>u,gU:()=>i,oC:()=>o});const r="/rule/:ruleId",s="/app/management/insightsAndAlerting/triggersActions",n="/rules/create/:ruleTypeId",i="/rules/create/template/:templateId",l="/rules/edit/:id",o=e=>r.replace(":ruleId",e),u=e=>n.replace(":ruleTypeId",e),c=e=>l.replace(":id",e)},9397:(e,t,a)=>{"use strict";a.d(t,{wE:()=>r});const r="observability.rules.custom_threshold";let s=function(e){return e.ErrorCount="apm.error_rate",e.TransactionErrorRate="apm.transaction_error_rate",e.TransactionDuration="apm.transaction_duration",e.Anomaly="apm.anomaly",e}({});Object.values(s);let n=function(e){return e.MetricThreshold="metrics.alert.threshold",e.InventoryThreshold="metrics.alert.inventory.threshold",e}({});Object.values(n)},875:(e,t,a)=>{"use strict";a.d(t,{CJ:()=>s,iR:()=>r});const r=".es-query",s="xpack.ml.anomaly_detection_alert"},3268:(e,t,a)=>{"use strict";a.d(t,{bD:()=>s,Be:()=>r});const r=["params"],s=["context"]},9921:(e,t,a)=>{"use strict";a.d(t,{i:()=>i});var r=a(4007);const s=e=>e.map((e=>n(e))),n=({enabled_in_license:e,recovery_action_group:t,action_groups:a,default_action_group_id:r,minimum_license_required:s,action_variables:n,authorized_consumers:i,rule_task_timeout:l,does_set_recovery_context:o,default_schedule_interval:u,has_alerts_mappings:c,is_exportable:d,auto_recover_alerts:p,is_internally_managed:g,...h})=>({enabledInLicense:e,recoveryActionGroup:t,actionGroups:a,defaultActionGroupId:r,minimumLicenseRequired:s,actionVariables:n,authorizedConsumers:i,ruleTaskTimeout:l,doesSetRecoveryContext:o,defaultScheduleInterval:u,hasAlertsMappings:c,isExportable:d,autoRecoverAlerts:p,isInternallyManaged:g,...h});async function i({http:e}){const t=await e.get(`${r.G}/rule_types`);return s(t)}},4007:(e,t,a)=>{"use strict";a.d(t,{G:()=>r,Y:()=>s});const r="/api/alerting",s="/internal/alerting"},2029:(e,t,a)=>{"use strict";a.d(t,{l:()=>r});const r={root:"rules",getRuleTags:({ruleTypeIds:e,search:t,perPage:a,page:s,refresh:n})=>[r.root,"getRuleTags",e,t,a,s,{refresh:null==n?void 0:n.toISOString()}],getRuleTypes:()=>[r.root,"getRuleTypes"],getInternalRuleTypes:()=>[r.root,"getInternalRuleTypes"]}},3614:(e,t,a)=>{"use strict";a.d(t,{ZJ:()=>r});const r="attack-discovery"},4022:(e,t,a)=>{"use strict";a.d(t,{eI:()=>o,hK:()=>u,xy:()=>l});const r=Object.freeze({rulesListDatagrid:!0,stackAlertsPage:!0,ruleTagFilter:!0,ruleStatusFilter:!0,rulesDetailLogs:!0,ruleUseExecutionStatus:!1,ruleKqlBar:!1,isMustacheAutocompleteOn:!1,showMustacheAutocompleteSwitch:!1,alertDeletionSettingsEnabled:!0}),s=new Set(["ruleFormV2"]),n=class extends Error{},i=Object.keys(r),l=e=>{const t={};for(const a of e){if(!o(a))throw new n(`[${a}] is not valid.`);t[a]=!0}return{...r,...t}},o=e=>i.includes(e)||s.has(e),u=()=>[...i]},6337:(e,t,a)=>{"use strict";a.d(t,{K:()=>n}),a(4286);var r=a(1319),s=a(6791);const n=({size:e})=>(0,s.jsx)(r.EuiFlexGroup,{"data-test-subj":"centerJustifiedSpinner",justifyContent:"center"},(0,s.jsx)(r.EuiFlexItem,{grow:!1},(0,s.jsx)(r.EuiLoadingSpinner,{size:e||"xl"})))},9132:(e,t,a)=>{"use strict";a.d(t,{gk:()=>v,Er:()=>V,HE:()=>B,iO:()=>N.i,mW:()=>U,JR:()=>I,GP:()=>_});var r=a(3185),s=a(4286),n=a.n(s),i=a(1319),l=a(5008);const o=__kbnSharedDeps__.KbnMonaco;var u=a(8744);const c=__kbnSharedDeps__.KbnCodeEditor;var d=a(6252),p=a(6791);const g=l.i18n.translate("xpack.triggersActionsUI.components.labelAppendWithMessageVariables.optionalLabel",{defaultMessage:"Optional"}),h=({buttonTitle:e,messageVariables:t,paramsProperty:a,onSelectEventHandler:r,showButtonTitle:s=!1,isOptionalField:n=!1})=>(0,p.jsx)(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"flexEnd"},n&&(0,p.jsx)(i.EuiFlexItem,{grow:!1},(0,p.jsx)(i.EuiText,{size:"xs",color:"subdued"},g)),(0,p.jsx)(i.EuiFlexItem,{grow:!1},(0,p.jsx)(d._S,{messageVariables:t,onSelectEventHandler:r,paramsProperty:a,buttonTitle:e,showButtonTitle:s})));h.displayName="AddMessageVariablesOptional";var m=a(8256);const b=l.i18n.translate("xpack.triggersActionsUI.components.jsonEditorWithMessageVariable.noEditorErrorTitle",{defaultMessage:"Unable to add message variable"}),y=l.i18n.translate("xpack.triggersActionsUI.components.jsonEditorWithMessageVariable.noEditorErrorMessage",{defaultMessage:"Editor was not found, please refresh page and try again"}),{useXJsonMode:f}=u.XJson,v=({buttonTitle:e,messageVariables:t,paramsProperty:a,inputTargetValue:l,label:u,errors:d,ariaLabel:g,onDocumentsChange:v,helpText:S,onBlur:_,showButtonTitle:x,dataTestSubj:A,euiCodeEditorProps:T={},isOptionalField:E=!1,readOnly:I=!1})=>{const w=(0,s.useRef)(),j=(0,s.useRef)([]),[R,C]=(0,s.useState)(!1),{convertToJson:k,setXJson:F,xJson:M}=f(null!=l?l:null);(0,s.useEffect)((()=>{!M&&l&&F(l)}),[l]);const O=(0,s.useCallback)((()=>{const e=w.current;e&&j.current.push(e.onDidBlurEditorWidget((()=>{null==_||_()})))}),[_]);return(0,s.useEffect)((()=>(O(),()=>(j.current.forEach((e=>{e.dispose()})),void(j.current=[])))),[O]),(0,p.jsx)(i.EuiFormRow,{"data-test-subj":A,fullWidth:!0,error:d,isInvalid:d&&d.length>0&&void 0!==l,label:u,labelAppend:(0,p.jsx)(h,{isOptionalField:E,buttonTitle:e,messageVariables:t,showButtonTitle:x,onSelectEventHandler:e=>{if(I)return;const t=w.current;if(!t)return void C(!0);const a=t.getSelection(),r=(0,m.HR)(e);let s="";a?(t.executeEdits("json-editor-with-message-variables",[{range:a,text:r}]),s=t.getValue()):s=r,C(!1),F(s),v(k(s))},paramsProperty:a}),helpText:S},(0,p.jsx)(n().Fragment,null,R?(0,p.jsx)(n().Fragment,null,(0,p.jsx)(i.EuiSpacer,{size:"s"}),(0,p.jsx)(i.EuiCallOut,{size:"s",color:"danger",iconType:"warning",title:b},(0,p.jsx)("p",null,y)),(0,p.jsx)(i.EuiSpacer,{size:"s"})):null,(0,p.jsx)(c.CodeEditor,(0,r.default)({languageId:o.XJsonLang.ID,options:{renderValidationDecorations:M?"on":"off",lineNumbers:"on",fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1,folding:!0,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,readOnly:I},value:M,width:"100%",height:"200px","data-test-subj":`${a}JsonEditor${I?"ReadOnly":""}`,"aria-label":g},T,{editorDidMount:e=>{w.current=e,O()},onChange:e=>{F(e),v(k(e))}}))))},S=({children:e,wrapField:t,formRowProps:a,button:s})=>t?(0,p.jsx)(i.EuiFormRow,(0,r.default)({},a,{labelAppend:s}),e):(0,p.jsx)(n().Fragment,null,e),_=({buttonTitle:e,messageVariables:t,paramsProperty:a,index:r,inputTargetValue:n,editAction:l,errors:o,formRowProps:u,defaultValue:c,wrapField:g=!1,showButtonTitle:h,"aria-label":b})=>{const[y,f]=(0,s.useState)(null),v=(0,s.useCallback)((e=>{var t,s;const i=(0,m.HR)(e),o=null!==(t=null==y?void 0:y.selectionStart)&&void 0!==t?t:0,u=null!==(s=null==y?void 0:y.selectionEnd)&&void 0!==s?s:0,c=(null!=n?n:"").substring(0,o)+i+(null!=n?n:"").substring(u,(null!=n?n:"").length);l(a,c,r)}),[y,l,r,n,a]),_=(0,s.useMemo)((()=>(0,p.jsx)(d._S,{buttonTitle:e,messageVariables:t,onSelectEventHandler:v,paramsProperty:a,showButtonTitle:h})),[e,t,v,a,h]);return(0,p.jsx)(S,{wrapField:g,formRowProps:u,button:_},(0,p.jsx)(i.EuiFieldText,{fullWidth:!0,"aria-label":b,name:a,id:`${a}Id`,isInvalid:o&&o.length>0&&void 0!==n,"data-test-subj":`${a}Input`,value:n||"",defaultValue:c,onChange:e=>(e=>{l(a,e.target.value,r)})(e),onFocus:e=>{f(e.target)},onBlur:e=>{n||l(a,"",r)},append:g?void 0:_}))};var x=a(4157),A=a(5277),T=a.n(A);const E={className:"euiSelectableMsgAutoComplete"},I=e=>{let t;try{t=(0,x.E)("isMustacheAutocompleteOn")}catch(e){t=!1}return t?(({editAction:e,errors:t,index:a,inputTargetValue:r,isDisabled:l=!1,label:o,messageVariables:u,paramsProperty:c})=>{const{euiTheme:g}=(0,i.useEuiTheme)(),h=g.colors.backgroundBasePlain,m=n().useRef(null),b=n().useRef(null),[y,f]=(0,s.useState)([]),[v,S]=(0,s.useState)({top:0,left:0,height:0,width:0}),[_,x]=(0,s.useState)(!1),[A,I]=(0,s.useState)(-1),[w,j]=(0,s.useState)(!1),[R,C]=(0,s.useState)(""),k=(0,s.useMemo)((()=>null==y?void 0:y.map((e=>({label:e,data:{description:e},"data-test-subj":`${e}-selectableOption`})))),[y]),F=(0,s.useCallback)(((e=!1)=>{e||I(-1),x(!1),j(!1)}),[]),M=(0,s.useCallback)((t=>{if(!m.current)return;const{value:r,selectionStart:s,scrollTop:n}=m.current,i=r.slice(0,s).lastIndexOf(" "),l=r.slice(0,s).lastIndexOf("{{"),o=Math.max(i,l),u=t.find((({checked:e})=>"on"===e));if(u){const t=r.slice(0,o)+"{{"+u.label+"}}"+r.slice(s);e(c,t.trim(),a),f([]),F(),m.current.focus(),setTimeout((()=>{m.current&&(m.current.selectionStart=o+u.label.length+4,m.current.selectionEnd=m.current.selectionStart,m.current.scrollTop=n)}),0)}}),[e,a,c,F]),O=(0,s.useCallback)((()=>{var e;if(!m.current)return;const t=T()(m.current,m.current.selectionStart),a=null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect(),r=a.top-m.current.scrollTop+window.scrollY+t.top+t.height,s=a.left+window.pageXOffset,n=t.height,i=a.width;S({top:r,left:s,width:i,height:n}),x(!0)}),[]),L=(0,s.useCallback)((()=>{if(!m.current)return;const{value:t,selectionStart:r}=m.current,s=t.slice(r-2,r),n=-1!==A?t.slice(A,r):"";if("{{"===s||n.startsWith("{{")){"{{"===s&&I(r-2);const e=(({actionVariablesList:e,propertyPath:t})=>{if(!e)return[];const a=[];return e.forEach((e=>{const t=e.split(".");for(let e=0;e<t.length;e++){const r=t.slice(0,e+1).join(".");a.includes(r)||a.push(r)}})),a.sort().filter((e=>e.startsWith(t)))})({actionVariablesList:null==u?void 0:u.filter((({deprecated:e})=>!e)).map((({name:e})=>e)),propertyPath:n.slice(2)});C(n.slice(2)),f(e),setTimeout((()=>O()),0)}else"}}"===s?F():f([]);e(c,t,a)}),[A,F,e,a,u,c,O]),P=(0,s.useCallback)((e=>{if(b.current&&_)if(w||"ArrowUp"!==e.code&&"ArrowDown"!==e.code){if("ArrowUp"===e.code)e.preventDefault(),e.stopPropagation(),b.current.incrementActiveOptionIndex(-1);else if("ArrowDown"===e.code)e.preventDefault(),e.stopPropagation(),b.current.incrementActiveOptionIndex(1);else if("Escape"===e.code)e.preventDefault(),e.stopPropagation(),F();else if("Enter"===e.code||"Space"===e.code){const e=b.current.state.activeOptionIndex;M(k.map(((t,a)=>a===e?{...t,checked:"on"}:t))),F()}}else e.preventDefault(),e.stopPropagation(),b.current.onFocus(),j(!0);else j((e=>!e&&e))}),[F,_,M,k,w]),U=(0,s.useCallback)((e=>{var t;const a=(null===(t=document.querySelector(".euiSelectableMsgAutoComplete"))||void 0===t?void 0:t.getBoundingClientRect())||{left:0,right:0,top:0,bottom:0};e.clientX>a.left&&e.clientX<a.right&&e.clientY>a.top&&e.clientY<a.bottom||F()}),[F]),D=(0,s.useCallback)((t=>{if(!m.current)return;const{selectionStart:s,selectionEnd:n}=m.current,i=function(e){return e.useWithTripleBracesInTemplates?`{{{${e.name}}}}`:`{{${e.name}}}`}(t),l=(null!=r?r:"").substring(0,s)+i+(null!=r?r:"").substring(n,(null!=r?r:"").length);e(c,l,a)}),[e,a,r,c]),V=(0,s.useMemo)((()=>({position:"absolute",top:v.top,width:v.width,left:v.left,border:`${g.border.width.thin} solid ${g.border.color}`,background:h,zIndex:g.levels.flyout})),[h,g.border.color,g.border.width.thin,g.levels.flyout,v.left,v.top,v.width]),B=(0,s.useCallback)((()=>x(!0)),[]),N=(0,s.useCallback)((()=>{r||_||e(c,"",a)}),[e,a,r,_,c]),z=(0,s.useCallback)((()=>F()),[F]),W=(0,s.useCallback)((e=>{var t,a,r;(null==b||null===(t=b.current)||void 0===t?void 0:t.listId)!==(null===(a=e.target)||void 0===a||null===(r=a.firstElementChild)||void 0===r?void 0:r.id)&&F(!0)}),[F]);return(0,s.useEffect)((()=>(window.addEventListener("scroll",W,{passive:!0,capture:!0}),()=>{window.removeEventListener("scroll",W,{capture:!0})})),[W]),(0,p.jsx)(i.EuiFormRow,{error:t,fullWidth:!0,isDisabled:l,isInvalid:t&&t.length>0&&void 0!==r,label:o,labelAppend:(0,p.jsx)(d._S,{messageVariables:u,onSelectEventHandler:D,paramsProperty:c})},(0,p.jsx)(n().Fragment,null,(0,p.jsx)(i.EuiOutsideClickDetector,{onOutsideClick:U},(0,p.jsx)(i.EuiTextArea,{disabled:l,inputRef:m,fullWidth:!0,isInvalid:t&&t.length>0&&void 0!==r,name:c,value:r||"","data-test-subj":`${c}TextArea`,onChange:L,onFocus:B,onKeyDown:P,onBlur:N,onClick:z})),y.length>0&&_&&(0,p.jsx)(i.EuiPortal,null,(0,p.jsx)(i.EuiSelectable,{ref:b,style:V,height:y.length>5?176:32*y.length,options:k,onChange:M,singleSelection:!0,renderOption:e=>R?(0,p.jsx)(i.EuiHighlight,{search:R},e.label):e.label,listProps:E},(e=>e)))))})(e):(({messageVariables:e,paramsProperty:t,index:a,inputTargetValue:r,isDisabled:n=!1,editAction:l,label:o,errors:u,helpText:c,isOptionalField:d=!1})=>{const[g,b]=(0,s.useState)(null);return(0,p.jsx)(i.EuiFormRow,{fullWidth:!0,error:u,isDisabled:n,isInvalid:u&&u.length>0&&void 0!==r,label:o,labelAppend:(0,p.jsx)(h,{isOptionalField:d,messageVariables:e,onSelectEventHandler:e=>{var s,n;const i=(0,m.HR)(e),o=null!==(s=null==g?void 0:g.selectionStart)&&void 0!==s?s:0,u=null!==(n=null==g?void 0:g.selectionEnd)&&void 0!==n?n:0,c=(null!=r?r:"").substring(0,o)+i+(null!=r?r:"").substring(u,(null!=r?r:"").length);l(t,c,a)},paramsProperty:t}),helpText:c},(0,p.jsx)(i.EuiTextArea,{disabled:n,fullWidth:!0,isInvalid:u&&u.length>0&&void 0!==r,name:t,value:r||"","data-test-subj":`${t}TextArea`,onChange:e=>(e=>{l(t,e.target.value,a)})(e),onFocus:e=>{b(e.target)},onBlur:()=>{r||l(t,"",a)}}))})(e)};var w=a(5296),j=a(2602),R=a(791);const C=(0,j.getUseField)({component:w.Field}),k=(0,j.getUseField)({component:w.ComboBoxField}),{emptyField:F,urlField:M}=R.fieldValidators,O=({label:e,isRequired:t=!0,isUrlField:a=!1,requireTld:r=!0,defaultValue:s,type:n})=>({label:e,validations:[...t?[{validator:F(l.i18n.translate("xpack.triggersActionsUI.sections.actionConnectorForm.error.requireFieldText",{values:{label:e},defaultMessage:"{label} is required."}))}]:[],...a?[{validator:M(l.i18n.translate("xpack.triggersActionsUI.sections.actionConnectorForm.error.invalidURL",{defaultMessage:"Invalid URL"}),{requireTld:r})}]:[]],defaultValue:s,...n&&j.FIELD_TYPES[n]?{type:j.FIELD_TYPES[n],defaultValue:Array.isArray(s)?s:[]}:{}}),L=({id:e,label:t,readOnly:a,isPasswordField:r,isRequired:s=!0,isUrlField:l,helpText:o,defaultValue:u,euiFieldProps:c={},type:d,requireTld:g})=>{const h=`${e}-input`,m=(e=>{let t=C;return e&&j.FIELD_TYPES[e]===j.FIELD_TYPES.COMBO_BOX&&(t=k),t})(d);return(0,p.jsx)(n().Fragment,null,(0,p.jsx)(i.EuiFlexGroup,null,(0,p.jsx)(i.EuiFlexItem,null,r?(0,p.jsx)(m,{path:e,config:O({label:t,type:d,isRequired:s}),helpText:o,component:w.PasswordField,componentProps:{euiFieldProps:{...c,"data-test-subj":h,readOnly:a}}}):(0,p.jsx)(m,{path:e,config:O({label:t,isUrlField:l,defaultValue:u,type:d,isRequired:s,requireTld:g}),helpText:o,componentProps:{euiFieldProps:{...c,readOnly:a,fullWidth:!0,"data-test-subj":h}}}))))},P=({isEdit:e,readOnly:t,configFormSchema:a,secretsFormSchema:s,configFormSchemaAfterSecrets:o=[]})=>(0,p.jsx)(n().Fragment,null,a.map((({id:e,...s},l)=>(0,p.jsx)(n().Fragment,{key:`config.${e}`},(0,p.jsx)(L,(0,r.default)({id:`config.${e}`},s,{readOnly:t})),l!==a.length?(0,p.jsx)(i.EuiSpacer,{size:"m"}):null))),(0,p.jsx)(i.EuiFlexGroup,null,(0,p.jsx)(i.EuiFlexItem,null,(0,p.jsx)(i.EuiTitle,{size:"xxs"},(0,p.jsx)("h4",null,l.i18n.translate("xpack.triggersActionsUI.components.simpleConnectorForm.secrets.authenticationLabel",{defaultMessage:"Authentication"}))))),(0,p.jsx)(i.EuiSpacer,{size:"m"}),s.map((({id:e,...a},l)=>(0,p.jsx)(n().Fragment,{key:`secrets.${e}`},(0,p.jsx)(L,(0,r.default)({id:`secrets.${e}`,key:`secrets.${e}`},a,{readOnly:t})),l!==s.length?(0,p.jsx)(i.EuiSpacer,{size:"m"}):null))),o.map((({id:e,...a},s)=>(0,p.jsx)(n().Fragment,{key:`config.${e}`},(0,p.jsx)(L,(0,r.default)({id:`config.${e}`},a,{readOnly:t})),s!==o.length?(0,p.jsx)(i.EuiSpacer,{size:"m"}):null)))),U=(0,s.memo)(P),D={editor:{name:"1236snz",styles:".euiFormRow__fieldWrapper .kibanaCodeEditor{height:auto;}"}},V=({field:e,...t})=>{const{errorMessage:a}=(0,j.getFieldValidityAndErrorMessage)(e),{label:n,helpText:i,value:o,setValue:u}=e,c=(0,s.useCallback)((e=>{u(e)}),[u]);return(0,p.jsx)("span",{css:D.editor},(0,p.jsx)(v,(0,r.default)({errors:a?[a]:[],helpText:(0,p.jsx)("p",null,i),inputTargetValue:o,label:null!=n?n:l.i18n.translate("xpack.triggersActionsUI.jsonFieldWrapper.defaultLabel",{defaultMessage:"JSON Editor"}),onDocumentsChange:c},t)))},B=({field:e,euiFieldProps:t,idAria:a,...n})=>{const{isInvalid:i,errorMessage:l}=(0,j.getFieldValidityAndErrorMessage)(e),{value:o,setValue:u}=e,c=(0,s.useCallback)(((e,t)=>{u(t)}),[u]);return(0,p.jsx)(_,(0,r.default)({errors:l?[l]:[],formRowProps:{describedByIds:a?[a]:void 0,error:l,fullWidth:!0,helpText:e.helpText,isInvalid:i,label:e.label,...n},index:0,inputTargetValue:o,wrapField:!0},t,{editAction:c}))};var N=a(4620)},4620:(e,t,a)=>{"use strict";a.d(t,{i:()=>n}),a(4286);var r=a(1319),s=a(6791);const n=({children:e})=>(0,s.jsx)(r.EuiEmptyPrompt,{title:(0,s.jsx)(r.EuiLoadingSpinner,{size:"xl"}),body:(0,s.jsx)(r.EuiText,{color:"subdued"},e),"data-test-subj":"sectionLoading"})},5586:(e,t,a)=>{"use strict";a.d(t,{S9:()=>l.BASE_ACTION_API_PATH,Gl:()=>i.BASE_ALERTING_API_PATH,X_:()=>T,xG:()=>y,KY:()=>A,ly:()=>b,F3:()=>E,db:()=>x,WR:()=>l.INTERNAL_BASE_ACTION_API_PATH,Ye:()=>i.INTERNAL_BASE_ALERTING_API_PATH,Dq:()=>S,Gt:()=>I,A:()=>_,gC:()=>v,ct:()=>f,SY:()=>o,R:()=>h,OD:()=>m,WH:()=>d,z6:()=>c,Wi:()=>u,Ou:()=>g,wK:()=>p});var r=a(5008),s=a(9397),n=a(875),i=a(2109),l=a(6728);let o=function(e){return e.SECOND="s",e.MINUTE="m",e.HOUR="h",e.DAY="d",e}({});const u="/",c="/connectors",d="/connectors/:connectorId",p="/rules",g="/logs",h="/alerts",m="/alert/:alertId";r.i18n.translate("xpack.triggersActionsUI.sections.actionForm.RecoveredMessage",{defaultMessage:"Recovered"}),r.i18n.translate("xpack.triggersActionsUI.sections.actionForm.SummaryMessage",{defaultMessage:"The system has detected '{{alerts.new.count}}' new, '{{alerts.ongoing.count}}' ongoing, and '{{alerts.recovered.count}}' recovered alerts."});const b=10,y=25,f=["execution_duration","total_search_duration","es_search_duration","schedule_delay"],v=["num_new_alerts","num_active_alerts","num_recovered_alerts"],S=["rule_name","timestamp","execution_duration","status","message","num_active_alerts","num_errored_actions"],_=[...S.slice(1)],x=["rule_name",...S.slice(1)],A="format:number:defaultPattern",T=["timestamp","status","connector_name","message"],E=[...T],I=[s.wE,n.iR,n.CJ]},8084:(e,t,a)=>{"use strict";a.d(t,{r:()=>i,v:()=>l});var r=a(4286),s=a.n(r),n=a(6791);const i=s().createContext(void 0),l=({children:e,value:t})=>(0,n.jsx)(i.Provider,{value:t},e);l.displayName="ConnectorProvider"},7176:(e,t,a)=>{"use strict";a.d(t,{kE:()=>o,d:()=>u,yn:()=>d,w3:()=>r.D,BX:()=>s.H,bF:()=>g});var r=a(7623),s=a(3673),n=a(5586);const i=({actionTypeId:e,...t})=>({...t,connector_type_id:e}),l=({connector_type_id:e,is_preconfigured:t,is_deprecated:a,is_missing_secrets:r,is_system_action:s,...n})=>({...n,actionTypeId:e,isPreconfigured:t,isDeprecated:a,isMissingSecrets:r,isSystemAction:s});async function o({http:e,connector:t}){const a=await e.post(`${n.S9}/connector`,{body:JSON.stringify(i(t))});return l(a)}async function u({ids:e,http:t}){const a=[],r=[];return(await Promise.allSettled(e.map((e=>t.delete(`${n.S9}/connector/${encodeURIComponent(e)}`))))).forEach((e=>{"fulfilled"===e.status?a.push(e.value):r.push(e.reason)})),{successes:a,errors:r}}const c=({connector_id:e,service_message:t,...a})=>({...a,actionId:e,serviceMessage:t});async function d({id:e,params:t,http:a,signal:r}){const s=await a.post(`${n.S9}/connector/${encodeURIComponent(e)}/_execute`,{body:JSON.stringify({params:t}),signal:r});return c(s)}const p=({connector_type_id:e,is_preconfigured:t,is_deprecated:a,is_missing_secrets:r,is_system_action:s,...n})=>({...n,actionTypeId:e,isPreconfigured:t,isDeprecated:a,isMissingSecrets:r,isSystemAction:s});async function g({http:e,connector:t,id:a}){const r=await e.put(`${n.S9}/connector/${encodeURIComponent(a)}`,{body:JSON.stringify({name:t.name,config:t.config,secrets:t.secrets})});return p(r)}},8256:(e,t,a)=>{"use strict";function r(e){return e.useWithTripleBracesInTemplates?`{{{${e.name}}}}`:`{{${e.name}}}`}a.d(t,{yn:()=>s.yn,DO:()=>n,HR:()=>r,bF:()=>s.bF});var s=a(7176);const n=e=>Boolean(e.isSnoozedUntil&&new Date(e.isSnoozedUntil).getTime()>Date.now()||e.muteAll)},3920:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const r=({rule_execution_status:e,rule_last_run_outcome:t,rule_enabled_status:a,rule_muted_status:r,rule_snoozed_status:s,rule_tags:n})=>({ruleExecutionStatus:e,ruleEnabledStatus:a,ruleMutedStatus:r,ruleSnoozedStatus:s,ruleLastRunOutcome:t,ruleTags:n})},9293:(e,t,a)=>{"use strict";a.d(t,{VG:()=>i,Zf:()=>l});const r=({last_execution_date:e,last_duration:t,...a})=>({lastExecutionDate:e,lastDuration:t,...a}),s=({outcome_msg:e,outcome_order:t,alerts_count:a,...r})=>({outcomeMsg:e,outcomeOrder:t,alertsCount:a,...r}),n=e=>e?{lookBackWindow:e.look_back_window,statusChangeThreshold:e.status_change_threshold}:e,i=({rule_type_id:e,created_by:t,updated_by:a,created_at:i,updated_at:l,api_key_owner:o,api_key_created_by_user:u,notify_when:c,mute_all:d,muted_alert_ids:p,scheduled_task_id:g,execution_status:h,actions:m,snooze_schedule:b,is_snoozed_until:y,active_snoozes:f,last_run:v,next_run:S,alert_delay:_,flapping:x,...A})=>({ruleTypeId:e,createdBy:t,updatedBy:a,createdAt:i,updatedAt:l,apiKeyOwner:o,notifyWhen:c,muteAll:d,mutedInstanceIds:p,snoozeSchedule:b,executionStatus:h?r(h):void 0,actions:m?m.map((e=>(e=>{const{uuid:t,id:a,connector_type_id:r,params:s}=e;return{..."group"in e&&e.group?{group:e.group}:{},id:a,params:s,actionTypeId:r,..."use_alert_data_for_template"in e&&void 0!==e.use_alert_data_for_template?{useAlertDataForTemplate:e.use_alert_data_for_template}:{},..."frequency"in e&&e.frequency?{frequency:{summary:e.frequency.summary,notifyWhen:e.frequency.notify_when,throttle:e.frequency.throttle}}:{},..."alerts_filter"in e&&e.alerts_filter?{alertsFilter:e.alerts_filter}:{},...t&&{uuid:t}}})(e))):[],scheduledTaskId:g,isSnoozedUntil:y,activeSnoozes:f,...v?{lastRun:s(v)}:{},...S?{nextRun:S}:{},...void 0!==u?{apiKeyCreatedByUser:u}:{},..._?{alertDelay:_}:{},...void 0!==x?{flapping:n(x)}:{},...A}),l=({rule_type_id:e,alert_delay:t,flapping:a,...r})=>({ruleTypeId:e,...t?{alertDelay:t}:{},...void 0!==a?{flapping:n(a)}:{},...r})},5384:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(4286),s=a(6337),n=a(6791);function i(e,t){return a=>(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)(s.K,{size:null!=t?t:"m"})},(0,n.jsx)(e,a))}},3770:(e,t,a)=>{"use strict";a.d(t,{bN:()=>n,nL:()=>i,nM:()=>l}),a(5079);var r=a(770);const s=a(5008).i18n.translate("xpack.triggersActionsUI.sections.actionTypeForm.error.requiredFilterQuery",{defaultMessage:"A custom query is required."}),n=e=>{if("alertsFilter"in e){var t;const a=null==e||null===(t=e.alertsFilter)||void 0===t?void 0:t.query;if(a&&!a.kql&&!a.filters.length)return s}return null};function i(e){return t=>{if(null==t)throw new Error(e);return t}}function l(e,t,a){const s="function"==typeof t?t:(0,r.constant)(t);return t=>{const r=new Set(t.map(a));for(const t of e.values())if(!r.has(t))throw new Error(s(t));return t}}},3142:(e,t,a)=>{"use strict";a.d(t,{AR:()=>o,VL:()=>i,dI:()=>l,t9:()=>n});var r=a(4286),s=a(5384);const n=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(711),a.e(2549)]).then(a.bind(a,2549))))),i=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(711),a.e(2357),a.e(9782)]).then(a.bind(a,9782))))),l=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(1179),a.e(565)]).then(a.bind(a,2946))))),o=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(711),a.e(8725)]).then(a.bind(a,8725)))));(0,s.Z)((0,r.lazy)((()=>a.e(5951).then(a.bind(a,5951)))))},3641:(e,t,a)=>{"use strict";a.d(t,{MJ:()=>f,Rd:()=>v,Vx:()=>x,UP:()=>A});var r=a(4286),s=a.n(r),n=a(1319),i=a(3059),l=a(5008),o=a(454),u=a(5879),c=a(6791);const d=(0,c.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsSummaryWidget.title",defaultMessage:"Alert activity"}),p=(0,c.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsSummaryWidget.alerts",defaultMessage:"Alerts"}),g=(0,c.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsSummaryWidget.activeNow",defaultMessage:"Active now"});var h=a(6752),m=a.n(h);const b=({label:e,count:t,handleClick:a,alertType:r,color:i,showWarningIcon:l,"data-test-subj":o})=>{const u=(0,c.jsx)(s().Fragment,null,(0,c.jsx)(n.EuiTitle,{size:"s"},(0,c.jsx)(n.EuiTextColor,{"data-test-subj":o,color:i},m()(t).format("0.[00]a"),t>0&&l?(0,c.jsx)(s().Fragment,null,"",(0,c.jsx)(n.EuiIcon,{type:"warning",ascent:10})):null)),(0,c.jsx)(n.EuiText,{size:"s",color:"subdued"},e));return(0,c.jsx)(n.EuiFlexItem,{style:{minWidth:50,wordWrap:"break-word"},grow:!1},a?(0,c.jsx)(n.EuiLink,{onClick:e=>{a(e,r)}},u):u)},y=({activeAlertCount:e,recoveredAlertCount:t,handleClick:a})=>{const{euiTheme:r}=(0,n.useEuiTheme)();return(0,c.jsx)(n.EuiFlexGroup,{gutterSize:"l",responsive:!1},(0,c.jsx)(b,{label:p,count:e+t,color:r.colors.vis.euiColorVis0,"data-test-subj":"totalAlertCount",handleClick:a}),(0,c.jsx)(b,{label:g,count:e,color:e>0?r.colors.textDanger:r.colors.textSuccess,alertType:o.R5,handleClick:a,showWarningIcon:!0,"data-test-subj":"activeAlertCount"}))},f=({activeAlertCount:e,activeAlerts:t,chartProps:{themeOverrides:a}={},recoveredAlertCount:r,timeRangeTitle:s,onClick:o,dependencyProps:{baseTheme:u,sparklineTheme:p}})=>{const{euiTheme:g}=(0,n.useEuiTheme)();return(0,c.jsx)(n.EuiPanel,{element:"div","data-test-subj":"alertSummaryWidgetCompact",hasShadow:!1,hasBorder:!0},(0,c.jsx)(n.EuiFlexGroup,{direction:"column"},!!s&&(0,c.jsx)(n.EuiFlexItem,null,(0,c.jsx)(n.EuiTitle,{size:"xxs"},(0,c.jsx)("h5",null,d)),(0,c.jsx)(n.EuiSpacer,{size:"s"}),(0,c.jsx)(n.EuiText,{size:"s",color:"subdued","data-test-subj":"timeRangeTitle"},s)),(0,c.jsx)(n.EuiFlexItem,null,(0,c.jsx)(y,{activeAlertCount:e,recoveredAlertCount:r,handleClick:(e,t)=>{e.preventDefault(),e.stopPropagation(),o(t)}})),(0,c.jsx)(n.EuiFlexItem,null,(0,c.jsx)(n.EuiFlexGroup,{wrap:!0},(0,c.jsx)(n.EuiFlexItem,{style:{minWidth:"200px"}},(0,c.jsx)(i.Chart,{size:{height:50}},(0,c.jsx)(i.Tooltip,{type:i.TooltipType.None}),(0,c.jsx)(i.Settings,{theme:[...a?Array.isArray(a)?a:[a]:[],p,{chartMargins:{left:10,right:10,top:10,bottom:10}}],baseTheme:u,locale:l.i18n.getLocale()}),(0,c.jsx)(i.Axis,{hide:!0,id:"activeAlertsAxis",position:i.Position.Left,gridLine:{visible:!1}}),(0,c.jsx)(i.LineSeries,{id:"activeAlertsChart",xScaleType:i.ScaleType.Time,yScaleType:i.ScaleType.Linear,xAccessor:"key",yAccessors:["doc_count"],data:t,lineSeriesStyle:{line:{strokeWidth:2,stroke:g.colors.vis.euiColorVis0}},curve:i.CurveType.CURVE_MONOTONE_X})))))))},v=()=>(0,c.jsx)(n.EuiEmptyPrompt,{"data-test-subj":"alertSummaryWidgetError",iconType:"warning",color:"danger",title:(0,c.jsx)("h5",null,(0,c.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsSummaryWidget.errorTitle",defaultMessage:"Unable to load the alerts summary"})),body:(0,c.jsx)("p",null,(0,c.jsx)(u.FormattedMessage,{id:"xpack.triggersActionsUI.sections.alertsSummaryWidget.errorBody",defaultMessage:"There was an error loading the alerts summary. Contact your administrator for help."}))});var S=a(1783),_=a.n(S);const x=({activeAlertCount:e,activeAlerts:t,chartProps:{themeOverrides:a,onBrushEnd:r}={},dateFormat:s,recoveredAlertCount:o,timeZone:u,hideChart:d,hideStats:p,dependencyProps:{baseTheme:g}})=>{const{euiTheme:h}=(0,n.useEuiTheme)(),m=t.map((e=>e.doc_count)),b={max:1.1*Math.max(...m),min:.9*Math.min(...m)};return(0,c.jsx)(n.EuiPanel,{element:"div","data-test-subj":"alertSummaryWidgetFullSize",hasShadow:!1,paddingSize:"none"},!p&&(0,c.jsx)(n.EuiFlexItem,{"data-test-subj":"alertSummaryWidgetFullSizeStats"},(0,c.jsx)(y,{activeAlertCount:e,recoveredAlertCount:o})),!d&&(0,c.jsx)("div",{"data-test-subj":"alertSummaryWidgetFullSizeChartContainer"},(0,c.jsx)(n.EuiSpacer,{size:"l"}),(0,c.jsx)(i.Chart,{size:["100%",170]},(0,c.jsx)(i.Tooltip,{headerFormatter:e=>_()(e.value).format(s||"YYYY-MM-DD HH:mm")}),(0,c.jsx)(i.Settings,{legendPosition:i.Position.Right,theme:[...a?Array.isArray(a)?a:[a]:[],{chartPaddings:{top:7}}],onBrushEnd:r,locale:l.i18n.getLocale()}),(0,c.jsx)(i.Axis,{id:"bottom",position:i.Position.Bottom,gridLine:{visible:!0}}),(0,c.jsx)(i.Axis,{id:"left",position:i.Position.Left,gridLine:{visible:!0},integersOnly:!0,ticks:4,domain:b}),(0,c.jsx)(i.Axis,{id:"right",position:i.Position.Right,gridLine:{visible:!0},integersOnly:!0,ticks:4}),(0,c.jsx)(i.LineSeries,{id:"Active",xScaleType:i.ScaleType.Time,yScaleType:i.ScaleType.Linear,xAccessor:"key",yAccessors:["doc_count"],color:[h.colors.vis.euiColorVis0],data:t,lineSeriesStyle:{line:{strokeWidth:2},point:{visible:"never"}},curve:i.CurveType.CURVE_MONOTONE_X,timeZone:u}))))},A=({fullSize:e,isLoadingWithoutChart:t})=>(0,c.jsx)("div",{style:{minHeight:t?44:e?238:224,display:"flex",alignItems:"center",justifyContent:t?"flex-start":"center"}},t?(0,c.jsx)(n.EuiLoadingSpinner,{size:"m"}):(0,c.jsx)(n.EuiLoadingChart,{size:"l","data-test-subj":"alertSummaryWidgetLoading"}))},2477:(e,t,a)=>{"use strict";a.r(t),a.d(t,{UntrackAlertsModal:()=>d});var r=a(4286),s=a(5008),n=a(1319),i=a(6791);const l=s.i18n.translate("xpack.triggersActionsUI.sections.untrackAlertsModal.title",{defaultMessage:"Disable rule"}),o=s.i18n.translate("xpack.triggersActionsUI.sections.untrackAlertsModal.confirmButtonText",{defaultMessage:"Disable"}),u=s.i18n.translate("xpack.triggersActionsUI.sections.untrackAlertsModal.cancelButtonText",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.triggersActionsUI.sections.untrackAlertsModal.toggleLabel",{defaultMessage:"Change alert statuses from active to untracked"}),d=e=>{const{onCancel:t,onConfirm:a}=e,[s,d]=(0,r.useState)(!1),p=(0,r.useCallback)((e=>{d(e.target.checked)}),[]),g=(0,n.useGeneratedHtmlId)();return(0,i.jsx)(n.EuiConfirmModal,{"data-test-subj":"untrackAlertsModal",title:l,onCancel:t,onConfirm:()=>a(s),confirmButtonText:o,cancelButtonText:u,"aria-labelledby":g,titleProps:{id:g}},(0,i.jsx)(n.EuiSwitch,{"data-test-subj":"untrackAlertsModalSwitch",label:c,checked:s,onChange:p}))}},9020:(e,t,a)=>{"use strict";a.d(t,{Bp:()=>o,KC:()=>d,MJ:()=>c,MR:()=>i,Rq:()=>u,Wc:()=>h,dI:()=>n,il:()=>g,mN:()=>p,rD:()=>m,s0:()=>b,xl:()=>l});var r=a(4286),s=a(5384);(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(711),a.e(2549)]).then(a.bind(a,2549))))),(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(711),a.e(2357),a.e(9782)]).then(a.bind(a,9782)))));const n=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(1179),a.e(565)]).then(a.bind(a,2946))))),i=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(1525),a.e(5761)]).then(a.bind(a,5761))))),l=(0,s.Z)((0,r.lazy)((()=>a.e(8703).then(a.bind(a,8703))))),o=(0,s.Z)((0,r.lazy)((()=>a.e(3996).then(a.bind(a,3996))))),u=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(2043),a.e(2233),a.e(5946),a.e(5177),a.e(6030),a.e(5088)]).then(a.bind(a,6030))))),c=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(1525),a.e(2043),a.e(2233),a.e(156),a.e(2357),a.e(8095)]).then(a.bind(a,8095))))),d=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(1525),a.e(156),a.e(2686)]).then(a.bind(a,156))))),p=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(1525),a.e(156),a.e(2655)]).then(a.bind(a,2655))))),g=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(9063)]).then(a.bind(a,9063))))),h=(0,s.Z)((0,r.lazy)((()=>a.e(9015).then(a.bind(a,9015))))),m=(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(1525),a.e(2233),a.e(156),a.e(2713)]).then(a.bind(a,2713))))),b=((0,s.Z)((0,r.lazy)((()=>Promise.resolve().then(a.bind(a,2477)).then((e=>({default:e.UntrackAlertsModal})))))),(0,s.Z)((0,r.lazy)((()=>Promise.all([a.e(6239),a.e(4386),a.e(2043),a.e(2233),a.e(5946),a.e(5177),a.e(6163)]).then(a.bind(a,8370))))))},8901:(e,t,a)=>{"use strict";a.d(t,{D:()=>n,X:()=>i});var r=a(1783),s=a.n(r);const n=e=>Boolean(e.isSnoozedUntil&&new Date(e.isSnoozedUntil).getTime()>Date.now()||e.muteAll),i=e=>{if(!e.snoozeSchedule)return null;const t=e.snoozeSchedule.filter((e=>Boolean(e.id)));return 0===t.length?null:t.reduce(((e,t)=>s()(t.rRule.dtstart).isBefore(s()(e.rRule.dtstart))?t:e))}},8471:(e,t,a)=>{"use strict";a.d(t,{HC:()=>s,SU:()=>n});var r=a(5008);r.i18n.translate("xpack.triggersActionsUI.sections.actionForm.preconfiguredTitleMessage",{defaultMessage:"(preconfigured)"});const s=r.i18n.translate("xpack.triggersActionsUI.sections.deprecatedTitleMessage",{defaultMessage:"(deprecated)"}),n=r.i18n.translate("xpack.triggersActionsUI.sections.isDeprecatedDescription",{defaultMessage:"This connector is deprecated. Update it, or create a new one."})},7793:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ALERTS_PAGE_ID:()=>h,CONNECTORS_PLUGIN_ID:()=>m,ConnectorAddModal:()=>u.AR,DEFAULT_FREQUENCY:()=>d,I18N_WEEKDAY_OPTIONS:()=>p.z,I18N_WEEKDAY_OPTIONS_DDD:()=>p.i,PLUGIN_ID:()=>g,VIEW_LICENSE_OPTIONS_LINK:()=>n.cY,builtInAggregationTypes:()=>l,builtInComparators:()=>b,builtInGroupByTypes:()=>c,loadActionTypes:()=>o.w3,loadAllActions:()=>o.BX});let r=function(e){return e.GREATER_THAN=">",e.GREATER_THAN_OR_EQUALS=">=",e.BETWEEN="between",e.LESS_THAN="<",e.LESS_THAN_OR_EQUALS="<=",e.NOT_BETWEEN="notBetween",e}({});var s=a(5008),n=a(7346),i=function(e){return e.COUNT="count",e.AVERAGE="avg",e.SUM="sum",e.MIN="min",e.MAX="max",e}(i||{});const l={count:{text:"count()",fieldRequired:!1,value:i.COUNT,validNormalizedTypes:[]},avg:{text:"average()",fieldRequired:!0,validNormalizedTypes:["number"],value:i.AVERAGE},sum:{text:"sum()",fieldRequired:!0,validNormalizedTypes:["number"],value:i.SUM},min:{text:"min()",fieldRequired:!0,validNormalizedTypes:["number","date"],value:i.MIN},max:{text:"max()",fieldRequired:!0,validNormalizedTypes:["number","date"],value:i.MAX}};var o=a(7176),u=a(3142);const c={all:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.groupByTypes.allDocumentsLabel",{defaultMessage:"all documents"}),sizeRequired:!1,value:"all",validNormalizedTypes:[]},top:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.groupByTypes.topLabel",{defaultMessage:"top"}),sizeRequired:!0,value:"top",validNormalizedTypes:["number","date","keyword"]}},d={notifyWhen:a(2109).RuleNotifyWhen.CHANGE,throttle:null,summary:!1};var p=a(7379);const g="triggersActions",h="triggersActionsAlerts",m="triggersActionsConnectors",b={[r.GREATER_THAN]:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.isAboveLabel",{defaultMessage:"Is above"}),value:r.GREATER_THAN,requiredValues:1},[r.GREATER_THAN_OR_EQUALS]:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.isAboveOrEqualsLabel",{defaultMessage:"Is above or equals"}),value:r.GREATER_THAN_OR_EQUALS,requiredValues:1},[r.LESS_THAN]:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.isBelowLabel",{defaultMessage:"Is below"}),value:r.LESS_THAN,requiredValues:1},[r.LESS_THAN_OR_EQUALS]:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.isBelowOrEqualsLabel",{defaultMessage:"Is below or equals"}),value:r.LESS_THAN_OR_EQUALS,requiredValues:1},[r.BETWEEN]:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.isBetweenLabel",{defaultMessage:"Is between"}),value:r.BETWEEN,requiredValues:2},[r.NOT_BETWEEN]:{text:s.i18n.translate("xpack.triggersActionsUI.common.constants.comparators.isNotBetweenLabel",{defaultMessage:"Is not between"}),value:r.NOT_BETWEEN,requiredValues:2}}},4530:(e,t,a)=>{"use strict";a.d(t,{Z:()=>ExperimentalFeaturesService});var r=a(8915);class ExperimentalFeaturesService{static init({experimentalFeatures:e}){this.experimentalFeatures=e}static get(){return this.experimentalFeatures||this.throwUninitializedError(),this.experimentalFeatures}static throwUninitializedError(){throw new Error("Experimental features services not initialized - are you trying to import this module from outside of the triggers actions UI app?")}}(0,r.default)(ExperimentalFeaturesService,"experimentalFeatures",void 0)},4157:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var r=a(4022),s=a(4530);const n=(0,r.hK)(),i=e=>{if(!(0,r.eI)(e))throw new Error(`Invalid enable value ${e}. Allowed values are: ${n.join(", ")}`);return s.Z.get()[e]}},1927:(e,t,a)=>{"use strict";a.r(t),a.d(t,{BUCKET_SELECTOR_FIELD:()=>x,ForLastExpression:()=>i,GroupByExpression:()=>n,NORMALIZED_FIELD_TYPES:()=>j,OfExpression:()=>u,ThresholdExpression:()=>c,ValueExpression:()=>l,WhenExpression:()=>o,buildAggregation:()=>I,builtInAggregationTypes:()=>d.builtInAggregationTypes,builtInComparators:()=>d.builtInComparators,builtInGroupByTypes:()=>d.builtInGroupByTypes,connectorDeprecatedMessage:()=>p.SU,deprecatedMessage:()=>p.HC,firstFieldOption:()=>g.Kn,getFields:()=>g.ww,getIndexOptions:()=>g.pe,getTimeFieldOptions:()=>h.ey,getTimeOptions:()=>h.Sk,isCountAggregation:()=>A,isGroupAggregation:()=>T,isPerRowAggregation:()=>E,parseAggregationResults:()=>w,useKibana:()=>h.o1});var r=a(4286),s=a(5384);const n=(0,s.Z)((0,r.lazy)((()=>a.e(9426).then(a.bind(a,9426))))),i=(0,s.Z)((0,r.lazy)((()=>a.e(7012).then(a.bind(a,7012))))),l=(0,s.Z)((0,r.lazy)((()=>a.e(4169).then(a.bind(a,4169))))),o=(0,s.Z)((0,r.lazy)((()=>a.e(816).then(a.bind(a,816))))),u=(0,s.Z)((0,r.lazy)((()=>a.e(779).then(a.bind(a,779))))),c=(0,s.Z)((0,r.lazy)((()=>a.e(4027).then(a.bind(a,4027)))));var d=a(7793),p=a(8471),g=a(3528),h=a(7286),m=a(2109),b=a(5008),y=a(770);function f(e,t){if(e)return function(e,t){const a=Date.parse(e);if(isNaN(a))throw new Error(S("date",t,e));return a.valueOf()}(e,t)}function v(e,t){try{return(0,m.parseDuration)(e)}catch(a){throw new Error(S("duration",t,e))}}function S(e,t,a){return b.i18n.translate("xpack.triggersActionsUI.data.coreQueryParams.formattedFieldErrorMessage",{defaultMessage:'invalid {formatName} format for {fieldName}: "{fieldValue}"',values:{formatName:e,fieldName:t,fieldValue:a}})}const _="compareValue",x=`params.${_}`,A=e=>"count"===e,T=e=>!!e,E=e=>"row"===e,I=({timeSeries:e,aggType:t,aggField:a,termField:r,termSize:s,condition:n,topHitsSize:i,loggerCb:l})=>{var o;const u={aggs:{}},c=A(t),d=T(r),p=Array.isArray(r),g=!!e,h=!!n;let m=null;if(g){const{timeWindowSize:t,timeWindowUnit:a,dateStart:r,dateEnd:s,interval:n}=e;m=function(e){const{dateStart:t,dateEnd:a,interval:r,window:s}=e,n=f(a,"dateEnd")||Date.now(),i=f(t,"dateStart")||n;if(i>n)throw new Error(b.i18n.translate("xpack.triggersActionsUI.data.coreQueryParams.dateStartGTdateEndErrorMessage",{defaultMessage:"[dateStart]: is greater than [dateEnd]"}));const l=((o=r)?v(o,"interval"):void 0)||0;var o;const u=v(s,"window");let c=n;const d=[],p=l?1+Math.round((n-i)/l):1;if(p>1e3)throw new Error(function(e){return b.i18n.translate("xpack.triggersActionsUI.data.coreQueryParams.maxIntervalsErrorMessage",{defaultMessage:"calculated number of intervals {intervals} is greater than maximum {maxIntervals}",values:{intervals:e,maxIntervals:1e3}})}(p));return(0,y.times)(p,(()=>{d.push({from:new Date(c-u).toISOString(),to:new Date(c).toISOString()}),c-=l})),d.reverse(),{dateStart:d[0].from,dateEnd:d[d.length-1].to,dateRanges:d}}({dateStart:r,dateEnd:s,window:`${t}${a}`,interval:n})}let S=s||100;S=h&&n.resultLimit&&S>n.resultLimit?n.resultLimit+1:S;let x=u;const E=()=>g?"sortValueAgg":"metricAgg";if(d){if(x.aggs={groupAgg:{...p?{multi_terms:{terms:r.map((e=>({field:e}))),size:S}}:{terms:{field:r,size:S}}},...h?{groupAggCount:{stats_bucket:{buckets_path:"groupAgg._count"}}}:{}},c)h&&(x.aggs.groupAgg.aggs={conditionSelector:{bucket_selector:{buckets_path:{[_]:"_count"},script:n.conditionScript}}});else{const e="min"===t?"asc":"desc";p&&x.aggs.groupAgg.multi_terms?x.aggs.groupAgg.multi_terms.order={[E()]:e}:x.aggs.groupAgg.terms&&(x.aggs.groupAgg.terms.order={[E()]:e})}x=x.aggs.groupAgg}var I,w,j;return g&&(x.aggs={...x.aggs,dateAgg:{date_range:{field:e.timeField,format:"strict_date_time",ranges:m.dateRanges}}}),d&&i&&(i>100&&(i=100,l&&l("Top hits size is capped at 100")),x.aggs={...x.aggs,topHitsAgg:{top_hits:{size:i}}}),c||(x.aggs={...x.aggs,[E()]:{[t]:{field:a}}},d&&h&&(x.aggs.conditionSelector={bucket_selector:{buckets_path:{[_]:E()},script:n.conditionScript}})),e&&m&&(x=null!==(I=null===(w=x)||void 0===w||null===(j=w.aggs)||void 0===j?void 0:j.dateAgg)&&void 0!==I?I:{},c||(x.aggs={metricAgg:{[t]:{field:a}}})),null!==(o=u.aggs)&&void 0!==o?o:{}},w=({isCountAgg:e,isGroupAgg:t,esResult:a,resultLimit:r,sourceFieldsParams:s=[],generateSourceFieldsFromHits:n=!1,termField:i})=>{var l,o,u;const c=(null==a?void 0:a.aggregations)||{};var d,p,g,h,m;t||(c.groupAgg={buckets:[{key:"all documents",doc_count:(h=a.hits.total,"number"==typeof h?h:null!==(m=null==h?void 0:h.value)&&void 0!==m?m:0),topHitsAgg:{hits:{hits:null!==(d=a.hits.hits)&&void 0!==d?d:[]}},...c,...e?{}:{metricAgg:{value:null!==(p=null===(g=c.metricAgg)||void 0===g?void 0:g.value)&&void 0!==p?p:0}}}]});const b=(null===(l=c.groupAgg)||void 0===l?void 0:l.buckets)||[],f=null!==(o=null===(u=c.groupAggCount)||void 0===u?void 0:u.count)&&void 0!==o?o:0,v={results:[],truncated:!!r&&f>r};for(const t of b){var S,_,x,A;if(r&&v.results.length===r)break;const a=`${null==t?void 0:t.key}`,l=[null!=i?i:[]].flat(),o=[t.key].flat(),u=i&&null!=t&&t.key?l.reduce(((e,t,a)=>(e.push({field:t,value:o[a]}),e)),[]):void 0,c=i&&null!=t&&t.key?l.reduce(((e,t,a)=>(e[t]=o[a],e)),{}):void 0,d={};n&&s.forEach((e=>{var a,r,s;const n=[];if((null!==(a=null==t||null===(r=t.topHitsAgg)||void 0===r||null===(s=r.hits)||void 0===s?void 0:s.hits)&&void 0!==a?a:[]).forEach((t=>{const a=(0,y.get)(t._source,e.label);a&&n.push(a)})),n.length>0){const t=Array.isArray(n);d[e.label]=Array.from(t?n.flat():n)}}));const p={group:a,groups:u,groupingObject:c,count:null==t?void 0:t.doc_count,hits:null!==(S=null==t||null===(_=t.topHitsAgg)||void 0===_||null===(x=_.hits)||void 0===x?void 0:x.hits)&&void 0!==S?S:[],...e?{}:{value:null==t||null===(A=t.metricAgg)||void 0===A?void 0:A.value},sourceFields:d};v.results.push(p)}return v},j={long:"number",integer:"number",short:"number",byte:"number",double:"number",float:"number",half_float:"number",scaled_float:"number",unsigned_long:"number"}},3528:(e,t,a)=>{"use strict";a.d(t,{Kn:()=>o,pe:()=>i,ww:()=>l});var r=a(770),s=a(5008),n=a(1286);const i=async(e,t)=>{const a=[];if(!t)return a;const[i,l]=await Promise.all([(0,n.f$)({pattern:t,http:e}),(0,n.KK)(t)]);if(i.length||l.length){const e=(0,r.uniq)([...i,...l]);a.push({label:s.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.indicesAndIndexPatternsLabel",{defaultMessage:"Based on your data views"}),options:e.map((e=>({label:e,value:e})))})}return a.push({label:s.i18n.translate("xpack.triggersActionsUI.components.builtinActionTypes.indexAction.chooseLabel",{defaultMessage:"Choose"}),options:[{value:t,label:t}]}),a},l=async(e,t)=>await(0,n.qU)({indexes:t,http:e}),o={text:s.i18n.translate("xpack.triggersActionsUI.sections.ruleAdd.indexControls.timeFieldOptionLabel",{defaultMessage:"Select a field"}),value:""}},1286:(e,t,a)=>{"use strict";a.d(t,{KK:()=>u,f$:()=>n,m7:()=>o,qU:()=>i});const r="/internal/triggers_actions_ui/data",s=e=>{let t=e;return t.startsWith("*")||(t=`*${t}`),t.endsWith("*")||(t=`${t}*`),t};async function n({pattern:e,http:t}){try{const a=s(e),{indices:n}=await t.post(`${r}/_indices`,{body:JSON.stringify({pattern:a})});return n}catch(e){return[]}}async function i({indexes:e,http:t}){const{fields:a}=await t.post(`${r}/_fields`,{body:JSON.stringify({indexPatterns:e})});return a}let l;const o=e=>{l=e},u=async e=>{const t=s(e);try{return(await l.find(t,1e3)).map((e=>e.title))}catch(e){return[]}}},8937:(e,t,a)=>{"use strict";a.d(t,{S:()=>n,e:()=>i});var r=a(988),s=a(5586);const n=e=>Object.entries(s.SY).map((([t,a])=>({text:(0,r.Q)(a,e.toString()),value:a}))),i=e=>{const t=[];return e.forEach((e=>{"date"!==e.type&&"date_nanos"!==e.type||t.push({text:e.name,value:e.name})})),t}},988:(e,t,a)=>{"use strict";a.d(t,{Q:()=>n});var r=a(5008),s=a(5586);function n(e=s.SY.SECOND,t="0"){switch(e){case s.SY.SECOND:return r.i18n.translate("xpack.triggersActionsUI.timeUnits.secondLabel",{defaultMessage:"{timeValue, plural, one {second} other {seconds}}",values:{timeValue:t}});case s.SY.MINUTE:return r.i18n.translate("xpack.triggersActionsUI.timeUnits.minuteLabel",{defaultMessage:"{timeValue, plural, one {minute} other {minutes}}",values:{timeValue:t}});case s.SY.HOUR:return r.i18n.translate("xpack.triggersActionsUI.timeUnits.hourLabel",{defaultMessage:"{timeValue, plural, one {hour} other {hours}}",values:{timeValue:t}});case s.SY.DAY:return r.i18n.translate("xpack.triggersActionsUI.timeUnits.dayLabel",{defaultMessage:"{timeValue, plural, one {day} other {days}}",values:{timeValue:t}})}}},7286:(e,t,a)=>{"use strict";a.d(t,{Sk:()=>r.S,_f:()=>s._f,ep:()=>s.ep,ey:()=>r.e,o1:()=>n.o1});var r=a(8937),s=a(2993),n=a(6406)},6406:(e,t,a)=>{"use strict";a.d(t,{Xf:()=>r.KibanaContextProvider,o1:()=>s,tH:()=>i});var r=a(409);const s=()=>(0,r.useKibana)();var n=a(4286);const i=()=>{const{spaces:e}=s().services,[t,a]=(0,n.useState)(void 0),r=null==e?void 0:e.ui.useSpaces();return(0,n.useEffect)((()=>{(async()=>{const e=await(null==r?void 0:r.spacesDataPromise);a(e)})()}),[e,r,a]),t}},2993:(e,t,a)=>{"use strict";a.d(t,{Mn:()=>o,Y6:()=>l,_f:()=>n,cw:()=>u,ep:()=>i});var r=a(2109),s=a(4157);const n=(e,t)=>{switch(e){case"succeeded":return t.colors.success;case"failed":return t.colors.danger;case"warning":return t.colors.warning;default:return"subdued"}},i=(e,t)=>{switch(e){case"active":return t.colors.success;case"error":return t.colors.danger;case"ok":return t.colors.primary;case"pending":return t.colors.accent;case"warning":return t.colors.warning;default:return"subdued"}},l=(e,t)=>(0,s.E)("ruleUseExecutionStatus")?i(e.executionStatus.status,t):e.lastRun&&n(e.lastRun.outcome,t)||"subdued",o=e=>{var t,a;return(null===(t=e.lastRun)||void 0===t?void 0:t.warning)===r.RuleExecutionStatusErrorReasons.License||(null===(a=e.executionStatus.error)||void 0===a?void 0:a.reason)===r.RuleExecutionStatusErrorReasons.License},u=({rule:e,licenseErrorText:t,lastOutcomeTranslations:a,executionStatusTranslations:r})=>{const n=o(e),i=(0,s.E)("ruleUseExecutionStatus");return n?t:i?r[e.executionStatus.status]:e.lastRun&&a[e.lastRun.outcome]}},9419:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ALERT_HISTORY_PREFIX:()=>K.PK,ActionConnectorMode:()=>K.FQ,ActionForm:()=>h.dI,AlertHistoryDefaultIndexName:()=>K.VJ,AlertHistoryDocumentTemplate:()=>K.MF,AlertHistoryEsIndexConnectorId:()=>K.Vs,AlertProvidedActionVariables:()=>Z.FI,CreateConnectorFlyout:()=>h.t9,EditConnectorFlyout:()=>h.VL,ForLastExpression:()=>J.ForLastExpression,GroupByExpression:()=>J.GroupByExpression,JsonEditorWithMessageVariables:()=>Q.gk,JsonFieldWrapper:()=>Q.Er,MustacheTextFieldWrapper:()=>Q.HE,OfExpression:()=>J.OfExpression,Plugin:()=>Plugin,SectionLoading:()=>Q.iO,SimpleConnectorForm:()=>Q.mW,TIME_UNITS:()=>ie.SY,TextAreaWithMessageVariables:()=>Q.JR,TextFieldWithMessageVariables:()=>Q.GP,ThresholdExpression:()=>J.ThresholdExpression,ValueExpression:()=>J.ValueExpression,WhenExpression:()=>J.WhenExpression,builtInAggregationTypes:()=>J.builtInAggregationTypes,builtInComparators:()=>J.builtInComparators,builtInGroupByTypes:()=>J.builtInGroupByTypes,connectorDeprecatedMessage:()=>J.connectorDeprecatedMessage,deprecatedMessage:()=>J.deprecatedMessage,executeAction:()=>G.yn,firstFieldOption:()=>J.firstFieldOption,getFields:()=>J.getFields,getIndexOptions:()=>J.getIndexOptions,getTimeFieldOptions:()=>J.getTimeFieldOptions,getTimeOptions:()=>J.getTimeOptions,getTimeUnitLabel:()=>ce.Q,loadRuleAggregations:()=>ue,plugin:()=>ge,templateActionVariable:()=>G.HR,transformRule:()=>de.VG,updateActionConnector:()=>G.bF,useConnectorContext:()=>Y,useKibana:()=>J.useKibana,useSubAction:()=>ne,validateActionFilterQuery:()=>pe.bN});var r=a(8915),s=a(5008),n=a(1215),i=a(2745),l=a(2657);s.i18n.translate("uiActions.triggers.rowClickTitle",{defaultMessage:"Table row click"}),s.i18n.translate("uiActions.triggers.rowClickkDescription",{defaultMessage:"A click on a table row"}),s.i18n.translate("uiActions.triggers.dashboard.addPanelMenu.title",{defaultMessage:"Add panel menu"}),s.i18n.translate("uiActions.triggers.dashboard.addPanelMenu.description",{defaultMessage:"A new action will appear to the dashboard's add panel menu"});const o="alertRule";s.i18n.translate("uiActions.triggers.dashboard.alertRule.title",{defaultMessage:"Create alert rule"}),s.i18n.translate("uiActions.triggers.dashboard.alertRule.description",{defaultMessage:"Create an alert rule from this dashboard panel"});var u=a(7546),c=a(4286),d=a.n(c),p=a(3530),g=a(8084),h=a(3142),m=a(6791);const b=new p.QueryClient,y=new p.QueryClient;var f=a(9020);const v=new p.QueryClient,S=new p.QueryClient;var _=a(1192);const x=new p.QueryClient;var A=a(4530),T=a(4022),E=a(7793),I=a(1319);const w=(0,c.lazy)((()=>a.e(447).then(a.bind(a,447)))),j=new p.QueryClient,R=new p.QueryClient;var C=a(3641);const k=(0,c.lazy)((()=>a.e(2491).then(a.bind(a,2491)))),F=new p.QueryClient,M=(0,c.lazy)((()=>Promise.all([a.e(2043),a.e(1367)]).then(a.bind(a,2043))));var O=a(190);let L=function(e){return e.lensEdit="lensEdit",e.docViewer="docViewer",e.esqlDocs="esqlDocs",e.metricInsights="metricInsights",e.esqlControls="esqlControls",e.lensAlertRule="lensAlertRule",e.inspectorPanel="inspectorPanel",e}({});const P=Object.values(L);var U=a(5804),D=a(6524),V=a.n(D);const B=e=>{if(!e)return;const t=(e=>{const t="button, [href], input, select, textarea, [tabindex]";return e?e.matches(t)?e:e.querySelector(t):null})(e);setTimeout((()=>{e.contains(document.activeElement)||null==t||t.focus()}))},N=(0,m.jsx)(I.EuiDelayRender,{delay:300},(0,m.jsx)(I.EuiFlyoutHeader,{hasBorder:!0},(0,m.jsx)(I.EuiSkeletonTitle,{size:"xs"})),(0,m.jsx)(I.EuiFlyoutBody,null,(0,m.jsx)(I.EuiSkeletonText,null))),z=(0,I.htmlIdGenerator)("modalTitleId");function W({core:e,loadContent:t,closeFlyout:a,ariaLabelledBy:r}){const[n,i]=d().useState(null);return V()((async()=>{const n=await(null==t?void 0:t({closeFlyout:a,ariaLabelledBy:r}));if(!n)throw a(),e.notifications.toasts.addWarning(s.i18n.translate("presentationUtils.openLazyFlyout.unableToLoad",{defaultMessage:"Unable to load edit flyout content"})),new Error("Unable to load edit flyout content");i(n)}),[]),d().useEffect((()=>{n&&B(document.querySelector(".kbnPresentationLazyFlyout"))}),[n]),null!=n?n:N}var q={name:"nhejpy",styles:"container-type:inline-size"};class AlertRuleFromVisAction{constructor(e,t,a){(0,r.default)(this,"ruleTypeRegistry",void 0),(0,r.default)(this,"actionTypeRegistry",void 0),(0,r.default)(this,"startDependencies",void 0),(0,r.default)(this,"type",o),(0,r.default)(this,"id",o),(0,r.default)(this,"getIconType",(()=>"bell")),(0,r.default)(this,"getDisplayName",(()=>s.i18n.translate("xpack.triggersActionsUI.alertRuleFromVis.actionName",{defaultMessage:"Create alert rule"}))),(0,r.default)(this,"shouldAutoExecute",(async()=>!0)),this.ruleTypeRegistry=e,this.actionTypeRegistry=t,this.startDependencies=a}async isCompatible({embeddable:e}){var t;if(t=e,!Boolean(t&&t.type)||"lens"!==t.type||function(e){var t,a;return a=e,Boolean(a&&void 0!==(null==a?void 0:a.blockingError$))&&void 0!==(null===(t=e.blockingError$)||void 0===t?void 0:t.value)}(e))return!1;const a=e.query$.getValue();return Boolean(a&&"esql"in a)}async execute({embeddable:e,data:t}){var r,s;"discover"===await(0,O.firstValueFrom)(null!==(r=this.startDependencies.coreStart.application.currentAppId$)&&void 0!==r?r:(0,O.of)(void 0))&&(s=L.lensAlertRule,((e=P,t)=>{e.forEach((e=>{if(e===t)return;const a=(e=>{switch(e){case L.lensEdit:return[()=>document.querySelector('[data-test-subj="lnsEditOnFlyFlyout"] [data-test-subj="lns-indexPattern-dimensionContainerBack"]'),()=>document.getElementById("lnsCancelEditOnFlyFlyout")];case L.docViewer:return[()=>document.querySelector('[data-test-subj="docViewerFlyout"] [data-test-subj="euiFlyoutCloseButton"]')];case L.esqlDocs:return[()=>document.querySelector('[data-test-subj="esqlInlineDocumentationFlyout"] [data-test-subj="euiFlyoutCloseButton"]')];case L.metricInsights:return[()=>document.querySelector('[data-test-subj="metricsExperienceFlyout"] [data-test-subj="euiFlyoutCloseButton"]')];case L.esqlControls:return[()=>document.querySelector('[data-test-subj="esqlControlsFlyout"] [data-test-subj="euiFlyoutCloseButton"]')];case L.lensAlertRule:return[()=>document.querySelector('[data-test-subj="lensAlertRule"] [data-test-subj="euiFlyoutCloseButton"]')];case L.inspectorPanel:return[()=>document.querySelector('[data-test-subj="inspectorPanel"] [data-test-subj="euiFlyoutCloseButton"]')]}})(e);a.forEach((e=>{const t=e();null==t||t.click()}))}))})(P,s)),(e=>{var t;const{core:a,parentApi:r,loadContent:s,flyoutProps:n}=e,{focusedPanelId:i,triggerId:l,...o}=null!=n?n:{},u=null!==(t=null==o?void 0:o["aria-labelledby"])&&void 0!==t?t:z(),c=(d=r,Boolean(d&&d.openOverlay&&d.clearOverlays)?r:void 0);var d;const p=()=>{null==c||c.clearOverlays(),null==g||g.close(),l&&B(document.getElementById(l))};a.application.currentAppId$.pipe((0,O.skip)(1),(0,O.take)(1)).subscribe((()=>{p()}));const g=a.overlays.openFlyout((0,U.toMountPoint)((0,m.jsx)(W,{closeFlyout:p,loadContent:s,core:a,ariaLabelledBy:u}),a),{size:500,type:"push",paddingSize:"m",maxWidth:800,ownFocus:!0,isResizable:!0,outsideClickCloses:!0,className:"kbnPresentationLazyFlyout","aria-labelledby":u,onClose:p,...o});null==c||c.openOverlay(g,{focusedPanelId:i})})({core:this.startDependencies.coreStart,parentApi:e.parentApi,flyoutProps:{size:620,css:q,"data-test-subj":"lensAlertRule","aria-labelledby":"flyoutTitle"},loadContent:async({closeFlyout:r})=>{const{loadAlertRuleFlyoutContent:s}=await a.e(67).then(a.bind(a,67));return await s({embeddable:e,data:t,closeFlyout:r,startDependencies:this.startDependencies,ruleTypeRegistry:this.ruleTypeRegistry,actionTypeRegistry:this.actionTypeRegistry})}})}}var G=a(8256),H=a(8901),$=a(2477);class Plugin{constructor(e){(0,r.default)(this,"actionTypeRegistry",void 0),(0,r.default)(this,"ruleTypeRegistry",void 0),(0,r.default)(this,"config",void 0),(0,r.default)(this,"connectorServices",void 0),(0,r.default)(this,"experimentalFeatures",void 0),(0,r.default)(this,"isServerless",void 0),this.actionTypeRegistry=new l.O,this.ruleTypeRegistry=new l.O,this.config=e.config.get(),this.experimentalFeatures=(0,T.xy)(this.config.enableExperimental||[]),this.isServerless="serverless"===e.env.packageInfo.buildFlavor}setup(e,t){const r=this.actionTypeRegistry,l=this.ruleTypeRegistry,o=this.isServerless;this.connectorServices={validateEmailAddresses:t.actions.validateEmailAddresses,enabledEmailServices:t.actions.enabledEmailServices,isWebhookSslWithPfxEnabled:t.actions.isWebhookSslWithPfxEnabled},A.Z.init({experimentalFeatures:this.experimentalFeatures});const u=s.i18n.translate("xpack.triggersActionsUI.managementSection.displayName",{defaultMessage:"Rules"}),c=s.i18n.translate("xpack.triggersActionsUI.managementSection.displayDescription",{defaultMessage:"Detect conditions using rules."}),d=s.i18n.translate("xpack.triggersActionsUI.managementSection.alerts.displayName",{defaultMessage:"Alerts"}),p=s.i18n.translate("xpack.triggersActionsUI.managementSection.alerts.displayDescription",{defaultMessage:"Monitor all of your alerts in one place"}),g=s.i18n.translate("xpack.triggersActionsUI.managementSection.connectors.displayName",{defaultMessage:"Connectors"}),h=s.i18n.translate("xpack.triggersActionsUI.managementSection.connectors.displayDescription",{defaultMessage:"Connect third-party software with your alerting data."});return t.home&&(t.home.featureCatalogue.register({id:E.PLUGIN_ID,title:u,description:c,icon:"watchesApp",path:i.O,showOnHomePage:!1,category:"admin"}),t.home.featureCatalogue.register({id:E.CONNECTORS_PLUGIN_ID,title:g,description:h,icon:"watchesApp",path:i.O,showOnHomePage:!1,category:"admin"})),this.config.rules.enabled&&t.management.sections.section.insightsAndAlerting.registerApp({id:E.PLUGIN_ID,title:u,order:1,async mount(s){var i;const[o,u]=await e.getStartServices(),{renderApp:c}=await a.e(1804).then(a.bind(a,1804));let d;try{d=await u.features.getFeatures()}catch(e){d=[]}return c({...o,actions:t.actions,cloud:t.cloud,data:u.data,dataViews:u.dataViews,dataViewEditor:u.dataViewEditor,charts:u.charts,alerting:u.alerting,spaces:u.spaces,unifiedSearch:u.unifiedSearch,isCloud:Boolean(null===(i=t.cloud)||void 0===i?void 0:i.isCloudEnabled),element:s.element,theme:s.theme,storage:new n.Storage(window.localStorage),setBreadcrumbs:s.setBreadcrumbs,history:s.history,actionTypeRegistry:r,ruleTypeRegistry:l,kibanaFeatures:d,licensing:u.licensing,expressions:u.expressions,isServerless:!!u.serverless,fieldFormats:u.fieldFormats,lens:u.lens,fieldsMetadata:u.fieldsMetadata,contentManagement:u.contentManagement,share:u.share})}}),t.management.sections.section.insightsAndAlerting.registerApp({id:E.CONNECTORS_PLUGIN_ID,title:g,order:2,async mount(s){var i;const[u,c]=await e.getStartServices(),{renderApp:d}=await a.e(6801).then(a.bind(a,6801));let p;try{p=await c.features.getFeatures()}catch(e){p=[]}return d({...u,actions:t.actions,data:c.data,dataViews:c.dataViews,dataViewEditor:c.dataViewEditor,charts:c.charts,alerting:c.alerting,spaces:c.spaces,unifiedSearch:c.unifiedSearch,isCloud:Boolean(null===(i=t.cloud)||void 0===i?void 0:i.isCloudEnabled),element:s.element,theme$:s.theme$,storage:new n.Storage(window.localStorage),setBreadcrumbs:s.setBreadcrumbs,history:s.history,actionTypeRegistry:r,ruleTypeRegistry:l,share:c.share,kibanaFeatures:p,isServerless:o})}}),this.experimentalFeatures.stackAlertsPage&&(t.management.sections.section.insightsAndAlerting.registerApp({id:E.ALERTS_PAGE_ID,title:d,capabilitiesId:E.PLUGIN_ID,order:0,async mount(s){var i;const{renderApp:u}=await a.e(6160).then(a.bind(a,6160)),[c,d]=await e.getStartServices();let p;try{p=await d.features.getFeatures()}catch(e){p=[]}return u({...c,actions:t.actions,data:d.data,dataViews:d.dataViews,dataViewEditor:d.dataViewEditor,charts:d.charts,alerting:d.alerting,spaces:d.spaces,unifiedSearch:d.unifiedSearch,isCloud:Boolean(null===(i=t.cloud)||void 0===i?void 0:i.isCloudEnabled),element:s.element,theme:s.theme,storage:new n.Storage(window.localStorage),setBreadcrumbs:s.setBreadcrumbs,history:s.history,actionTypeRegistry:r,ruleTypeRegistry:l,kibanaFeatures:p,licensing:d.licensing,expressions:d.expressions,isServerless:o,fieldFormats:d.fieldFormats,lens:d.lens,fieldsMetadata:d.fieldsMetadata})}}),t.home&&t.home.featureCatalogue.register({id:E.ALERTS_PAGE_ID,title:d,description:p,icon:"watchesApp",path:i.O,showOnHomePage:!1,category:"admin"})),{actionTypeRegistry:this.actionTypeRegistry,ruleTypeRegistry:this.ruleTypeRegistry}}start(e,t){const a=async()=>new AlertRuleFromVisAction(this.ruleTypeRegistry,this.actionTypeRegistry,{coreStart:e,...t});return t.uiActions.addTriggerActionAsync(o,o,a),t.uiActions.addTriggerActionAsync(u.CONTEXT_MENU_TRIGGER,o,a),{actionTypeRegistry:this.actionTypeRegistry,ruleTypeRegistry:this.ruleTypeRegistry,getActionForm:e=>{const{setActions:t,...a}=e;return(e=>(0,m.jsx)(g.v,{value:{services:e.connectorServices}},(0,m.jsx)(f.dI,e)))({...a,setActions:t,actionTypeRegistry:this.actionTypeRegistry,connectorServices:this.connectorServices})},getAddConnectorFlyout:e=>(e=>(0,m.jsx)(p.QueryClientProvider,{client:b},(0,m.jsx)(g.v,{value:{services:e.connectorServices,isServerless:!!e.isServerless}},(0,m.jsx)(h.t9,e))))({...e,actionTypeRegistry:this.actionTypeRegistry,connectorServices:this.connectorServices,isServerless:!!t.serverless}),getEditConnectorFlyout:e=>(e=>(0,m.jsx)(g.v,{value:{services:e.connectorServices,isServerless:!!e.isServerless}},(0,m.jsx)(p.QueryClientProvider,{client:y},(0,m.jsx)(h.VL,e))))({...e,actionTypeRegistry:this.actionTypeRegistry,connectorServices:this.connectorServices,isServerless:!!t.serverless}),getAlertsSearchBar:e=>(e=>(0,m.jsx)(c.Suspense,{fallback:(0,m.jsx)(I.EuiLoadingSpinner,null)},(0,m.jsx)(p.QueryClientProvider,{client:j},(0,m.jsx)(w,e))))(e),getRuleStatusDropdown:e=>(e=>(0,m.jsx)(f.MR,e))(e),getRuleTagFilter:e=>(e=>(0,m.jsx)(p.QueryClientProvider,{client:S},(0,m.jsx)(f.xl,e)))(e),getRuleStatusFilter:e=>(e=>(0,m.jsx)(f.Bp,e))(e),getRuleTagBadge:e=>(e=>(0,m.jsx)(f.Wc,e))(e),getRuleEventLogList:e=>(e=>(0,m.jsx)(p.QueryClientProvider,{client:v},(0,m.jsx)(f.Rq,e)))(e),getGlobalRuleEventLogList:e=>(e=>(0,m.jsx)(p.QueryClientProvider,{client:R},(0,m.jsx)(f.s0,e)))(e),getRulesListNotifyBadge:e=>(e=>(0,m.jsx)(f.KC,e))(e),getRulesList:e=>(e=>(0,m.jsx)(g.v,{value:{services:e.connectorServices}},(0,m.jsx)(p.QueryClientProvider,{client:x},(0,m.jsx)(_.PerformanceContextProvider,null,(0,m.jsx)(f.MJ,e.rulesListProps)))))({connectorServices:this.connectorServices,rulesListProps:e}),getRuleDefinition:e=>(e=>(0,m.jsx)(f.il,e))({...e,actionTypeRegistry:this.actionTypeRegistry,ruleTypeRegistry:this.ruleTypeRegistry}),getRuleStatusPanel:e=>(e=>(0,m.jsx)(f.rD,e))(e),getAlertSummaryWidget:a=>(e=>(0,m.jsx)(c.Suspense,{fallback:(0,m.jsx)(C.UP,{fullSize:e.fullSize,isLoadingWithoutChart:e.hideChart})},(0,m.jsx)(k,e)))({...a,dependencies:{charts:t.charts,uiSettings:e.uiSettings}}),getRuleSnoozeModal:e=>(e=>(0,m.jsx)(f.mN,e))(e),getUntrackModal:e=>(e=>(0,m.jsx)($.UntrackAlertsModal,e))(e),getRulesSettingsLink:e=>(({alertDeleteCategoryIds:e})=>(0,m.jsx)(p.QueryClientProvider,{client:F},(0,m.jsx)(c.Suspense,{fallback:(0,m.jsx)(I.EuiLoadingSpinner,null)},(0,m.jsx)(M,{alertDeleteCategoryIds:e}))))(e),getRuleHelpers:e=>({isRuleSnoozed:(0,G.DO)({isSnoozedUntil:e.isSnoozedUntil,muteAll:e.muteAll}),getNextRuleSnoozeSchedule:(0,H.X)({snoozeSchedule:e.snoozeSchedule})})}}stop(){}}var K=a(4039);const Y=()=>{const e=(0,c.useContext)(g.r);if(!e)throw new Error("useConnectorContext must be used within a ConnectorProvider and have a defined value.");return e};var Q=a(9132),Z=a(6252),J=a(1927),X=a(4513),ee=a.n(X),te=a(6406),ae=a(7176),re=function(e){return e[e.START=0]="START",e[e.STOP=1]="STOP",e[e.SUCCESS=2]="SUCCESS",e[e.ERROR=3]="ERROR",e}(re||{});const se=(e,t)=>{switch(t.type){case re.START:return{...e,isLoading:!0,error:null};case re.STOP:return{...e,isLoading:!1,error:null};case re.SUCCESS:return{...e,response:t.payload,isLoading:!1,error:null};case re.ERROR:return{...e,error:t.payload,isLoading:!1};default:return e}},ne=({connectorId:e,subAction:t,subActionParams:a,disabled:r=!1})=>{const{http:s}=(0,te.o1)().services,[{isLoading:n,response:i,error:l},o]=(0,c.useReducer)(se,{isLoading:!1,response:void 0,error:null}),u=(e=>{const t=(0,c.useRef)(e);return ee()(t.current,e)||(t.current=e),t.current})(a);return(0,c.useEffect)((()=>{if(r||!e||!t)return void o({type:re.STOP});const a=new AbortController;let n=!0;return(async()=>{try{o({type:re.START});const r=await(0,ae.yn)({id:e,params:{subAction:t,subActionParams:u},http:s,signal:a.signal});return n&&(r.status&&"ok"===r.status?o({type:re.SUCCESS,payload:r.data}):o({type:re.ERROR,payload:new Error(`${r.message}: ${r.serviceMessage}`)})),r.data}catch(e){n&&o({type:re.ERROR,payload:e})}})(),()=>{n=!1,a.abort()}}),[u,r,e,t,s]),{isLoading:n,response:i,error:l}};var ie=a(5586);const le=({typesFilter:e,actionTypesFilter:t,ruleExecutionStatusesFilter:a,ruleStatusesFilter:r,tagsFilter:s})=>{const n=[];if(e&&e.length&&n.push(`alert.attributes.alertTypeId:(${e.join(" or ")})`),t&&t.length&&n.push(["(",t.map((e=>`alert.attributes.actions:{ actionTypeId:${e} }`)).join(" OR "),")"].join("")),a&&a.length&&n.push(`alert.attributes.executionStatus.status:(${a.join(" or ")})`),r&&r.length){const e="(alert.attributes.muteAll:true OR alert.attributes.snoozeSchedule: { duration > 0 })",t="alert.attributes.enabled: true",a="alert.attributes.enabled: false",s=[];r.includes("enabled")&&s.push(t),r.includes("disabled")&&s.push(a),r.includes("snoozed")&&s.push(`${e}`),n.push(s.join(" and "))}return s&&s.length&&n.push(`alert.attributes.tags:(${s.join(" or ")})`),n};var oe=a(3920);async function ue({http:e,searchText:t,actionTypesFilter:a,ruleExecutionStatusesFilter:r,ruleStatusesFilter:s,tagsFilter:n,ruleTypeIds:i,consumers:l}){const o=le({actionTypesFilter:a,ruleExecutionStatusesFilter:r,ruleStatusesFilter:s,tagsFilter:n}),u=await e.post(`${ie.Ye}/rules/_aggregate`,{body:JSON.stringify({search_fields:t?JSON.stringify(["name","tags"]):void 0,search:t,filter:o.length?o.join(" and "):void 0,default_search_operator:"AND",rule_type_ids:i,consumers:l})});return(0,oe.Z)(u)}var ce=a(988),de=a(9293),pe=a(3770);function ge(e){return new Plugin(e)}},4039:(e,t,a)=>{"use strict";a.d(t,{D2:()=>l,FQ:()=>s.F,MF:()=>r.AlertHistoryDocumentTemplate,PK:()=>r.ALERT_HISTORY_PREFIX,VJ:()=>r.AlertHistoryDefaultIndexName,Vs:()=>r.AlertHistoryEsIndexConnectorId,ZJ:()=>i,a4:()=>n});var r=a(6728),s=a(8190);a(3268);let n=function(e){return e.Configuration="configuration",e.Test="test",e.Rules="rules",e}({}),i=function(e){return e.P50="P50",e.P95="P95",e.P99="P99",e}({}),l=function(e){return e[e.YEARLY=0]="YEARLY",e[e.MONTHLY=1]="MONTHLY",e[e.WEEKLY=2]="WEEKLY",e[e.DAILY=3]="DAILY",e[e.HOURLY=4]="HOURLY",e}({})},4513:e=>{"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var r,s,n;if(Array.isArray(t)){if((r=t.length)!=a.length)return!1;for(s=r;0!==s--;)if(!e(t[s],a[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((r=(n=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(s=r;0!==s--;)if(!Object.prototype.hasOwnProperty.call(a,n[s]))return!1;for(s=r;0!==s--;){var i=n[s];if(!e(t[i],a[i]))return!1}return!0}return t!=t&&a!=a}},5277:e=>{!function(){var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],a="undefined"!=typeof window,r=a&&null!=window.mozInnerScreenX;function s(e,s,n){if(!a)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var i=n&&n.debug||!1;if(i){var l=document.querySelector("#input-textarea-caret-position-mirror-div");l&&l.parentNode.removeChild(l)}var o=document.createElement("div");o.id="input-textarea-caret-position-mirror-div",document.body.appendChild(o);var u=o.style,c=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,d="INPUT"===e.nodeName;u.whiteSpace="pre-wrap",d||(u.wordWrap="break-word"),u.position="absolute",i||(u.visibility="hidden"),t.forEach((function(e){d&&"lineHeight"===e?u.lineHeight=c.height:u[e]=c[e]})),r?e.scrollHeight>parseInt(c.height)&&(u.overflowY="scroll"):u.overflow="hidden",o.textContent=e.value.substring(0,s),d&&(o.textContent=o.textContent.replace(/\s/g,""));var p=document.createElement("span");p.textContent=e.value.substring(s)||".",o.appendChild(p);var g={top:p.offsetTop+parseInt(c.borderTopWidth),left:p.offsetLeft+parseInt(c.borderLeftWidth),height:parseInt(c.lineHeight)};return i?p.style.backgroundColor="#aaa":document.body.removeChild(o),g}void 0!==e.exports?e.exports=s:a&&(window.getCaretCoordinates=s)}()},1841:(e,t,a)=>{a.p=window.__kbnPublicPath__.triggersActionsUi},6728:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/actions/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},2109:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/alerting/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},8496:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/alerting/common/parse_duration");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},2677:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/controls/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},7195:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},7546:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},8744:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},5296:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},791:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},2602:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},7876:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/expressions/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},2137:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},409:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},1215:(e,t,a)=>{a.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},3185:(e,t,a)=>{e.exports=a(2497)(51858)},8915:(e,t,a)=>{e.exports=a(2497)(67493)},3059:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticCharts},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6752:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticNumeral},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},1639:e=>{"use strict";e.exports=__kbnSharedDeps__.FpTs.either},1455:e=>{"use strict";e.exports=__kbnSharedDeps__.FpTs.option},6730:e=>{"use strict";e.exports=__kbnSharedDeps__.FpTs.pipeable},3782:e=>{"use strict";e.exports=__kbnSharedDeps__.IoTs},6494:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnDatemath},1192:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEbtTools},5964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},1991:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsqlAst},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},5804:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaMount},193:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxRouter},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},1060:e=>{"use strict";e.exports=__kbnSharedDeps__.LodashFp},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},2488:e=>{"use strict";e.exports=__kbnSharedDeps__.MomentTimezone},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},2874:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDom},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},1493:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactRouterDom},6524:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useAsync},7583:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useDebounce},8672:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useEffectOnce},7064:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useLocalStorage},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},5079:e=>{"use strict";e.exports=__kbnSharedDeps__.SaferLodashSet},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},s={};function n(e){var t=s[e];if(void 0!==t)return t.exports;var a=s[e]={exports:{}};return r[e](a,a.exports,n),a.exports}n.m=r,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(a,r){if(1&r&&(a=this(a)),8&r)return a;if("object"==typeof a&&a){if(4&r&&a.__esModule)return a;if(16&r&&"function"==typeof a.then)return a}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&r&&a;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>i[e]=()=>a[e]));return i.default=()=>a,n.d(s,i),s},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,a)=>(n.f[a](e,t),t)),[])),n.u=e=>"triggersActionsUi.chunk."+e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},n.l=(e,t,r,s)=>{if(a[e])a[e].push(t);else{var i,l;if(void 0!==r)for(var o=document.getElementsByTagName("script"),u=0;u<o.length;u++){var c=o[u];if(c.getAttribute("src")==e){i=c;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.src=e),a[e]=[t];var d=(t,r)=>{i.onerror=i.onload=null,clearTimeout(p);var s=a[e];if(delete a[e],i.parentNode&&i.parentNode.removeChild(i),s&&s.forEach((e=>e(r))),t)return t(r)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),l&&document.head.appendChild(i)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=a[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={3179:0};n.f.j=(t,a)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var s=new Promise(((a,s)=>r=e[t]=[a,s]));a.push(r[2]=s);var i=n.p+n.u(t),l=new Error;n.l(i,(a=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",l.name="ChunkLoadError",l.type=s,l.request=i,r[1](l)}}),"chunk-"+t,t)}};var t=(t,a)=>{var r,s,[i,l,o]=a,u=0;if(i.some((t=>0!==e[t]))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);o&&o(n)}for(t&&t(a);u<i.length;u++)s=i[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},a=self.triggersActionsUi_bundle_jsonpfunction=self.triggersActionsUi_bundle_jsonpfunction||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),n(1841),__kbnBundles__.define("plugin/triggersActionsUi/public",n,9419),__kbnBundles__.define("plugin/triggersActionsUi/public/common",n,1927),__kbnBundles__.define("plugin/triggersActionsUi/public/common/constants",n,7793)})();