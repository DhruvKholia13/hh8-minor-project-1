/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var t={117:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ACTIONS_FEATURE_ID:()=>tt,ALERT_HISTORY_PREFIX:()=>u,AlertHistoryDefaultIndexName:()=>l,AlertHistoryDocumentTemplate:()=>d,AlertHistoryEsIndexConnectorId:()=>s,AlertingConnectorFeature:()=>D,AlertingConnectorFeatureId:()=>_,BASE_ACTION_API_PATH:()=>J,CasesConnectorFeature:()=>G,CasesConnectorFeatureId:()=>x,DEFAULT_EMAIL_BODY_LENGTH:()=>at,DEFAULT_MICROSOFT_EXCHANGE_URL:()=>et,DEFAULT_MICROSOFT_GRAPH_API_SCOPE:()=>rt,DEFAULT_MICROSOFT_GRAPH_API_URL:()=>nt,EMPTY_EXECUTION_KPI_RESULT:()=>z,EndpointSecurityConnectorFeature:()=>q,EndpointSecurityConnectorFeatureId:()=>T,GenerativeAIForObservabilityConnectorFeatureId:()=>C,GenerativeAIForObservabilityFeature:()=>W,GenerativeAIForSearchPlaygroundConnectorFeatureId:()=>w,GenerativeAIForSearchPlaygroundFeature:()=>$,GenerativeAIForSecurityConnectorFeatureId:()=>F,GenerativeAIForSecurityFeature:()=>H,INTERNAL_BASE_ACTION_API_PATH:()=>Q,InvalidEmailReason:()=>r,MAX_EMAIL_BODY_LENGTH:()=>it,MustacheInEmailRegExp:()=>f,SecurityConnectorFeatureId:()=>I,SecuritySolutionFeature:()=>U,UptimeConnectorFeature:()=>j,UptimeConnectorFeatureId:()=>E,areValidFeatures:()=>X,buildAlertHistoryDocument:()=>c,executionLogSortableColumns:()=>K,getConnectorCompatibility:()=>V,getConnectorFeatureName:()=>Y,hasMustacheTemplate:()=>p,invalidEmailsAsMessage:()=>y,isActionTypeExecutorResult:()=>a,validateEmailAddresses:()=>b,validateEmailAddressesAsAlwaysValid:()=>h,validateEmptyStrings:()=>Z,withoutMustacheTemplate:()=>m});let r=function(t){return t.invalid="invalid",t.notAllowed="notAllowed",t}({});const i=["ok","error"];function a(t){const e=t;return e&&"string"==typeof(null==e?void 0:e.actionId)&&i.includes(null==e?void 0:e.status)}const o=__kbnSharedDeps__.Lodash,u="kibana-alert-history-",l=`${u}default`,s="preconfigured-alert-history-es-index",c=t=>{const{date:e,alert:n,context:r,params:i,tags:a,rule:u}=t;if(!n||!u)return null;const{actionGroup:l,actionGroupName:s,id:c}=n,{id:d,name:f,spaceId:p,type:m}=u;if(!m)return null;const v=m.replace(/\./g,"__"),g={...d?{id:d}:{},...f?{name:f}:{},...(0,o.isEmpty)(i)?{}:{params:{[v]:i}},...p?{space:p}:{},...m?{type:m}:{}},h={...c?{id:c}:{},...(0,o.isEmpty)(r)?{}:{context:{[v]:r}},...l?{actionGroup:l}:{},...s?{actionGroupName:s}:{}},b={"@timestamp":e||(new Date).toISOString(),...a&&a.length>0?{tags:a}:{},...null!=r&&r.message?{message:r.message}:{},...(0,o.isEmpty)(g)?{}:{rule:g},...(0,o.isEmpty)(h)?{}:{kibana:{alert:h}}};return(0,o.isEmpty)(b)?null:{...b,event:{kind:"alert"}}},d=Object.freeze(c({rule:{id:"{{rule.id}}",name:"{{rule.name}}",type:"{{rule.type}}",spaceId:"{{rule.spaceId}}"},context:"{{context}}",params:"{{rule.params}}",tags:"{{rule.tags}}",alert:{id:"{{alert.id}}",actionGroup:"{{alert.actionGroup}}",actionGroupName:"{{alert.actionGroupName}}"}})),f=/\{\{((.|\n)*)\}\}/;function p(t){return!!t.match(f)}function m(t){return t.filter((t=>!p(t)))}var v=n(443);const g=(t,e)=>e.some((e=>(({pattern:t,str:e})=>{const n=e.toLowerCase(),r=t.toLowerCase().split("*");if(1===r.length)return n===r[0];let i=0;if(!n.startsWith(r[0]))return!1;i=r[0].length;for(let t=1;t<r.length-1;t++){const e=n.indexOf(r[t],i);if(-1===e)return!1;i=e+r[t].length}const a=r[r.length-1];return n.endsWith(a)&&i<=n.length-a.length})({pattern:e,str:t})));function h(t){return t.map((t=>({address:t,valid:!0})))}function b(t=null,e,n={},i=null){return e.map((e=>function(t,e,n,i){if(n.treatMustacheTemplatesAsValid&&p(e))return{address:e,valid:!0};try{return function(t,e,n,{isSender:i=!1}){const a=(0,v.parseAddressList)(e);if(null==a)return{address:e,valid:!1,reason:r.invalid};if(null!==t){const n=new Set(t);for(const t of a){let i=[];if("group"===t.type)i=t.addresses.map((t=>t.domain));else{if("mailbox"!==t.type)return{address:e,valid:!1,reason:r.invalid};i=[t.domain]}for(const t of i)if(!n.has(t))return{address:e,valid:!1,reason:r.notAllowed}}}if(!i&&null!=n)for(const t of a){let i=[];if("group"===t.type)i=t.addresses.map((t=>t.address));else{if("mailbox"!==t.type)return{address:e,valid:!1,reason:r.invalid};i=[t.address]}for(const t of i)if(!g(t,n))return{address:e,valid:!1,reason:r.notAllowed}}return{address:e,valid:!0}}(t,e,i,n)}catch(t){return{address:e,valid:!1,reason:r.invalid}}}(t,e,n,i)))}function y(t){const e=t.filter((t=>!t.valid&&t.reason===r.invalid)),n=t.filter((t=>!t.valid&&t.reason===r.notAllowed)),i=[];if(0!==e.length&&i.push(`not valid emails: ${A(e).join(", ")}`),0!==n.length&&i.push(`not allowed emails: ${A(n).join(", ")}`),0!==i.length)return i.join("; ")}function A(t){return t.map((t=>t.address))}const S=__kbnSharedDeps__.KbnI18n,_="alerting",x="cases",E="uptime",I="siem",F="generativeAIForSecurity",C="generativeAIForObservability",w="generativeAIForSearchPlayground",T="endpointSecurity",k=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.endpointSecurity",{defaultMessage:"Endpoint Security"}),O=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForSecurity",{defaultMessage:"Generative AI for Security"}),P=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForObservability",{defaultMessage:"Generative AI for Observability"}),M=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForSearchPlayground",{defaultMessage:"Generative AI for Search"}),L=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.alertingRules",{defaultMessage:"Alerting Rules"}),N=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.securitySolution",{defaultMessage:"Security Solution"}),R=S.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.cases",{defaultMessage:"Cases"}),D={id:_,name:S.i18n.translate("xpack.actions.availableConnectorFeatures.alerting",{defaultMessage:"Alerting"}),compatibility:L},G={id:x,name:S.i18n.translate("xpack.actions.availableConnectorFeatures.cases",{defaultMessage:"Cases"}),compatibility:R},j={id:E,name:S.i18n.translate("xpack.actions.availableConnectorFeatures.uptime",{defaultMessage:"Uptime"}),compatibility:L},U={id:I,name:S.i18n.translate("xpack.actions.availableConnectorFeatures.securitySolution",{defaultMessage:"Security Solution"}),compatibility:N},H={id:F,name:O,compatibility:O},W={id:C,name:P,compatibility:P},$={id:w,name:M,compatibility:M},q={id:T,name:k,compatibility:k},B={[D.id]:D,[G.id]:G,[j.id]:j,[U.id]:U,[H.id]:H,[W.id]:W,[$.id]:$,[q.id]:q};function X(t){return t.every((t=>!!B[t]))}function Y(t){const e=B[t];return e?e.name:t}function V(t){const e=new Set;if(t&&t.length>0)for(const n of t)B[n]&&e.add(B[n].compatibility);return Array.from(e)}const z={success:0,unknown:0,failure:0,warning:0},K=["timestamp","execution_duration","schedule_delay"];function Z(t){if((0,o.isString)(t)){if(""===t.trim())throw new Error("value '' is not valid")}else Array.isArray(t)?t.forEach((t=>{Z(t)})):(0,o.isObject)(t)&&(0,o.keys)(t).forEach((e=>{Z((0,o.get)(t,e))}))}const J="/api/actions",Q="/internal/actions",tt="actions",et="https://login.microsoftonline.com",nt="https://graph.microsoft.com/v1.0",rt="https://graph.microsoft.com/.default",it=25e6,at=it},11:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Plugin:()=>Plugin,plugin:()=>a});var r=n(915),i=n(117);class Plugin{constructor(t){var e,n,i,a,o;(0,r.default)(this,"allowedEmailDomains",null),(0,r.default)(this,"enabledEmailServices",void 0),(0,r.default)(this,"webhookSslWithPfxEnabled",void 0);const u=t.config.get();this.allowedEmailDomains=(null===(e=u.email)||void 0===e?void 0:e.domain_allowlist)||null,this.enabledEmailServices=Array.from(new Set((null===(n=u.email)||void 0===n||null===(i=n.services)||void 0===i?void 0:i.enabled)||["*"])),this.webhookSslWithPfxEnabled=null===(a=null===(o=u.webhook)||void 0===o?void 0:o.ssl.pfx.enabled)||void 0===a||a}setup(){return{validateEmailAddresses:(t,e)=>(0,i.validateEmailAddresses)(this.allowedEmailDomains,t,e),enabledEmailServices:this.enabledEmailServices,isWebhookSslWithPfxEnabled:this.webhookSslWithPfxEnabled}}start(){}}function a(t){return new Plugin(t)}},443:function(t){!function(e){"use strict";function n(t){function e(){return Et<It}function n(){return Et}function i(t){Et=t}function a(){Et=0,It=xt.length}function o(t,e){return{name:t,tokens:e||"",semantic:e||"",children:[]}}function u(t,e){var n;return null===e?null:((n=o(t)).tokens=e.tokens,n.semantic=e.semantic,n.children.push(e),n)}function l(t,e){return null!==e&&(t.tokens+=e.tokens,t.semantic+=e.semantic),t.children.push(e),t}function s(t){var n;return e()&&t(n=xt[Et])?(Et+=1,o("token",n)):null}function c(){return null}function d(t){return function(){return u("literal",s((function(e){return e===t})))}}function f(){var t=arguments;return function(){var e,r,a,u;for(u=n(),r=o("and"),e=0;e<t.length;e+=1){if(null===(a=t[e]()))return i(u),null;l(r,a)}return r}}function p(){var t=arguments;return function(){var e,r,a;for(a=n(),e=0;e<t.length;e+=1){if(null!==(r=t[e]()))return r;i(a)}return null}}function m(t){return function(){var e,r;return r=n(),null!==(e=t())?e:(i(r),o("opt"))}}function v(t){return function(){var e=t();return null!==e&&(e.semantic=""),e}}function g(t){return function(){var e=t();return null!==e&&e.semantic.length>0&&(e.semantic=" "),e}}function h(t,e){return function(){var r,a,u,s,c;for(s=n(),r=o("star"),u=0,c=void 0===e?0:e;null!==(a=t());)u+=1,l(r,a);return u>=c?r:(i(s),null)}}function b(t){return t.charCodeAt(0)>=128}function y(){return u("cr",d("\r")())}function A(){return u("crlf",f(y,x)())}function S(){return u("dquote",d('"')())}function _(){return u("htab",d("\t")())}function x(){return u("lf",d("\n")())}function E(){return u("sp",d(" ")())}function I(){return u("vchar",s((function(e){var n=e.charCodeAt(0),r=33<=n&&n<=126;return t.rfc6532&&(r=r||b(e)),r})))}function F(){return u("wsp",p(E,_)())}function C(){var t=u("quoted-pair",p(f(d("\\"),p(I,F)),it)());return null===t?null:(t.semantic=t.semantic[1],t)}function w(){return u("fws",p(ot,f(m(f(h(F),v(A))),h(F,1)))())}function T(){return u("ctext",p((function(){return s((function(e){var n=e.charCodeAt(0),r=33<=n&&n<=39||42<=n&&n<=91||93<=n&&n<=126;return t.rfc6532&&(r=r||b(e)),r}))}),nt)())}function k(){return u("ccontent",p(T,C,O)())}function O(){return u("comment",f(d("("),h(f(m(w),k)),m(w),d(")"))())}function P(){return u("cfws",p(f(h(f(m(w),O),1),m(w)),w)())}function M(){return u("atext",s((function(e){var n="a"<=e&&e<="z"||"A"<=e&&e<="Z"||"0"<=e&&e<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(e)>=0;return t.rfc6532&&(n=n||b(e)),n})))}function L(){return u("atom",f(g(m(P)),h(M,1),g(m(P)))())}function N(){var t,e;return null===(t=u("dot-atom-text",h(M,1)()))||null!==(e=h(f(d("."),h(M,1)))())&&l(t,e),t}function R(){return u("dot-atom",f(v(m(P)),N,v(m(P)))())}function D(){return u("qtext",p((function(){return s((function(e){var n=e.charCodeAt(0),r=33===n||35<=n&&n<=91||93<=n&&n<=126;return t.rfc6532&&(r=r||b(e)),r}))}),rt)())}function G(){return u("qcontent",p(D,C)())}function j(){return u("quoted-string",f(v(m(P)),v(S),h(f(m(g(w)),G)),m(v(w)),v(S),v(m(P)))())}function U(){return u("word",p(L,j)())}function H(){return u("address",p(W,B)())}function W(){return u("mailbox",p($,tt)())}function $(){return u("name-addr",f(m(X),q)())}function q(){return u("angle-addr",p(f(v(m(P)),d("<"),tt,d(">"),v(m(P))),ut)())}function B(){return u("group",f(X,d(":"),m(z),d(";"),v(m(P)))())}function X(){return u("display-name",(null!==(t=u("phrase",p(at,h(U,1))()))&&(t.semantic=t.semantic.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")),t));var t}function Y(){return u("mailbox-list",p(f(W,h(f(d(","),W))),ct)())}function V(){return u("address-list",p(f(H,h(f(d(t.addressListSeparator),H))),dt)())}function z(){return u("group-list",p(Y,v(P),ft)())}function K(){return u("local-part",p(pt,R,j)())}function Z(){return u("dtext",p((function(){return s((function(e){var n=e.charCodeAt(0),r=33<=n&&n<=90||94<=n&&n<=126;return t.rfc6532&&(r=r||b(e)),r}))}),vt)())}function J(){return u("domain-literal",f(v(m(P)),d("["),h(f(m(w),Z)),m(w),d("]"),v(m(P)))())}function Q(){return u("domain",(e=p(mt,R,J)(),t.rejectTLD&&e&&e.semantic&&e.semantic.indexOf(".")<0?null:(e&&(e.semantic=e.semantic.replace(/\s+/g,"")),e)));var e}function tt(){return u("addr-spec",f(K,d("@"),Q)())}function et(){return t.strict?null:u("obs-NO-WS-CTL",s((function(t){var e=t.charCodeAt(0);return 1<=e&&e<=8||11===e||12===e||14<=e&&e<=31||127===e})))}function nt(){return t.strict?null:u("obs-ctext",et())}function rt(){return t.strict?null:u("obs-qtext",et())}function it(){return t.strict?null:u("obs-qp",f(d("\\"),p(d("\0"),et,x,y))())}function at(){return t.strict?null:u("obs-phrase",f(U,h(p(U,d("."),t.atInDisplayName?d("@"):c,t.commaInDisplayName?d(","):c,g(P))))())}function ot(){return t.strict?null:u("obs-FWS",h(f(v(m(A)),F),1)())}function ut(){return t.strict?null:u("obs-angle-addr",f(v(m(P)),d("<"),lt,tt,d(">"),v(m(P)))())}function lt(){return t.strict?null:u("obs-route",f(st,d(":"))())}function st(){return t.strict?null:u("obs-domain-list",f(h(p(v(P),d(","))),d("@"),Q,h(f(d(","),v(m(P)),m(f(d("@"),Q)))))())}function ct(){return t.strict?null:u("obs-mbox-list",f(h(f(v(m(P)),d(","))),W,h(f(d(","),m(f(W,v(P))))))())}function dt(){return t.strict?null:u("obs-addr-list",f(h(f(v(m(P)),d(","))),H,h(f(d(","),m(f(H,v(P))))))())}function ft(){return t.strict?null:u("obs-group-list",f(h(f(v(m(P)),d(",")),1),v(m(P)))())}function pt(){return t.strict?null:u("obs-local-part",f(U,h(f(d("."),U)))())}function mt(){return t.strict?null:u("obs-domain",f(L,h(f(d("."),L)))())}function vt(){return t.strict?null:u("obs-dtext",p(et,C)())}function gt(t,e){var n,r,i;if(null==e)return null;for(r=[e];r.length>0;){if((i=r.pop()).name===t)return i;for(n=i.children.length-1;n>=0;n-=1)r.push(i.children[n])}return null}function ht(t,e){var n,r,i,a,o;if(null==e)return null;for(r=[e],a=[],o={},n=0;n<t.length;n+=1)o[t[n]]=!0;for(;r.length>0;)if((i=r.pop()).name in o)a.push(i);else for(n=i.children.length-1;n>=0;n-=1)r.push(i.children[n]);return a}function bt(e){var n,r,i,a,o;if(null===e)return null;for(n=[],r=ht(["group","mailbox"],e),i=0;i<r.length;i+=1)"group"===(a=r[i]).name?n.push(yt(a)):"mailbox"===a.name&&n.push(At(a));return o={ast:e,addresses:n},t.simple&&(o=function(t){var e;if(t&&t.addresses)for(e=0;e<t.addresses.length;e+=1)delete t.addresses[e].node;return t}(o)),t.oneResult?function(e){return e?!t.partial&&e.addresses.length>1?null:e.addresses&&e.addresses[0]:null}(o):t.simple?o&&o.addresses:o}function yt(t){var e,n=gt("display-name",t),r=[],i=ht(["mailbox"],t);for(e=0;e<i.length;e+=1)r.push(At(i[e]));return{node:t,parts:{name:n},type:t.name,name:St(n),addresses:r}}function At(t){var e=gt("display-name",t),n=gt("addr-spec",t),r=function(t,e){var n,r,i,a;if(null==e)return null;for(r=[e],a=[];r.length>0;)for("cfws"===(i=r.pop()).name&&a.push(i),n=i.children.length-1;n>=0;n-=1)r.push(i.children[n]);return a}(0,t),i=ht(["comment"],t),a=gt("local-part",n),o=gt("domain",n);return{node:t,parts:{name:e,address:n,local:a,domain:o,comments:r},type:t.name,name:St(e),address:St(n),local:St(a),domain:St(o),comments:_t(i),groupName:St(t.groupName)}}function St(t){return null!=t?t.semantic:null}function _t(t){var e="";if(t)for(var n=0;n<t.length;n+=1)e+=St(t[n]);return e}var xt,Et,It,Ft,Ct;if(null===(t=r(t,{})))return null;if(xt=t.input,Ct={address:H,"address-list":V,"angle-addr":q,from:function(){return u("from",p(Y,V)())},group:B,mailbox:W,"mailbox-list":Y,"reply-to":function(){return u("reply-to",V())},sender:function(){return u("sender",p(W,H)())}}[t.startAt]||V,!t.strict){if(a(),t.strict=!0,Ft=Ct(xt),t.partial||!e())return bt(Ft);t.strict=!1}return a(),Ft=Ct(xt),!t.partial&&e()?null:bt(Ft)}function r(t,e){function n(t){return"[object String]"===Object.prototype.toString.call(t)}function r(t){return null==t}var i,a;if(n(t))t={input:t};else if(!function(t){return t===Object(t)}(t))return null;if(!n(t.input))return null;if(!e)return null;for(a in i={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","})r(t[a])&&(t[a]=r(e[a])?i[a]:e[a]);return t}n.parseOneAddress=function(t){return n(r(t,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},n.parseAddressList=function(t){return n(r(t,{rfc6532:!0,simple:!0,startAt:"address-list"}))},n.parseFrom=function(t){return n(r(t,{rfc6532:!0,simple:!0,startAt:"from"}))},n.parseSender=function(t){return n(r(t,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},n.parseReplyTo=function(t){return n(r(t,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},void 0!==t.exports?t.exports=n:e.emailAddresses=n}(this)},244:(t,e,n)=>{n.p=window.__kbnPublicPath__.actions},915:(t,e,n)=>{t.exports=n(497)(67493)},497:t=>{"use strict";t.exports=__kbnSharedDeps_npm__}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,n),a.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n(244),__kbnBundles__.define("plugin/actions/public",n,11),__kbnBundles__.define("plugin/actions/common",n,117)})();