/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t={8597:(e,t,n)=>{"use strict";n.d(t,{b6:()=>r,rn:()=>i,uq:()=>s});const s="observability:logSources",i="genAiSettings:defaultAIConnector",r="genAiSettings:defaultAIConnectorOnly"},6925:(e,t,n)=>{"use strict";n.d(t,{Sn:()=>ServerSentEventError,F5:()=>o});var s=n(5008);let i=function(e){return e.error="error",e.data="data",e}({}),r=function(e){return e.internalError="internalError",e.requestError="requestError",e}({});class ServerSentEventError extends Error{constructor(e,t,n){super(t),this.code=e,this.meta=n}get status(){if("object"==typeof this.meta&&this.meta.status)return this.meta.status}toJSON(){return{type:i.error,error:{code:this.code,message:this.message,meta:this.meta}}}}function o(e=s.i18n.translate("sse.internalError",{defaultMessage:"An internal error occurred"})){return new ServerSentEventError(r.internalError,e,{})}},7121:(e,t,n)=>{"use strict";n.d(t,{OG:()=>i,Re:()=>ChatCompletionError,Vg:()=>r,W9:()=>s}),n(5008);let s=function(e){return e.ChatCompletionChunk="chatCompletionChunk",e.ChatCompletionMessage="chatCompletionMessage",e.ConversationCreate="conversationCreate",e.ConversationUpdate="conversationUpdate",e.MessageAdd="messageAdd",e.ChatCompletionError="chatCompletionError",e.BufferFlush="bufferFlush",e}({}),i=function(e){return e.InternalError="internalError",e.NotFoundError="notFoundError",e.TokenLimitReachedError="tokenLimitReachedError",e.FunctionNotFoundError="functionNotFoundError",e.FunctionLimitExceededError="functionLimitExceededError",e}({});class ChatCompletionError extends Error{constructor(e,t,n={}){super(t),this.code=e,this.meta=n}}function r(e){return e instanceof ChatCompletionError&&e.code===i.TokenLimitReachedError}},2944:(e,t,n)=>{"use strict";n.d(t,{j:()=>s,v:()=>i});let s=function(e){return e.generateQueryOnly="generateQueryOnly",e.executeAndReturnResults="executeAndReturnResults",e.visualizeAuto="visualizeAuto",e.visualizeXy="visualizeXy",e.visualizeBar="visualizeBar",e.visualizeLine="visualizeLine",e.visualizeArea="visualizeArea",e.visualizeTable="visualizeTable",e.visualizeDonut="visualizeDonut",e.visualizeTreemap="visualizeTreemap",e.visualizeHeatmap="visualizeHeatmap",e.visualizeTagcloud="visualizeTagcloud",e.visualizeWaffle="visualizeWaffle",e}({});const i=Object.values(s)},6230:(e,t,n)=>{"use strict";n.d(t,{QP:()=>s.QP,B4:()=>p,pe:()=>d,Lc:()=>m,c3:()=>u,LN:()=>c,QA:()=>s.QA,yh:()=>s.yh,g6:()=>s.g6,sl:()=>l,e4:()=>s.e4,W9:()=>i.W9,wx:()=>a,Vg:()=>i.Vg});var s=n(7371),i=(n(2944),n(7121)),r=n(770),o=n(190);const a=()=>e=>e.pipe((0,o.filter)((e=>e.type===i.W9.ChatCompletionChunk)),(0,o.scan)(((e,{message:t})=>{var n,s,i,o,a;return e.message.content+=null!==(n=t.content)&&void 0!==n?n:"",e.message.function_call.name+=null!==(s=null===(i=t.function_call)||void 0===i?void 0:i.name)&&void 0!==s?s:"",e.message.function_call.arguments+=null!==(o=null===(a=t.function_call)||void 0===a?void 0:a.arguments)&&void 0!==o?o:"",(0,r.cloneDeep)(e)}),{message:{content:"",function_call:{name:"",arguments:"",trigger:s.e4.Assistant},role:s.e4.Assistant}}),(0,o.defaultIfEmpty)({message:{content:"",function_call:{name:"",arguments:"",trigger:s.e4.Assistant},role:s.e4.Assistant}}));n(8915);const l="obs_ai_assistant_kb_inference",c=".elser-2-elasticsearch",u=".elser-2-elastic",d=".multilingual-e5-small-elasticsearch",p=".multilingual-e5-large-elastic",m=[u,p]},7371:(e,t,n)=>{"use strict";n.d(t,{QA:()=>o,QP:()=>a,e4:()=>s,g6:()=>r,yh:()=>i});let s=function(e){return e.System="system",e.Assistant="assistant",e.User="user",e.Function="function",e.Elastic="elastic",e}({}),i=function(e){return e.AssistantSummarization="assistant_summarization",e.UserEntry="user_entry",e.Elastic="elastic",e}({}),r=function(e){return e.UserInstruction="user_instruction",e.Contextual="contextual",e}({}),o=function(e){return e.NOT_INSTALLED="NOT_INSTALLED",e.MODEL_PENDING_DEPLOYMENT="MODEL_PENDING_DEPLOYMENT",e.DEPLOYING_MODEL="DEPLOYING_MODEL",e.MODEL_PENDING_ALLOCATION="MODEL_PENDING_ALLOCATION",e.READY="READY",e.ERROR="ERROR",e}({}),a=function(e){return e.SHARED="shared",e.PRIVATE="private",e}({})},519:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var s=n(9472),i=n(6230),r=n(7121);function o({name:e,content:t,data:n}){return{id:(0,s.v4)(),type:r.W9.MessageAdd,message:{"@timestamp":(new Date).toISOString(),message:{content:JSON.stringify(t),...n?{data:JSON.stringify(n)}:{},name:e,role:i.e4.User}}}}},6136:(e,t,n)=>{"use strict";n.d(t,{S:()=>u,B:()=>d});var s=n(4540);const i={connectorId:{type:"text",_meta:{description:"The id of the connector."}},name:{type:"text",_meta:{description:"The name of the connector."}},type:{type:"text",_meta:{description:"The action type id of the connector."}},modelFamily:{type:"text",_meta:{description:"The model family of the connector."}},modelProvider:{type:"text",_meta:{description:"The model provider of the connector."}},modelId:{type:"text",_meta:{description:"The model id of the connector, if applicable.",optional:!0}}},r={type:"array",items:{type:"text",_meta:{description:"Scope of the AI Assistant"}}},o={eventType:s.L.ChatFeedback,schema:{feedback:{type:"text",_meta:{description:"Whether the user has deemed this response useful or not"}},conversation:{properties:{"@timestamp":{type:"text",_meta:{description:"The timestamp of the conversation."}},user:{properties:{id:{type:"text",_meta:{description:"The id of the user.",optional:!0}},name:{type:"text",_meta:{description:"The name of the user."}}}},conversation:{properties:{id:{type:"text",_meta:{description:"The id of the conversation."}},last_updated:{type:"text",_meta:{description:"The timestamp of the last message in the conversation."}}}},labels:{type:"pass_through",_meta:{description:"The labels of the conversation."}},numeric_labels:{type:"pass_through",_meta:{description:"The numeric labels of the conversation."}},namespace:{type:"text",_meta:{description:"The namespace of the conversation."}},public:{type:"boolean",_meta:{description:"Whether the conversation is public or not."}},archived:{type:"boolean",_meta:{description:"Whether the conversation is archived or not.",optional:!0}}}},connector:{properties:i},scopes:r}},a={eventType:s.L.InsightFeedback,schema:{feedback:{type:"text",_meta:{description:"Whether the user has deemed this response useful or not"}},connector:{properties:i},scopes:r}},l={eventType:s.L.InsightResponse,schema:{"@timestamp":{type:"text",_meta:{description:"The timestamp of the last response from the LLM."}},connector:{properties:i},scopes:r}},c=[o,a,{eventType:s.L.UserSentPromptInChat,schema:{scopes:r,connector:{properties:i}}},l],u=e=>{c.forEach((t=>{e.registerEventType(t)}))};function d(e,t){e.reportEvent(t.type,t.payload)}},4540:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});let s=function(e){return e.ChatFeedback="observability_ai_assistant_chat_feedback",e.InsightFeedback="observability_ai_assistant_insight_feedback",e.UserSentPromptInChat="observability_ai_assistant_user_sent_prompt_in_chat",e.InsightResponse="observability_ai_assistant_insight_response",e}({})},7636:(e,t,n)=>{"use strict";n.d(t,{z:()=>c});var s=n(4286),i=n(5008),r=n(1319),o=n(7541),a=n(6791);const l=i.i18n.translate("xpack.observabilityAiAssistant.feedbackButtons.em.thanksForYourFeedbackLabel",{defaultMessage:"Thanks for your feedback"});function c({onClickFeedback:e}){const{notifications:t}=(0,o.o)().services,[n,c]=(0,s.useState)(!1);return(0,a.jsx)(r.EuiFlexGroup,{responsive:!1,direction:"row",alignItems:"center",gutterSize:"s",wrap:!0},(0,a.jsx)(r.EuiFlexItem,{grow:!1},(0,a.jsx)(r.EuiText,{color:"subdued",size:"s"},(0,a.jsx)("em",null,i.i18n.translate("xpack.observabilityAiAssistant.insight.feedbackButtons.title",{defaultMessage:"Was this helpful?"})))),(0,a.jsx)(r.EuiFlexItem,{grow:!1},(0,a.jsx)(r.EuiFlexGroup,{responsive:!1,direction:"row",alignItems:"center",gutterSize:"xs"},(0,a.jsx)(r.EuiFlexItem,{grow:!1},(0,a.jsx)(r.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantFeedbackButtonsPositiveButton",color:"success",disabled:n,iconType:"faceHappy",size:"s",onClick:()=>{e("positive"),c(!0),t.toasts.addSuccess(l)}},i.i18n.translate("xpack.observabilityAiAssistant.insight.feedbackButtons.positive",{defaultMessage:"Yes"}))),(0,a.jsx)(r.EuiFlexItem,{grow:!1},(0,a.jsx)(r.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantFeedbackButtonsNegativeButton",color:"danger",disabled:n,iconType:"faceSad",size:"s",onClick:()=>{e("negative"),c(!0),t.toasts.addSuccess(l)}},i.i18n.translate("xpack.observabilityAiAssistant.insight.feedbackButtons.negative",{defaultMessage:"No"}))))))}},8240:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var s=n(3185),i=n(1319),r=(n(4286),n(5008)),o=n(6791);function a(e){return(0,o.jsx)(i.EuiButtonEmpty,(0,s.default)({size:"s","data-test-subj":"observabilityAiAssistantRegenerateResponseButton",iconType:"sparkles"},e),r.i18n.translate("xpack.observabilityAiAssistant.regenerateResponseButtonLabel",{defaultMessage:"Regenerate"}))}},637:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var s=n(3185),i=n(1319),r=(n(4286),n(5008)),o=n(6791);function a(e){return(0,o.jsx)(i.EuiButtonEmpty,(0,s.default)({"data-test-subj":"observabilityAiAssistantStopGeneratingButton",color:"text",iconType:"stop",size:"s"},e),r.i18n.translate("xpack.observabilityAiAssistant.stopGeneratingButtonLabel",{defaultMessage:"Stop generating"}))}},7523:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});let s=function(e){return e.executeEsqlQuery="executeEsqlQuery",e.visualizeEsqlQuery="visualizeEsqlQuery",e.updateVisualization="updateVisualization",e}({})},4738:(e,t,n)=>{"use strict";n.d(t,{I:()=>c});var s=n(1319),i=(n(4286),n(5008)),r=n(4081),o=n(6791);const a=(0,r.css)({name:"1najbre",styles:"height:32px;.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}"}),l=(0,r.css)({name:"rnnx2x",styles:"font-size:12px"});function c(e){var t;return e.loading?(0,o.jsx)(s.EuiFlexGroup,{alignItems:"center",className:a},(0,o.jsx)(s.EuiFlexItem,null,(0,o.jsx)(s.EuiLoadingSpinner,{size:"s"}))):e.error?(0,o.jsx)(s.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"s",className:a},(0,o.jsx)(s.EuiFlexItem,{grow:!1},(0,o.jsx)(s.EuiIcon,{type:"warning",color:"danger",size:"s"})),(0,o.jsx)(s.EuiFlexItem,{grow:!1},(0,o.jsx)(s.EuiText,{size:"xs",color:"danger"},i.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.error",{defaultMessage:"Failed to load connectors"})))):null!==(t=e.connectors)&&void 0!==t&&t.length?(0,o.jsx)(s.EuiFlexGroup,{className:a,direction:"row",alignItems:"center",gutterSize:"xs",responsive:!1},(0,o.jsx)(s.EuiFlexItem,{grow:!0},(0,o.jsx)(s.EuiSuperSelect,{"aria-label":i.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.connectorSelectAriaLabel",{defaultMessage:"Connector"}),compressed:!0,valueOfSelected:e.selectedConnector,options:e.connectors.map((e=>({value:e.id,inputDisplay:(0,o.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},(0,o.jsx)(s.EuiFlexItem,{grow:!1},(0,o.jsx)(s.EuiText,{size:"xs",color:"subdued"},i.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.connectorSelectLabel",{defaultMessage:"Connector:"}))),(0,o.jsx)(s.EuiFlexItem,{grow:!0},(0,o.jsx)(s.EuiTextTruncate,{text:e.name,className:l,truncation:"end"}))),dropdownDisplay:(0,o.jsx)(s.EuiText,{size:"xs"},e.name)}))),onChange:t=>{e.selectConnector(t)}}))):(0,o.jsx)(s.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"s",className:a},(0,o.jsx)(s.EuiFlexItem,{grow:!1},(0,o.jsx)(s.EuiText,{size:"xs",color:"warning"},i.i18n.translate("xpack.observabilityAiAssistant.connectorSelector.empty",{defaultMessage:"No connectors"}))))}},8040:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var s=n(1319),i=(n(4286),n(5008)),r=n(6791);function o(){return(0,r.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},(0,r.jsx)(s.EuiFlexItem,{grow:!1},(0,r.jsx)(s.EuiIcon,{type:"alert",color:"danger",size:"s"})),(0,r.jsx)(s.EuiFlexItem,null,(0,r.jsx)(s.EuiText,{size:"s",color:"danger"},i.i18n.translate("xpack.observabilityAiAssistant.failedLoadingResponseText",{defaultMessage:"Failed to load response"}))))}},3742:(e,t,n)=>{"use strict";n.d(t,{J:()=>C});var s=n(3185),i=n(1319),r=n(4081);const o=__kbnSharedDeps__.Classnames;var a=n.n(o),l=n(4286),c=n.n(l),u=n(5008),d=n(7523),p=n(6791);const m=e=>(0,r.css)("background-color:",e.euiTheme.colors.lightestShade,";.euiCodeBlock__pre{margin-bottom:0;padding:",e.euiTheme.size.m,";min-block-size:48px;}.euiCodeBlock__controls{inset-block-start:",e.euiTheme.size.m,";inset-inline-end:",e.euiTheme.size.m,";}","");function g({children:e}){const t=(0,i.useEuiTheme)();return(0,p.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!1,paddingSize:"s",className:m(t)},e)}function v({children:e}){return(0,p.jsx)(g,null,(0,p.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"xs"},(0,p.jsx)(i.EuiFlexItem,{grow:!1},(0,p.jsx)(i.EuiCodeBlock,{isCopyable:!0,fontSize:"m"},e))))}function f({value:e,lang:t,actionsDisabled:n,onActionClick:s}){return(0,p.jsx)(g,null,(0,p.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"xs"},(0,p.jsx)(i.EuiFlexItem,{grow:!1},(0,p.jsx)(i.EuiCodeBlock,{language:t,isCopyable:!0,fontSize:"m"},e)),(0,p.jsx)(i.EuiFlexItem,null,(0,p.jsx)(i.EuiFlexGroup,{direction:"row",gutterSize:"s"},(0,p.jsx)(i.EuiFlexItem,{grow:!1},(0,p.jsx)(i.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantEsqlCodeBlockRunThisQueryButton",size:"xs",iconType:"play",onClick:()=>s({type:d.Z.executeEsqlQuery,query:e}),disabled:n},u.i18n.translate("xpack.observabilityAiAssistant.runThisQuery",{defaultMessage:"Display results"}))),(0,p.jsx)(i.EuiFlexItem,{grow:!1},(0,p.jsx)(i.EuiButtonEmpty,{"data-test-subj":"observabilityAiAssistantEsqlCodeBlockVisualizeThisQueryButton",size:"xs",iconType:"lensApp",onClick:()=>s({type:d.Z.visualizeEsqlQuery,query:e}),disabled:n},u.i18n.translate("xpack.observabilityAiAssistant.visualizeThisQuery",{defaultMessage:"Visualize this query"})))))))}const h=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,s="!{anonymized",i=function(e,t,n){if(!t.startsWith(s))return!1;const i=t.charAt(12);if("{"!==i&&"}"!==i)return!1;if(n)return!0;let r=s,o={};if("{"===i){let n="",s=0;for(let e=12;e<t.length;e++){const i=t[e];if("{"===i)s++,n+=i;else if("}"===i){if(s--,-1===s)break;n+=i}else n+=i}r+=n;try{o=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse anonymized JSON configuration: ${t}`,{line:n.line,column:n.column+12})}}return r+="}",e(r)({type:"anonymized",...o})};i.locator=(e,t)=>e.indexOf(s,t),t.anonymized=i,n.splice(n.indexOf("text"),0,"anonymized")},b=(0,r.css)("@keyframes blink{0%{opacity:0;}50%{opacity:1;}100%{opacity:0;}}animation:blink ",1,"s infinite;width:10px;height:16px;vertical-align:middle;display:inline-block;background:rgba(0, 0, 0, 0.25);",""),y=()=>(0,p.jsx)("span",{key:"cursor",className:a()(b,"cursor")}),x=" ᠎  ",E=()=>{const e=(t,n)=>{if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}if("text"!==t.type&&"inlineCode"!==t.type&&"code"!==t.type)return;const s=t;if(-1===s.value.indexOf(x))return;s.value=s.value.replace(x,"");const i=n.children.indexOf(s);n.children.splice(i+1,0,{type:"cursor",value:x})};return t=>{e(t)}},A=()=>{const e=(t,n)=>{if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}"code"===t.type&&"esql"===t.lang?t.type="esql":"code"===t.type&&(t.type="codeBlock")};return t=>{e(t)}};function C({loading:e,content:t,onActionClick:n,anonymizedHighlightedContent:o}){const a=(0,r.css)({name:"26bywx",styles:"overflow-wrap:anywhere"}),{parsingPluginList:u,processingPluginList:d}=(0,l.useMemo)((()=>{const t=(0,i.getDefaultEuiMarkdownParsingPlugins)(),o=(0,i.getDefaultEuiMarkdownProcessingPlugins)(),{components:a}=o[1][1];return o[1][1].components={...a,anonymized:e=>(0,p.jsx)(i.EuiCode,{"data-test-subj":"anonymizedContent"},e.content),cursor:y,codeBlock:e=>(0,p.jsx)(c().Fragment,null,(0,p.jsx)(v,null,e.value),(0,p.jsx)(i.EuiSpacer,{size:"m"})),esql:t=>(0,p.jsx)(c().Fragment,null,(0,p.jsx)(f,{value:t.value,lang:t.lang,actionsDisabled:e,onActionClick:n}),(0,p.jsx)(i.EuiSpacer,{size:"m"})),table:e=>(0,p.jsx)(c().Fragment,null,(0,p.jsx)(i.EuiTable,(0,s.default)({},e,{className:(0,r.css)({name:"1q48xe6",styles:".euiTableCellContent__text{white-space:normal;}"})})),(0,p.jsx)(i.EuiSpacer,{size:"m"})),th:e=>{const{children:t,...n}=e;return(0,p.jsx)(i.EuiTableHeaderCell,n,t)},tr:e=>(0,p.jsx)(i.EuiTableRow,e),td:e=>{const{children:t,...n}=e;return(0,p.jsx)(i.EuiTableRowCell,(0,s.default)({truncateText:!0},n),t)}},{parsingPluginList:[E,A,...t,h],processingPluginList:o}}),[e,n]);return(0,p.jsx)(i.EuiText,{size:"s",className:a},(0,p.jsx)(i.EuiMarkdownFormat,{textSize:"s",parsingPluginList:u,processingPluginList:d},`${o||t}${e?x:""}`))}},3230:(e,t,n)=>{"use strict";n.d(t,{x:()=>p});var s=n(4286),i=n(1319),r=n(5008);const o=__kbnSharedDeps__.KbnI18nReact;var a=n(3185),l=n(6791),c={name:"1m7xl5f",styles:"line-height:1.5"};const u=({title:e,content:t,step:n,stepsTotal:r,anchorPosition:o,children:u,isOpen:d=!0,hasArrow:p=!0,subtitle:m,maxWidth:g=350,footerButtonLabel:v,zIndex:f,dismissTour:h,...b})=>{const[y,x]=(0,s.useState)(!1),E=()=>{x(!1),h&&h()};return(0,s.useEffect)((()=>{let e;return d?e=setTimeout((()=>{x(!0)}),250):x(!1),()=>{e&&clearTimeout(e)}}),[d]),(0,l.jsx)(i.EuiTourStep,(0,a.default)({title:e,subtitle:m,content:(0,l.jsx)(i.EuiText,{size:"m",css:c},t),step:n,stepsTotal:r,anchorPosition:o,repositionOnScroll:!0,isStepOpen:y,onFinish:E,hasArrow:p,maxWidth:g,zIndex:f,footerAction:(0,l.jsx)(i.EuiButtonEmpty,{size:"s",color:"text",onClick:E},v)},b),u)};var d=n(7541);const p=({children:e,isOpen:t=!0,zIndex:n,dismissTour:s})=>{const{docLinks:a}=(0,d.o)().services;return(0,l.jsx)(u,{title:r.i18n.translate("xpack.observabilityAiAssistant.tour.elasticLlmTitle",{defaultMessage:"Elastic Managed LLM connector now available"}),subtitle:r.i18n.translate("xpack.observabilityAiAssistant.tour.subtitle",{defaultMessage:"New AI feature!"}),content:(0,l.jsx)(o.FormattedMessage,{id:"xpack.observabilityAiAssistant.tour.elasticLlmContent",defaultMessage:"This new default LLM connector is optimized for Elastic AI features (<costLink>additional costs incur</costLink>). You can continue using existing LLM connectors if you prefer. <learnMoreLink>Learn more</learnMoreLink>",values:{costLink:(...e)=>{var t,n;return(0,l.jsx)(i.EuiLink,{href:null==a||null===(t=a.links)||void 0===t||null===(n=t.observability)||void 0===n?void 0:n.elasticManagedLlmUsageCost,target:"_blank",rel:"noopener noreferrer",external:!0},e)},learnMoreLink:(...e)=>{var t,n;return(0,l.jsx)(i.EuiLink,{href:null==a||null===(t=a.links)||void 0===t||null===(n=t.observability)||void 0===n?void 0:n.elasticManagedLlm,target:"_blank",rel:"noopener noreferrer",external:!0},e)}}}),step:1,stepsTotal:1,anchorPosition:"downLeft",isOpen:t,hasArrow:!0,footerButtonLabel:r.i18n.translate("xpack.observabilityAiAssistant.tour.footerButtonLabel",{defaultMessage:"Ok"}),zIndex:n,dismissTour:s},e)}},3388:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});const s=(0,n(4286).createContext)(void 0)},6349:(e,t,n)=>{"use strict";n.d(t,{T:()=>i,l:()=>s});const s=(0,n(4286).createContext)(void 0),i=s.Provider},149:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});const s=__kbnSharedDeps__.KbnStd;var i=n(4286);function r(e,t,n){const r=null==n?void 0:n.clearValueOnNext,o=(0,i.useRef)(new AbortController),[a,l]=(0,i.useState)(0),[c,u]=(0,i.useState)(),[d,p]=(0,i.useState)(!1),[m,g]=(0,i.useState)(null==n?void 0:n.defaultValue);return(0,i.useEffect)((()=>{o.current.abort();const t=new AbortController;o.current=t,r&&(g(void 0),u(void 0));try{const n=e({signal:t.signal});(0,s.isPromise)(n)?(p(!0),n.then((e=>{u(void 0),g(e)})).catch((e=>{g(void 0),u(e)})).finally((()=>p(!1)))):(u(void 0),g(n),p(!1))}catch(e){g(void 0),u(e),p(!1)}return()=>{t.abort()}}),t.concat(a,r)),(0,i.useMemo)((()=>({error:c,loading:d,value:m,refresh:()=>{l((e=>e+1))}})),[c,m,d])}},8539:(e,t,n)=>{"use strict";n.d(t,{ao:()=>d,_h:()=>g,Y_:()=>m});var s=n(5008),i=n(770),r=n(4286),o=n(1359),a=n(6230),l=n(7541),c=n(3721);function u(e){const t=(0,r.useRef)(e);return t.current!==e&&c.trace(`Variable changed from ${t.current} to ${e}, but only the initial value will be taken into account`),t.current}let d=function(e){return e.Ready="ready",e.Loading="loading",e.Error="error",e.Aborted="aborted",e}({});function p({initialMessages:e,initialConversationId:t,notifications:n,service:l,chatService:c,connectorId:p,onConversationUpdate:m,onChatComplete:g,persist:v,disableFunctions:f,scopes:h}){const[b,y]=(0,r.useState)(d.Ready),x=(0,r.useMemo)((()=>c.getSystemMessage()),[c]);u(e),u(t);const[E,A]=(0,r.useState)(t),[C,_]=(0,r.useState)(e),[S,k]=(0,r.useState)(),I=(0,r.useRef)(new AbortController),w=(0,r.useRef)(g);w.current=g;const T=(0,r.useRef)(m);T.current=m;const j=(0,r.useCallback)((()=>{y(d.Aborted)}),[]),O=(0,r.useCallback)((e=>{e instanceof o.AbortError?y(d.Aborted):(y(d.Error),(0,a.Vg)(e)?_((t=>{var n,i;return[...t,{"@timestamp":(new Date).toISOString(),message:{content:s.i18n.translate("xpack.observabilityAiAssistant.tokenLimitError",{defaultMessage:"The conversation has exceeded the token limit. The maximum token limit is **{tokenLimit}**, but the current conversation has **{tokenCount}** tokens. Please start a new conversation to continue.",values:{tokenLimit:null===(n=e.meta)||void 0===n?void 0:n.tokenLimit,tokenCount:null===(i=e.meta)||void 0===i?void 0:i.tokenCount}}),role:a.e4.Assistant}}]})):n.toasts.addError(e,{title:s.i18n.translate("xpack.observabilityAiAssistant.failedToLoadResponse",{defaultMessage:"Failed to load response from the AI Assistant"})}))}),[n.toasts]),L=(0,r.useCallback)((async(e,t)=>{if(I.current.signal.removeEventListener("abort",j),I.current.abort(),I.current=new AbortController,k([]),_(e),!p||!e.length)return void y(d.Ready);y(d.Loading);const n=c.complete({getScreenContexts:()=>l.getScreenContexts(),connectorId:p,messages:e,systemMessage:x,persist:v,disableFunctions:null!=f&&f,signal:I.current.signal,conversationId:E,scopes:h});function s(){return[...r,...o?[(0,i.merge)({message:{role:a.e4.Assistant,function_call:{trigger:a.e4.Assistant}}},o)]:[]]}const r=[];let o;const u=n.subscribe({next:e=>{var t,n;switch(e.type){case a.W9.ChatCompletionChunk:var i,l,c,u;o?(o.message.content+=e.message.content||"",o.message.function_call.name+=(null===(i=e.message.function_call)||void 0===i?void 0:i.name)||"",o.message.function_call.arguments+=(null===(l=e.message.function_call)||void 0===l?void 0:l.arguments)||""):o={"@timestamp":(new Date).toISOString(),message:{content:e.message.content||"",function_call:{name:(null===(c=e.message.function_call)||void 0===c?void 0:c.name)||"",arguments:(null===(u=e.message.function_call)||void 0===u?void 0:u.arguments)||""}}};break;case a.W9.MessageAdd:o=void 0,r.push(e.message);break;case a.W9.ConversationCreate:A(e.conversation.id),null===(t=T.current)||void 0===t||t.call(T,e);break;case a.W9.ConversationUpdate:null===(n=T.current)||void 0===n||n.call(T,e)}k(s())},complete:()=>{var t;y(d.Ready);const n=e.concat(r);_(n),k([]),null===(t=w.current)||void 0===t||t.call(w,n)},error:n=>{k([]),_(e.concat(s())),null==t||t(n),O(n)}});I.current.signal.addEventListener("abort",(()=>{j(),u.unsubscribe()}))}),[c,p,E,O,j,v,f,l,x,h]);return(0,r.useEffect)((()=>()=>{I.current.abort()}),[]),{messages:(0,r.useMemo)((()=>C.concat(null!=S?S:[])),[C,S]),setMessages:(0,r.useCallback)((e=>{I.current.abort(),k([]),y(d.Ready),_(e)}),[]),state:b,next:L,stop:()=>{I.current.abort()}}}function m(e){const{services:{notifications:t}}=(0,l.o)();return p({...e,notifications:t})}function g({notifications:e}){return t=>p({...t,notifications:e})}},6359:(e,t,n)=>{"use strict";n.d(t,{P:()=>o,k:()=>r});var s=n(7064),i=n.n(s);let r=function(e){return e.TOUR_CALLOUT="observabilityAIAssistant_elasticLlmTourCalloutDismissed",e.CONVERSATION_CALLOUT="observabilityAIAssistant_elasticLlmConversationCalloutDismissed",e}({});function o(e,t=!1){const[n=t,s]=i()(e,t);return[n,s]}},5326:(e,t,n)=>{"use strict";n.d(t,{s:()=>_,f:()=>S});var s=n(4286),i=n(7064),r=n.n(i),o=n(8597),a=n(4566),l=n(7541),c=n(6925);let u=function(e){return e.providerError="providerError",e.internalError="internalError",e.requestError="requestError",e.abortedError="requestAborted",e}({});const d=c.Sn;let p=function(e){return e.OpenAI=".gen-ai",e.Bedrock=".bedrock",e.Gemini=".gemini",e.Inference=".inference",e}({});const m=Object.values(p);let g=function(e){return e.OpenAI="OpenAI",e.Anthropic="Anthropic",e.Google="Google",e.Other="Other",e.Elastic="Elastic",e}({}),v=function(e){return e.GPT="GPT",e.Claude="Claude",e.Gemini="Gemini",e}({});const f=[{id:"gpt-4o-mini",provider:g.OpenAI,family:v.GPT,contextWindow:128e3},{id:"gpt-4o",provider:g.OpenAI,family:v.GPT,contextWindow:128e3},{id:"gpt-4.1-mini",provider:g.OpenAI,family:v.GPT,contextWindow:1e6},{id:"gpt-4.1-nano",provider:g.OpenAI,family:v.GPT,contextWindow:1e6},{id:"gpt-4.1",provider:g.OpenAI,family:v.GPT,contextWindow:1e6},{id:"gemini-1.5-pro",provider:g.Google,family:v.Gemini,contextWindow:1e6},{id:"gemini-1.5-flash",provider:g.Google,family:v.Gemini,contextWindow:1e6},{id:"gemini-2.0-flash",provider:g.Google,family:v.Gemini,contextWindow:1e6},{id:"gemini-2.0-pro",provider:g.Google,family:v.Gemini,contextWindow:2e6},{id:"gemini-2.0-flash-lite",provider:g.Google,family:v.Gemini,contextWindow:1e6},{id:"gemini-2.5-pro",provider:g.Google,family:v.Gemini,contextWindow:1e6},{id:"gemini-2.5-flash",provider:g.Google,family:v.Gemini,contextWindow:128e3},{id:"claude-3-sonnet",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-3-haiku",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-3-opus",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-3.5-sonnet",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-3.5-haiku",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-3.7-sonnet",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-4-sonnet",provider:g.Anthropic,family:v.Claude,contextWindow:2e5},{id:"claude-4-opus",provider:g.Anthropic,family:v.Claude,contextWindow:2e5}],h=e=>{var t,n,s,i,r,o,a;switch(e.type){case p.OpenAI:return null!==(t=e.config)&&void 0!==t&&t.defaultModel?e.config.defaultModel:"OpenAI"===(null===(n=e.config)||void 0===n?void 0:n.apiProvider)?"gpt-4.1":void 0;case p.Gemini:case p.Bedrock:return null!==(s=null===(i=e.config)||void 0===i?void 0:i.defaultModel)&&void 0!==s?s:void 0;case p.Inference:return null!==(r=null===(o=e.config)||void 0===o||null===(a=o.providerConfig)||void 0===a?void 0:a.model_id)&&void 0!==r?r:void 0}},b=e=>{switch(e.type){case p.OpenAI:return g.OpenAI;case p.Gemini:return g.Google;case p.Bedrock:return g.Anthropic;case p.Inference:return g.Elastic}},y={"rainbow-sprinkles":{provider:"bedrock",model:"us.anthropic.claude-3-7-sonnet-20250219-v1:0"}},x=e=>{var t,n;if(!function(e){return t=e.actionTypeId,!!m.includes(t)&&(e.actionTypeId!==p.Inference||"chat_completion"===(null!==(n=e.config)&&void 0!==n?n:{}).taskType);var t,n}(e))throw n=`Connector '${e.id}' of type '${e.actionTypeId}' not recognized as a supported connector`,new d(u.requestError,n,{status:400});const s={connectorId:e.id,name:e.name,type:e.actionTypeId,config:null!==(t=e.config)&&void 0!==t?t:{},capabilities:{}};return s.capabilities.contextWindowSize=(e=>{var t;if(!e.config)return;if(null!==(t=e.config)&&void 0!==t&&t.contextWindowLength)return e.config.contextWindowLength;const n=h(e);return n?(e=>{y[e]&&(e=y[e].model);const t=(n=e,f.find((e=>n.includes(e.id)||n.includes(e.id.replaceAll(".","-")))));var n;return null==t?void 0:t.contextWindow})(n):void 0})(s),s},E=["gpt-4.1-mini","gpt-4.1-nano","gpt-4.1","gpt-4o-mini","gpt-4o","gpt-4","gpt-35-turbo","o3-mini","o1-mini","o1"],A=e=>{if(!e)return;const t=x(e),n=(e=>{switch(b(e)){case g.Anthropic:case g.Elastic:return v.Claude;case g.Google:return v.Gemini;case g.OpenAI:return v.GPT}return v.GPT})(t),s=b(t),i=(e=>{var t,n;return h(e)||(e.type===p.OpenAI&&null!==(t=e.config)&&void 0!==t&&t.apiUrl?function(e){const t=new URL(e);if("azure.com"===t.hostname||t.hostname.endsWith(".azure.com"))return E.find((e=>t.pathname.includes(e)))}(null===(n=e.config)||void 0===n?void 0:n.apiUrl):void 0)})(t);return{connectorId:t.connectorId,name:t.name,type:t.type,modelFamily:n,modelProvider:s,modelId:i}},C="NO_DEFAULT_CONNECTOR";function _(){return S((0,a.h)())}function S(e){var t;const[n,i]=(0,s.useState)(void 0),{services:{uiSettings:a}}=(0,l.o)(),c=a.get(o.rn),u=a.get(o.b6,!1)&&c!==C,[d,p]=r()("xpack.observabilityAiAssistant.lastUsedConnector",""),m=(0,s.useMemo)((()=>u?c:d||(c!==C?c:void 0)),[u,c,d]),[g,v]=(0,s.useState)(!1),[f,h]=(0,s.useState)(void 0),b=(0,s.useMemo)((()=>new AbortController),[]),y=(0,s.useCallback)((async()=>{v(!0);try{let t=await e.callApi("GET /internal/observability_ai_assistant/connectors",{signal:b.signal});if(u){const e=t.find((e=>e.id===c));t=e?[e]:[]}i(t),p((e=>e&&-1===t.findIndex((t=>t.id===e))?"":e)),h(void 0)}catch(e){h(e),i(void 0)}finally{v(!1)}}),[e,b.signal,u,c,v]);return(0,s.useEffect)((()=>(y(),()=>{b.abort()})),[b,y]),{connectors:n,loading:g,error:f,selectedConnector:m||(null==n||null===(t=n[0])||void 0===t?void 0:t.id),selectConnector:e=>{p(e)},reloadConnectors:()=>{y()},getConnector:e=>{const t=null==n?void 0:n.find((t=>t.id===e));return A(t)},isConnectorSelectionRestricted:u,defaultConnector:c===C?void 0:c}}},7541:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});var s=n(409);const i=()=>(0,s.useKibana)()},4566:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var s=n(4286),i=n(6349);function r(){const e=(0,s.useContext)(i.l);if(!e)throw new Error("ObservabilityAIAssistantContext not set. Did you wrap your component in `<ObservabilityAIAssistantProvider/>`?");return e}},8471:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var s=n(4286),i=n(3388);function r(){const e=(0,s.useContext)(i.Y);if(!e)throw new Error("ObservabilityAIAssistantChatServiceContext not set. Did you wrap your component in `<ObservabilityAIAssistantChatServiceContext.Provider/>`?");return e}},755:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ChatActionClickType:()=>X.Z,ChatItemControls:()=>Y,ChatState:()=>x.ao,ConnectorSelectorBase:()=>D.I,ConversationAccess:()=>_.QP,E5_LARGE_IN_EIS_INFERENCE_ID:()=>_.B4,E5_SMALL_INFERENCE_ID:()=>_.pe,EIS_PRECONFIGURED_INFERENCE_IDS:()=>_.Lc,ELSER_IN_EIS_INFERENCE_ID:()=>_.c3,ELSER_ON_ML_NODE_INFERENCE_ID:()=>_.LN,ElasticLlmCalloutKey:()=>le.k,ElasticLlmTourCallout:()=>K.x,FailedToLoadResponse:()=>H.I,FeedbackButtons:()=>U.z,INFERENCE_CONNECTOR_ACTION_TYPE_ID:()=>re.u,InferenceModelState:()=>_.QA,KnowledgeBaseEntryRole:()=>_.yh,KnowledgeBaseType:()=>_.g6,LEGACY_CUSTOM_INFERENCE_ID:()=>_.sl,MessageRole:()=>_.e4,MessageText:()=>J.J,ObservabilityAIAssistantFlyoutStateProvider:()=>ue,ObservabilityAIAssistantTelemetryEventType:()=>ee.L,StreamingChatResponseEventType:()=>_.W9,VISUALIZE_ESQL_USER_INTENTIONS:()=>Z.v,VisualizeESQLUserIntention:()=>Z.j,aiAssistantCapabilities:()=>N,aiAssistantLogsIndexPattern:()=>ne,aiAssistantSearchConnectorIndexPattern:()=>ie,aiAssistantSimulatedFunctionCalling:()=>se,concatenateChatCompletionChunks:()=>_.wx,createFunctionRequestMessage:()=>k,createFunctionResponseMessage:()=>I.X,createScreenContextAction:()=>z,createStorybookChatService:()=>B,createStorybookService:()=>W,elasticAiAssistantImage:()=>pe,getConnectorsManagementHref:()=>oe.$,getElasticManagedLlmConnector:()=>re.l,navigateToConnectorsManagementApp:()=>oe.n,navigateToSettingsManagementApp:()=>ae,plugin:()=>me,useAbortableAsync:()=>G.m,useElasticLlmCalloutDismissed:()=>le.P,useGenAIConnectorsWithoutContext:()=>b.f,useKibana:()=>te.o,useObservabilityAIAssistantFlyoutStateContext:()=>de});var s=n(3185),i=n(8915),r=n(409);const o=__kbnSharedDeps__.KbnSharedUxErrorBoundary;var a=n(4286),l=n.n(a),c=n(1319),u=n(6791),d={name:"1azakc",styles:"text-align:center"};const p=()=>{const e=d;return(0,u.jsx)("div",{css:e},(0,u.jsx)(c.EuiLoadingSpinner,null))},m=(e,t=(0,u.jsx)(p,null))=>l().forwardRef(((n,i)=>(0,u.jsx)(o.KibanaErrorBoundaryProvider,{analytics:n.analytics},(0,u.jsx)(o.KibanaErrorBoundary,null,(0,u.jsx)(a.Suspense,{fallback:t},(0,u.jsx)(e,(0,s.default)({},n,{ref:i})))))));var g=n(6136),v=n(3388);const f=(0,a.createContext)(void 0);var h=n(6349),b=n(5326),y=n(8471),x=n(8539),E=n(770),A=n(190),C=n(9472),_=n(6230),S=n(7121);function k({name:e,args:t}){return{id:(0,C.v4)(),type:S.W9.MessageAdd,message:{"@timestamp":(new Date).toISOString(),message:{function_call:{name:e,arguments:JSON.stringify(t),trigger:_.e4.Assistant},role:_.e4.Assistant,content:""}}}}var I=n(519);const w=["delete","get","patch","post","put"];class ParseError extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function T(e){}var j=n(6925);function O(){return(0,A.switchMap)((e=>function(e){const t=e.response,n=null==t?void 0:t.body;return n?new A.Observable((e=>{const t=function(e){if("function"==typeof e)throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=T,onError:n=T,onRetry:s=T,onComment:i}=e;let r,o="",a=!0,l="",c="";function u(e){if(""===e)return l.length>0&&t({id:r,event:c||void 0,data:l.endsWith("\n")?l.slice(0,-1):l}),r=void 0,l="",void(c="");if(e.startsWith(":"))return void(i&&i(e.slice(e.startsWith(": ")?2:1)));const n=e.indexOf(":");if(-1===n)d(e,"",e);else{const t=e.slice(0,n),s=" "===e[n+1]?2:1;d(t,e.slice(n+s),e)}}function d(e,t,i){switch(e){case"event":c=t;break;case"data":l=`${l}${t}\n`;break;case"id":r=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?s(parseInt(t,10)):n(new ParseError(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:i}));break;default:n(new ParseError(`Unknown field "${e.length>20?`${e.slice(0,20)}…`:e}"`,{type:"unknown-field",field:e,value:t,line:i}))}}return{feed:function(e){const t=a?e.replace(/^\xEF\xBB\xBF/,""):e,[n,s]=function(e){const t=[];let n="",s=0;for(;s<e.length;){const i=e.indexOf("\r",s),r=e.indexOf("\n",s);let o=-1;if(-1!==i&&-1!==r?o=Math.min(i,r):-1!==i?o=i===e.length-1?-1:i:-1!==r&&(o=r),-1===o){n=e.slice(s);break}{const n=e.slice(s,o);t.push(n),s=o+1,"\r"===e[s-1]&&"\n"===e[s]&&s++}}return[t,n]}(`${o}${t}`);for(const e of n)u(e);o=s,a=!1},reset:function(e={}){o&&e.consume&&u(o),a=!0,r=void 0,l="",c="",o=""}}}({onEvent:t=>{try{const n=JSON.parse(t.data);if("error"===t.event){const t=n;e.error(new j.Sn(t.error.code,t.error.message,t.error.meta))}else e.next({type:t.event||"event",...n})}catch(t){e.error((0,j.F5)("Failed to parse JSON"))}}});(async()=>{const e=n.getReader(),s=new TextDecoder,i=({done:n,value:r})=>n?Promise.resolve():(t.feed(s.decode(r,{stream:!0})),e.read().then(i));return e.read().then(i)})().then((()=>{e.complete()})).catch((t=>{e.error(t)}))})):(0,A.throwError)((()=>{throw(0,j.F5)("No readable stream found in response")}))}(e)))}function L(e){return function(e){const t=(t,n,s)=>{const{method:i,pathname:r,version:o}=function(e,t={}){var n,s,i;const{method:r,pathname:o,version:a}=function(e){var t;const n=e.split(" "),s=n[0].trim().toLowerCase(),i=n[1].trim(),r=null===(t=n[2])||void 0===t?void 0:t.trim();if(!w.includes(s))throw new Error(`Endpoint ${e} was not prefixed with a valid HTTP method`);return{method:s,pathname:i,version:r}}(e),l=/(\/\{\w+\?\})/g,c=/(\/{)((.+?))(\})/g;if(0===(null===(n=Object.keys(t))||void 0===n?void 0:n.length))return{method:r,pathname:o.replace(c,""),version:a};const u=Object.keys(t).reduce(((e,n)=>e.replace(`{${n}}`,encodeURIComponent(t[n])).replace(`{${n}?}`,encodeURIComponent(t[n]))),o);if((null===(s=null!==(i=u.match(l))&&void 0!==i?i:[])||void 0===s?void 0:s.length)>0)throw new Error(`Missing parameters: ${u.match(l)}`);return{method:r,pathname:u,version:a}}(t,null==n?void 0:n.path);return e.http.fetch(r,{method:i.toUpperCase(),...s,body:n&&n.body?JSON.stringify(n.body):void 0,query:null==n?void 0:n.query,version:o})};return{fetch:(e,...n)=>{var s;const i=null!==(s=n[0])&&void 0!==s?s:{},r="params"in i?i.params:{},o=(0,E.omit)(i,"params");return t(e,r,o)},stream:(e,...n)=>{var s;const i=null!==(s=n[0])&&void 0!==s?s:{},r="params"in i?i.params:{},o=(0,E.omit)(i,"params");return(0,A.from)(t(e,r,{...o,asResponse:!0,rawResponse:!0})).pipe(O())}}}(e).fetch}var F=n(5008);const P=[{title:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.exampleQuestions.title",{defaultMessage:"Suggest"}),prompt:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.exampleQuestions.prompt",{defaultMessage:"Give me examples of questions I can ask here."}),icon:"sparkles",scopes:["all"]},{title:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.explainThisPage.title",{defaultMessage:"Explain"}),prompt:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.explainThisPage.prompt",{defaultMessage:"Can you explain this page?"}),icon:"inspect",scopes:["all"]},{title:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.doIHaveAlerts.title",{defaultMessage:"Alerts"}),prompt:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.doIHaveAlerts.prompt",{defaultMessage:"Do I have any alerts?"}),icon:"bell",scopes:["observability"]},{title:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.whatAreSlos.title",{defaultMessage:"SLOs"}),prompt:F.i18n.translate("xpack.observabilityAiAssistant.app.starterPrompts.whatAreSlos.prompt",{defaultMessage:"What are Service Level Objectives (SLOs)?"}),icon:"bullseye",scopes:["observability"]}];function z(e,t){return{...e,respond:t}}function M({message:e,instructions:t}){return[{"@timestamp":(new Date).toISOString(),message:{role:_.e4.User,content:e}},{"@timestamp":(new Date).toISOString(),message:{role:_.e4.Assistant,function_call:{name:"get_contextual_insight_instructions",trigger:_.e4.Assistant,arguments:JSON.stringify({})}}},{"@timestamp":(new Date).toISOString(),message:{role:_.e4.User,content:JSON.stringify({instructions:t}),name:"get_contextual_insight_instructions"}}]}const N={show:"show"};class ObservabilityAIAssistantPlugin{constructor(e){(0,i.default)(this,"logger",void 0),(0,i.default)(this,"service",void 0),(0,i.default)(this,"scopeFromConfig",void 0),this.logger=e.logger.get();const t=e.config.get();this.scopeFromConfig=t.scope}setup(e,t){return(0,g.S)(e.analytics),{}}start(e,t){const i=this.service=function({analytics:e,coreStart:t,enabled:s,scopes:i,scopeIsMutable:r}){const o=L(t),a=[],l=new A.BehaviorSubject([{starterPrompts:P}]),c=new A.Subject,u=new A.BehaviorSubject(i),d=()=>{const e=u.value;return l.value.map((({starterPrompts:t,...n})=>{return{...n,starterPrompts:null==t?void 0:t.filter((s=e,function(e){return!s||!e||null==e||!e.scopes||e.scopes.some((e=>[...s,"all"].includes(e)))}))};var s}))};return{isEnabled:()=>s,register:e=>{a.push(e)},start:async({signal:t})=>{const s=await n.e(27).then(n.bind(n,8027));return await s.createChatService({analytics:e,apiClient:o,signal:t,registrations:a,scope$:u})},callApi:o,getScreenContexts:d,setScreenContext:e=>(l.next(l.value.concat(e)),function(){l.next((0,E.without)(l.value,e))}),navigate:async e=>(e(),await(0,A.lastValueFrom)(t.http.getLoadingCount$().pipe((0,A.filter)((e=>0===e)),(0,A.debounceTime)(1e3),(0,A.take)(1))),(0,A.of)(k({name:"context"}),(0,I.X)({name:"context",content:{screenDescription:(0,E.compact)(d().map((e=>e.screenDescription))).join("\n\n")}}))),conversations:{openNewConversation:({messages:e,title:t,hideConversationList:n=!1})=>{c.next({messages:e,title:t,hideConversationList:n})},predefinedConversation$:c.asObservable()},setScopes:e=>{r||u.next(e)},getScopes:()=>u.value,scope$:u}}({analytics:e.analytics,coreStart:e,enabled:!0===e.application.capabilities.observabilityAIAssistant[N.show],scopes:this.scopeFromConfig?[this.scopeFromConfig]:["all"],scopeIsMutable:!!this.scopeFromConfig}),o={...e,plugins:{start:t}},c=i.isEnabled();return{service:i,useGenAIConnectors:()=>(0,b.f)(i),useChat:(0,x._h)({notifications:e.notifications}),ObservabilityAIAssistantMultipaneFlyoutContext:f,ObservabilityAIAssistantChatServiceContext:v.Y,useObservabilityAIAssistantChatService:y.Q,ObservabilityAIAssistantContextualInsight:c?m(((e,t)=>l().forwardRef(((n,o)=>(0,u.jsx)(r.KibanaContextProvider,{services:t},(0,u.jsx)(h.T,{value:i},(0,u.jsx)(e,(0,s.default)({},n,{ref:o})))))))((0,a.lazy)((()=>n.e(665).then(n.bind(n,7665)).then((e=>({default:e.Insight}))))),o)):null,getContextualInsightMessages:M,createScreenContextAction:z}}}const R=n.p+"1d3bfc3835a49c4d.png";var D=n(4738),G=n(149);const B=()=>({sendAnalyticsEvent:()=>{},chat:e=>new A.Observable,complete:e=>new A.Observable,getFunctions:()=>[{name:"elasticsearch",description:"Call Elasticsearch APIs on behalf of the user",descriptionForUser:"Call Elasticsearch APIs on behalf of the user",parameters:{type:"object",properties:{method:{type:"string",description:"The HTTP method of the Elasticsearch endpoint",enum:["GET","PUT","POST","DELETE","PATCH"]},path:{type:"string",description:"The path of the Elasticsearch endpoint, including query parameters"}},required:["method","path"]}},{name:"get_service_summary",description:"Gets a summary of a single service, including: the language, service version, deployments, infrastructure, alerting, etc. ",descriptionForUser:"Get a summary for a single service.",parameters:{type:"object"}}],renderFunction:e=>(0,u.jsx)("div",null,F.i18n.translate("xpack.observabilityAiAssistant.chatService.div.helloLabel",{defaultMessage:"Hello"}),e),hasFunction:()=>!0,hasRenderFunction:()=>!0,getSystemMessage:()=>"System",functions$:new A.BehaviorSubject([]),getScopes:()=>["all"]}),W=()=>({isEnabled:()=>!0,start:async()=>B(),callApi:{},register:()=>{},setScreenContext:()=>E.noop,getScreenContexts:()=>[],conversations:{openNewConversation:E.noop,predefinedConversation$:new A.Observable},navigate:async()=>(0,A.of)(),scope$:new A.BehaviorSubject(["all"]),getScopes:()=>["all"],setScopes:()=>{}});var U=n(7636),$=n(4081),q=n(637),Q=n(8240);const V=(0,$.css)({name:"1kr8da6",styles:"padding-top:4px;padding-bottom:4px"});function Y({error:e,loading:t,canRegenerate:n,canGiveFeedback:s,onFeedbackClick:i,onRegenerateClick:r,onStopGeneratingClick:o}){const a=!e&&s,d=!t&&n;let p;return p=t?(0,u.jsx)(q.$,{onClick:o}):a||d?(0,u.jsx)(c.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},a?(0,u.jsx)(c.EuiFlexItem,{grow:!0},(0,u.jsx)(U.z,{onClickFeedback:i})):null,d?(0,u.jsx)(c.EuiFlexItem,{grow:!1},(0,u.jsx)(Q.C,{onClick:r})):null):null,p?(0,u.jsx)(l().Fragment,null,(0,u.jsx)(c.EuiHorizontalRule,{margin:"none"}),(0,u.jsx)(c.EuiPanel,{hasShadow:!1,paddingSize:"s",className:V},p)):null}var H=n(8040),J=n(3742),K=n(3230),X=n(7523),Z=n(2944),ee=n(4540),te=n(7541);const ne=n(8597).uq,se="observability:aiAssistantSimulatedFunctionCalling",ie="observability:aiAssistantSearchConnectorIndexPattern";var re=n(2066),oe=n(8832);function ae(e){e.navigateToApp("management",{path:"/ai/observabilityAiAssistantManagement"})}var le=n(6359);const ce=(0,a.createContext)(void 0);function ue({children:e,isFlyoutOpen:t}){return(0,u.jsx)(ce.Provider,{value:{isFlyoutOpen:t}},e)}function de(){const e=(0,a.useContext)(ce);return void 0===e?{isFlyoutOpen:!1}:e}const pe=R,me=e=>new ObservabilityAIAssistantPlugin(e)},2066:(e,t,n)=>{"use strict";n.d(t,{l:()=>i,u:()=>s});const s=".inference",i=e=>{if(Array.isArray(e)&&0!==e.length)return e.find((e=>{var t;return e.actionTypeId===s&&e.isPreconfigured&&"elastic"===(null===(t=e.config)||void 0===t?void 0:t.provider)}))}},8832:(e,t,n)=>{"use strict";function s(e){return e.basePath.prepend("/app/management/insightsAndAlerting/triggersActionsConnectors/connectors")}function i(e){e.navigateToApp("management",{path:"/insightsAndAlerting/triggersActionsConnectors/connectors"})}n.d(t,{$:()=>s,n:()=>i})},4622:(e,t,n)=>{n.p=window.__kbnPublicPath__.observabilityAIAssistant},409:(e,t,n)=>{n.r(t);var s=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},1359:(e,t,n)=>{n.r(t);var s=__kbnBundles__.get("plugin/kibanaUtils/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},4081:(e,t,n)=>{e.exports=n(2497)(28995)},3721:(e,t,n)=>{e.exports=n(2497)(4971)},3185:(e,t,n)=>{e.exports=n(2497)(51858)},8915:(e,t,n)=>{e.exports=n(2497)(67493)},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},7064:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useLocalStorage},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,s),r.exports}s.m=t,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>"observabilityAIAssistant.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},s.l=(t,n,i,r)=>{if(e[t])e[t].push(n);else{var o,a;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==t){o=u;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.src=t),e[t]=[n];var d=(n,s)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[t];if(delete e[t],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(s))),n)return n(s)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),a&&document.head.appendChild(o)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={676:0};s.f.j=(t,n)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,s)=>i=e[t]=[n,s]));n.push(i[2]=r);var o=s.p+s.u(t),a=new Error;s.l(o,(n=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,r,[o,a,l]=n,c=0;if(o.some((t=>0!==e[t]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);l&&l(s)}for(t&&t(n);c<o.length;c++)r=o[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.observabilityAIAssistant_bundle_jsonpfunction=self.observabilityAIAssistant_bundle_jsonpfunction||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s(4622),__kbnBundles__.define("plugin/observabilityAIAssistant/public",s,755)})();