/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,o={787:(e,t,o)=>{"use strict";o.d(t,{$B:()=>d,AR:()=>h,Af:()=>m,Du:()=>g,Ek:()=>_,G5:()=>V,GU:()=>A,GW:()=>I,Lh:()=>w,N4:()=>l,NZ:()=>j,OF:()=>y,OU:()=>S,SW:()=>n,Vr:()=>$,WD:()=>a,Z8:()=>f,ab:()=>s,bC:()=>x,cd:()=>v,eH:()=>p,fU:()=>M,kP:()=>r,nH:()=>u,oO:()=>C,oS:()=>D,os:()=>b,x2:()=>i,yF:()=>k,yw:()=>E,zs:()=>T,zy:()=>c});const i="session_view",s="1",n="/internal/session_view/process_events",r="/internal/session_view/alerts",a="/internal/session_view/alert_status",l="/internal/session_view/io_events",u="/internal/session_view/get_total_io_bytes",d="security",c="/administration/policy",p="process.entry_leader.entity_id",m=500,v=100,x=10,g="sessionViewProcessEvents",j="sessionViewAlerts",h="sessionViewIOEvents",y="sessionViewGetTotalIOBytes",b="sessionView:displayOptions",f={stopPropagation:()=>{}},C=500,w=30,T=200,k=11,_=66,I=280,$=/(\r?\n|\r\n?|\x1b\[\d+;\d*[Hf]?)/gi,S={process:"gear",file:"document",network:"globe"},E="all",P=["@timestamp","event.id","event.kind","event.type","event.action","event.category","user.id","user.name","group.id","group.name","host.architecture","host.hostname","host.id","host.ip","host.mac","host.name","host.os.family","host.os.full","host.os.kernel","host.os.name","host.platform","host.version","host.boot.id","process.entity_id","process.args","process.command_line","process.executable","process.name","process.interactive","process.working_directory","process.pid","process.start","process.end","process.user.id","process.user.name","process.group.id","process.group.name","process.supplemental_groups","process.exit_code","process.tty.*","process.entry_leader.*","process.session_leader.*","process.group_leader.*","process.parent.*","process.previous","container.id","container.name","container.image.name","container.image.tag","container.image.hash.all","orchestrator.resource.name","orchestrator.resource.type","orchestrator.resource.ip","orchestrator.resource.parent.type","orchestrator.resource.labels","orchestrator.resource.annotations","orchestrator.namespace","orchestrator.cluster.name","orchestrator.cluster.id","cloud.instance.name","cloud.account.id","cloud.project.id","cloud.project.name","cloud.provider","cloud.region"],M=(P.concat(["process.io.*"]),P.concat(["file.extension","file.path","file.name","network.type","network.transport","network.protocol","destination.address","destination.ip","destination.protocol","source.address","source.ip","source.protocol","kibana.alert.uuid","kibana.alert.reason","kibana.alert.workflow_status","kibana.alert.status","kibana.alert.original_time","kibana.alert.original_event.action","kibana.alert.rule.category","kibana.alert.rule.consumer","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.name","kibana.alert.rule.risk_score","kibana.alert.rule.severity","kibana.alert.rule.uuid","kibana.alert.rule.parameters.query","kibana.alert.rule.query"]),"fork"),A="end",V="exec",D="executed"},716:(e,t,o)=>{"use strict";o.d(t,{U:()=>a});var i=o(8);const s=i.i18n.translate("xpack.sessionView.processTooltip",{defaultMessage:"Process alert"}),n=i.i18n.translate("xpack.sessionView.networkTooltip",{defaultMessage:"Network alert"}),r=i.i18n.translate("xpack.sessionView.fileTooltip",{defaultMessage:"File alert"}),a=e=>{let t="";switch(e){case"file":t=r;break;case"network":t=n;break;default:t=s}return t}},616:(e,t,o)=>{"use strict";o.d(t,{MK:()=>u,TQ:()=>l,gj:()=>d,rx:()=>c});var i=o(286),s=o(530),n=o(409),r=o(787);const a=e=>!!e&&[r.fU,r.G5,r.oS,r.GU].includes(e),l=(e,t,o,l)=>{const{http:u}=(0,n.useKibana)().services,[d,c]=(0,i.useState)(""),p=(0,i.useMemo)((()=>[r.Du,e,t,l]),[e,t,l]),m=(0,s.useInfiniteQuery)(p,(async({pageParam:i={}})=>{var s,n;let{cursor:a}=i;const{forward:d}=i;!a&&l&&(a=l);const c=await u.get(r.SW,{version:r.ab,query:{index:e,sessionEntityId:t,sessionStartTime:o,cursor:a,forward:d}});return{events:null!==(s=null===(n=c.events)||void 0===n?void 0:n.map((e=>e._source)))&&void 0!==s?s:[],cursor:a,total:c.total}}),{getNextPageParam:(e,t)=>{if(1===t.length&&l||e.events.length>=r.Af){var o;const t=e.events.filter((e=>{var t;const o=null===(t=e.event)||void 0===t?void 0:t.action;return a(o)})),i=null==t||null===(o=t[t.length-1])||void 0===o?void 0:o["@timestamp"];if(i)return{cursor:i,forward:!0}}},getPreviousPageParam:(e,t)=>{const o=e.events.filter((e=>{var t;const o=null===(t=e.event)||void 0===t?void 0:t.action;return a(o)})),i=t.length>1&&o.length<r.Af;var s;if(l&&!i)return{cursor:(null===(s=o[0])||void 0===s?void 0:s["@timestamp"])||l,forward:!1}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1});return(0,i.useEffect)((()=>{var e;l&&1===(null===(e=m.data)||void 0===e?void 0:e.pages.length)&&l!==d&&(m.fetchPreviousPage({cancelRefetch:!0}),c(l))}),[l,m,d]),m},u=(e,t,o)=>{const{http:i}=(0,n.useKibana)().services,a=[r.NZ,e,o];return(0,s.useInfiniteQuery)(a,(async({pageParam:s={}})=>{var n,a;const{cursor:l}=s,u=await i.get(r.kP,{version:r.ab,query:{sessionEntityId:e,sessionStartTime:t,investigatedAlertId:o,cursor:l}});return{events:null!==(n=null===(a=u.events)||void 0===a?void 0:a.map((e=>e._source)))&&void 0!==n?n:[],cursor:l,total:u.total}}),{getNextPageParam:e=>{if(e.events.length>=r.cd)return{cursor:e.events[e.events.length-1]["@timestamp"]}},refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})},d=(e,t)=>{const{http:o}=(0,n.useKibana)().services,i=[r.NZ,t];return(0,s.useQuery)(i,(async()=>{var i,s,n,a,l,u,d,c,p;if(!t)return e;const m=null!==(i=null===(s=(await o.get(r.WD,{version:r.ab,query:{alertUuid:t}})).events)||void 0===s?void 0:s.map((e=>e._source)))&&void 0!==i?i:[];return{...e,[t]:{status:null!==(n=null===(a=m[0])||void 0===a||null===(l=a.kibana)||void 0===l||null===(u=l.alert)||void 0===u?void 0:u.workflow_status)&&void 0!==n?n:"",processEntityId:null!==(d=null===(c=m[0])||void 0===c||null===(p=c.process)||void 0===p?void 0:p.entity_id)&&void 0!==d?d:""}}}),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})},c=(e,t,o)=>{const{http:i}=(0,n.useKibana)().services,a=[r.OF,e,t];return(0,s.useQuery)(a,(async()=>i.get(r.nH,{version:r.ab,query:{index:e,sessionEntityId:t,sessionStartTime:o}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,cacheTime:0})}},23:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});const i="-"},678:(e,t,o)=>{"use strict";o.d(t,{N:()=>l,g:()=>r});var i=o(286),s=o(319),n=o(803);const r=(...e)=>({...(0,s.useEuiTheme)(...e),euiVars:(0,i.useMemo)((()=>({terminalOutputBackground:"#1d1e23",terminalOutputMarkerAccent:n.euiLightVars.euiColorAccent,terminalOutputMarkerWarning:n.euiDarkVars.euiColorWarning,terminalOutputSliderBackground:n.euiLightVars.euiColorDarkestShade})),[])});var a=o(409);const l=()=>(0,a.useUiSetting)("dateFormat")},277:(e,t,o)=>{"use strict";o.r(t),o.d(t,{DetailPanelAlertTab:()=>z,DetailPanelMetadataTab:()=>k,DetailPanelProcessTab:()=>T,ENTRY_SESSION_ENTITY_ID_PROPERTY:()=>s.eH,plugin:()=>B,useFetchSessionViewAlerts:()=>N.MK});var i=o(380);class SessionViewPlugin{setup(e){return{}}start(e,t){return{getSessionView:e=>(0,i.q7)({...e,usageCollection:null==t?void 0:t.usageCollection})}}stop(){}}var s=o(787),n=o(286),r=o.n(n),a=o(319),l=o(8),u=o(791);const d=({listItems:e})=>{const t=(()=>{const{euiTheme:e}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>({descriptionList:{padding:`${e.size.base} ${e.size.s} `,alignItems:"flex-start",rowGap:0},tabListTitle:{display:"flex"},tabListDescription:{display:"flex"}})),[e])})();return(0,u.jsx)(a.EuiDescriptionList,{type:"column",columnWidths:[2,3],listItems:e,css:t.descriptionList,titleProps:{css:t.tabListTitle},descriptionProps:{css:t.tabListDescription},"data-test-subj":"sessionView:detail-panel-description-list"})},c=({id:e,listItems:t,title:o,tooltipContent:i,extraActionTitle:s,onExtraActionClick:r,children:l,initialIsOpen:c=!1})=>{const p=(()=>{const{euiTheme:e}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>{const t={padding:e.size.base};return{accordion:{borderTop:e.border.thin,"&:last-child":{borderBottom:e.border.thin},dl:{paddingTop:"0px"},"&:only-child":{border:e.border.thin,borderRadius:e.border.radius.medium}},accordionButton:{padding:e.size.base,fontWeight:e.font.weight.bold},tabSection:t}}),[e])})();return(0,u.jsx)(a.EuiAccordion,{id:e,arrowDisplay:"right",initialIsOpen:c,buttonContent:(0,u.jsx)(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,css:p.accordionButton},(0,u.jsx)(a.EuiFlexItem,{grow:!1},(0,u.jsx)("span",null,o)),i&&(0,u.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"sessionView:detail-panel-accordion-tooltip"},(0,u.jsx)(a.EuiIconTip,{content:i}))),css:p.accordion,"data-test-subj":"sessionView:detail-panel-accordion"},(0,u.jsx)(d,{listItems:t}),l)};var p=o(185);const m=({children:e,copy:t,display:o="grid"})=>{const[i,s]=(0,n.useState)(!1),r=(({display:e})=>{const{euiTheme:t}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>{const o={display:e,alignContent:"center",padding:`${t.size.xs} ${t.size.s} `,width:"100%",fontWeight:"inherit",height:"max-content",minHeight:t.size.l,letterSpacing:"0px",textAlign:"left","& .euiToolTipAnchor":{width:`calc(100% - ${t.size.xl})`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}};return{item:o,copiableItem:{...o,position:"relative",borderRadius:t.border.radius.medium,"&:hover":{background:(0,a.transparentize)(t.colors.primary,.1)},height:"fit-content"}}}),[e,t])})({display:o}),l={size:"s",css:t?r.copiableItem:r.item};return t&&(l.onMouseEnter=()=>s(!0),l.onMouseLeave=()=>s(!1)),(0,u.jsx)(a.EuiText,(0,p.default)({},l,{"data-test-subj":"sessionView:detail-panel-list-item"}),e,i&&t)},v=({children:e,textToCopy:t,tooltipContent:o,display:i="inlineBlock"})=>{const s=(()=>{const{euiTheme:e}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>({copyButton:{position:"absolute",right:e.size.s,top:0,bottom:0,margin:"auto"}})),[e])})(),d={copy:(0,u.jsx)(a.EuiCopy,{textToCopy:t,tooltipProps:{display:i}},(e=>(0,u.jsx)(a.EuiButtonIcon,{css:s.copyButton,onClick:e,display:"base",iconType:"copyClipboard",size:"xs","aria-label":l.i18n.translate("xpack.sessionView.detailPanelCopy.copyButton",{defaultMessage:"Copy"})})))};return"block"===i&&(d.display=i),(0,u.jsx)(m,d,(0,u.jsx)(a.EuiToolTip,{position:"top",content:o},(0,u.jsx)(r().Fragment,null,e)))};var x=o(559),g=o(23);const j={id:g.j,name:g.j,start:g.j,end:g.j,exitCode:g.j,userId:g.j,userName:g.j,groupId:g.j,groupName:g.j,workingDirectory:g.j,interactive:g.j,args:g.j,pid:g.j,entryMetaType:g.j,entryMetaSourceIp:g.j,executable:[[g.j]]},h=e=>{try{return e.map((e=>{const[t,o]=e;if(!t||!o||2!==e.length)throw new Error;return`${t} ${o}`})).join(", ")}catch(e){return""}},y=e=>e&&e.length&&e.map?`[${e.map((e=>`'${e}'`)).join(", ")}]`:g.j,b=e=>{var t,o,i,s,n,r,a,l,u,d,c,p,m,v,x,g,h,b,f,C,w,T,k;return{...e,id:null!==(t=null==e?void 0:e.entity_id)&&void 0!==t?t:j.id,name:null!==(o=null==e?void 0:e.name)&&void 0!==o?o:j.name,start:null!==(i=null==e?void 0:e.start)&&void 0!==i?i:j.start,end:null!==(s=null==e?void 0:e.end)&&void 0!==s?s:j.end,exitCode:null!==(n=null==e||null===(r=e.exit_code)||void 0===r?void 0:r.toString())&&void 0!==n?n:j.exitCode,interactive:null!=e&&e.interactive?"True":"False",userId:null!==(a=null==e||null===(l=e.user)||void 0===l?void 0:l.id)&&void 0!==a?a:j.userId,userName:null!==(u=null==e||null===(d=e.user)||void 0===d?void 0:d.name)&&void 0!==u?u:j.userName,groupId:null!==(c=null==e||null===(p=e.group)||void 0===p?void 0:p.id)&&void 0!==c?c:j.groupId,groupName:null!==(m=null==e||null===(v=e.group)||void 0===v?void 0:v.name)&&void 0!==m?m:j.groupName,workingDirectory:null!==(x=null==e?void 0:e.working_directory)&&void 0!==x?x:j.workingDirectory,args:null!==(g=y(null==e?void 0:e.args))&&void 0!==g?g:j.args,pid:null!==(h=null==e||null===(b=e.pid)||void 0===b?void 0:b.toString())&&void 0!==h?h:j.pid,executable:null!=e&&e.executable?[[null==e?void 0:e.executable]]:j.executable,entryMetaType:null!==(f=null==e||null===(C=e.entry_meta)||void 0===C?void 0:C.type)&&void 0!==f?f:j.entryMetaType,entryMetaSourceIp:null!==(w=null==e||null===(T=e.entry_meta)||void 0===T||null===(k=T.source)||void 0===k?void 0:k.ip)&&void 0!==w?w:j.entryMetaSourceIp}},f=[{id:"processEntryLeader",title:"Entry Leader",tooltipContent:l.i18n.translate("xpack.sessionView.detailPanel.entryLeaderTooltip",{defaultMessage:"Session leader process associated with initial terminal or remote access via SSH, SSM and other remote access protocols. Entry sessions are also used to represent a service directly started by the init process. In many cases this is the same as the session_leader."})},{id:"processSessionLeader",title:"Session Leader",tooltipContent:l.i18n.translate("xpack.sessionView.detailPanel.sessionLeaderTooltip",{defaultMessage:"Often the same as entry_leader. When it differs, this represents a session started within another session. Some tools like tmux and screen will start a new session to obtain a new tty and/or separate their lifecycle from the entry session."})},{id:"processGroupLeader",title:"Group Leader",tooltipContent:l.i18n.translate("xpack.sessionView.detailPanel.processGroupLeaderTooltip",{defaultMessage:"The process group leader to the current process."})},{id:"processParent",title:"Parent",tooltipContent:l.i18n.translate("xpack.sessionView.detailPanel.processParentTooltip",{defaultMessage:"The direct parent to the current process."})}],C="process",w=[`${C}.entry_leader`,`${C}.session_leader`,`${C}.group_leader`,`${C}.parent`],T=({selectedProcess:e,index:t})=>{const o=(()=>{const{euiTheme:e}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>({descriptionSemibold:{fontWeight:e.font.weight.medium},executableAction:{fontWeight:e.font.weight.bold,paddingLeft:e.size.xs},ellipsis:{overflow:"hidden",textOverflow:"ellipsis"}})),[e])})(),s=(0,n.useMemo)((()=>((e,t)=>{var o,s,n,r,a,l,u,d,c,p,m,v,g,h,f,C,w,T,k,_,I;const $={id:j.id,start:j.start,end:j.end,exitCode:j.exitCode,interactive:j.interactive,userId:j.userId,userName:j.userName,groupName:j.groupName,args:j.args,pid:j.pid,executable:j.executable,workingDirectory:j.workingDirectory,entryLeader:j,sessionLeader:j,groupLeader:j,parent:j};if(!e)return $;const S=e.getDetails();$.id=`${(0,x.I)(e.id)}`,$.start=`${(0,x.I)(null===(o=S.process)||void 0===o?void 0:o.start)}`,$.end=`${(0,x.I)(e.getEndTime())}`,$.exitCode=`${(0,x.I)(null===(s=S.process)||void 0===s?void 0:s.exit_code)}`,$.interactive=null!==(n=S.process)&&void 0!==n&&n.interactive?"True":"False",$.userId=`${(0,x.I)(null===(r=S.process)||void 0===r||null===(a=r.user)||void 0===a?void 0:a.id)}`,$.userName=`${(0,x.I)(null===(l=S.process)||void 0===l||null===(u=l.user)||void 0===u?void 0:u.name)}`,$.groupId=`${(0,x.I)(null===(d=S.process)||void 0===d||null===(c=d.group)||void 0===c?void 0:c.id)}`,$.groupName=`${(0,x.I)(null===(p=S.process)||void 0===p||null===(m=p.group)||void 0===m?void 0:m.name)}`,$.pid=`${(0,x.I)(null===(v=S.process)||void 0===v?void 0:v.pid)}`,$.workingDirectory=`${(0,x.I)(null===(g=S.process)||void 0===g?void 0:g.working_directory)}`,null!==(h=S.process)&&void 0!==h&&h.args&&($.args=y(S.process.args));const E=(null===(f=S.process)||void 0===f||null===(C=f.previous)||void 0===C?void 0:C.map((e=>(null==e?void 0:e.executable)||"")))||[];return null!==(w=S.process)&&void 0!==w&&w.executable&&E.push(S.process.executable),$.executable=E.map(((e,o)=>{const s=t===i.Vn?"executed":"exec";return[e,`(${0===o?"fork":s})`]})),$.entryLeader=b(null==S||null===(T=S.process)||void 0===T?void 0:T.entry_leader),$.sessionLeader=b(null==S||null===(k=S.process)||void 0===k?void 0:k.session_leader),$.groupLeader=b(null==S||null===(_=S.process)||void 0===_?void 0:_.group_leader),$.parent=b(null==S||null===(I=S.process)||void 0===I?void 0:I.parent),$})(e,t)),[e,t]),l=(0,n.useCallback)((e=>e.map(((e,t)=>{const[i,s]=e;return(0,u.jsx)("div",{key:`executable-${t}`,css:o.ellipsis},(0,u.jsx)(a.EuiTextColor,{color:"default",css:o.descriptionSemibold},i),s&&(0,u.jsx)(a.EuiTextColor,{color:"default",css:o.executableAction},s))}))),[o.descriptionSemibold,o.ellipsis,o.executableAction]),p=[s.entryLeader,s.sessionLeader,s.groupLeader,s.parent].map(((e,t)=>{const{id:o,start:i,end:s,exitCode:n,entryMetaType:r,interactive:a,workingDirectory:d,args:c,executable:p,pid:g,userId:j,userName:y,groupId:b,groupName:C,entryMetaSourceIp:T}=e,k=h(p),_=[{title:(0,u.jsx)(m,null,"entity_id"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.entity_id: "${o}"`,tooltipContent:o},o)},{title:(0,u.jsx)(m,null,"args"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.args: "${c}"`,tooltipContent:c},c)},{title:(0,u.jsx)(m,null,"executable"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.executable: "${k}"`,tooltipContent:k},l(p))},{title:(0,u.jsx)(m,null,"interactive"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.interactive: "${a}"`,tooltipContent:a},a)},{title:(0,u.jsx)(m,null,"working_directory"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.working_directory: "${d}"`,tooltipContent:d},d)},{title:(0,u.jsx)(m,null,"pid"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.pid: "${g}"`,tooltipContent:g},g)},{title:(0,u.jsx)(m,null,"start"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.start: "${i}"`,tooltipContent:i},i)},{title:(0,u.jsx)(m,null,"end"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.end: "${s}"`,tooltipContent:s},s)},{title:(0,u.jsx)(m,null,"exit_code"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.exit_code: "${n}"`,tooltipContent:n},n)},{title:(0,u.jsx)(m,null,"user.id"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.user.id: "${j}"`,tooltipContent:j},j)},{title:(0,u.jsx)(m,null,"user.name"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.user.name: "${y}"`,tooltipContent:y},y)},{title:(0,u.jsx)(m,null,"group.id"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.group.id: "${b}"`,tooltipContent:b},b)},{title:(0,u.jsx)(m,null,"group.name"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.group.name: "${C}"`,tooltipContent:C},C)}];return 0===t&&_.push({title:(0,u.jsx)(m,null,"entry_meta.type"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.entry_meta.type: "${r}"`,tooltipContent:r},r)},{title:(0,u.jsx)(m,null,"entry_meta.source.ip"),description:(0,u.jsx)(v,{textToCopy:`${w[t]}.entry_meta.source.ip: "${T}"`,tooltipContent:T},(0,x.I)(T))}),{...f[t],name:e.name,listItems:_}})),{id:g,start:T,end:k,executable:_,exitCode:I,pid:$,workingDirectory:S,interactive:E,userId:P,userName:M,groupId:A,groupName:V,args:D}=s,O=h(_);return(0,u.jsx)(r().Fragment,null,(0,u.jsx)(d,{listItems:[{title:(0,u.jsx)(m,null,"entity_id"),description:(0,u.jsx)(v,{textToCopy:`${C}.entity_id: "${g}"`,tooltipContent:g},g)},{title:(0,u.jsx)(m,null,"args"),description:(0,u.jsx)(v,{textToCopy:`${C}.args: "${D}"`,tooltipContent:D},D)},{title:(0,u.jsx)(m,null,"executable"),description:(0,u.jsx)(v,{textToCopy:`${C}.executable: "${O}"`,tooltipContent:O,display:"block"},l(_))},{title:(0,u.jsx)(m,null,"interactive"),description:(0,u.jsx)(v,{textToCopy:`${C}.interactive: "${E}"`,tooltipContent:E},E)},{title:(0,u.jsx)(m,null,"working_directory"),description:(0,u.jsx)(v,{textToCopy:`${C}.working_directory: "${S}"`,tooltipContent:S},S)},{title:(0,u.jsx)(m,null,"pid"),description:(0,u.jsx)(v,{textToCopy:`${C}.pid: "${$}"`,tooltipContent:$},$)},{title:(0,u.jsx)(m,null,"start"),description:(0,u.jsx)(v,{textToCopy:`${C}.start: "${T}"`,tooltipContent:T},T)},{title:(0,u.jsx)(m,null,"end"),description:(0,u.jsx)(v,{textToCopy:`${C}.end: "${k}"`,tooltipContent:k},k)},{title:(0,u.jsx)(m,null,"exit_code"),description:(0,u.jsx)(v,{textToCopy:`${C}.exit_code: "${I}"`,tooltipContent:I},I)},{title:(0,u.jsx)(m,null,"user.id"),description:(0,u.jsx)(v,{textToCopy:`${C}.user.id: "${P}"`,tooltipContent:P},P)},{title:(0,u.jsx)(m,null,"user.name"),description:(0,u.jsx)(v,{textToCopy:`${C}.user.name: "${M}"`,tooltipContent:M},M)},{title:(0,u.jsx)(m,null,"group.id"),description:(0,u.jsx)(v,{textToCopy:`${C}.group.id: "${A}"`,tooltipContent:A},A)},{title:(0,u.jsx)(m,null,"group.name"),description:(0,u.jsx)(v,{textToCopy:`${C}.group.name: "${V}"`,tooltipContent:V},V)}]}),p.map((e=>(0,u.jsx)(c,{key:e.id,id:e.id,title:e.title,tooltipContent:e.tooltipContent,listItems:e.listItems,extraActionTitle:e.name}))))},k=({processHost:e,processContainer:t,processOrchestrator:o,processCloud:i})=>{const s=(()=>{const{euiTheme:e}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>({metadataHostOS:{margin:`${e.size.m} ${e.size.base} ${e.size.base} ${e.size.base}`,paddingBottom:e.size.base}})),[e])})(),d=(0,n.useMemo)((()=>(e=>{var t,o,i,s,n,r,a,l,u,d,c,p;const m={architecture:g.j,hostname:g.j,id:g.j,ip:g.j,mac:g.j,name:g.j,os:{family:g.j,full:g.j,kernel:g.j,name:g.j,platform:g.j,version:g.j}};return e?(m.hostname=(0,x.I)(e.hostname).toString(),m.id=(0,x.I)(e.id).toString(),m.ip=null!==(t=null===(o=e.ip)||void 0===o||null===(i=o.map)||void 0===i?void 0:i.call(o,(e=>(0,x.I)(e))).join(", "))&&void 0!==t?t:g.j,m.mac=null!==(s=null===(n=e.mac)||void 0===n||null===(r=n.map)||void 0===r?void 0:r.call(n,(e=>(0,x.I)(e))).join(", "))&&void 0!==s?s:g.j,m.name=(0,x.I)(e.name).toString(),m.architecture=(0,x.I)(e.architecture).toString(),m.os.family=(0,x.I)(null===(a=e.os)||void 0===a?void 0:a.family).toString(),m.os.full=(0,x.I)(null===(l=e.os)||void 0===l?void 0:l.full).toString(),m.os.kernel=(0,x.I)(null===(u=e.os)||void 0===u?void 0:u.kernel).toString(),m.os.name=(0,x.I)(null===(d=e.os)||void 0===d?void 0:d.name).toString(),m.os.platform=(0,x.I)(null===(c=e.os)||void 0===c?void 0:c.platform).toString(),m.os.version=(0,x.I)(null===(p=e.os)||void 0===p?void 0:p.version).toString(),m):m})(e)),[e]),p=(0,n.useMemo)((()=>(e=>{var t,o,i,s;const n={id:g.j,name:g.j,image:{name:g.j,tag:g.j,hash:{all:g.j}}};return e?(n.id=(0,x.I)(e.id).toString(),n.name=(0,x.I)(e.name).toString(),n.image.name=(0,x.I)(null==e||null===(t=e.image)||void 0===t?void 0:t.name).toString(),n.image.tag=(0,x.I)(null==e||null===(o=e.image)||void 0===o?void 0:o.tag).toString(),n.image.hash.all=(0,x.I)(null==e||null===(i=e.image)||void 0===i||null===(s=i.hash)||void 0===s?void 0:s.all).toString(),n):n})(t)),[t]),j=(0,n.useMemo)((()=>(e=>{var t,o,i,s,n,r,a;const l={resource:{name:g.j,type:g.j,ip:g.j,parent:{type:g.j}},namespace:g.j,cluster:{name:g.j,id:g.j}};return e?(l.resource.name=(0,x.I)(null==e||null===(t=e.resource)||void 0===t?void 0:t.name).toString(),l.resource.type=(0,x.I)(null==e||null===(o=e.resource)||void 0===o?void 0:o.type).toString(),l.resource.ip=(0,x.I)(null==e||null===(i=e.resource)||void 0===i?void 0:i.ip).toString(),l.namespace=(0,x.I)(null==e?void 0:e.namespace).toString(),l.cluster.name=(0,x.I)(null==e||null===(s=e.cluster)||void 0===s?void 0:s.name).toString(),l.cluster.id=(0,x.I)(null==e||null===(n=e.cluster)||void 0===n?void 0:n.id).toString(),l.resource.parent.type=(0,x.I)(null==e||null===(r=e.resource)||void 0===r||null===(a=r.parent)||void 0===a?void 0:a.type).toString(),l):l})(o)),[o]),h=(0,n.useMemo)((()=>(e=>{var t,o,i,s;const n={instance:{name:g.j},account:{id:g.j},project:{id:g.j,name:g.j},provider:g.j,region:g.j};return e?(n.instance.name=(0,x.I)(null==e||null===(t=e.instance)||void 0===t?void 0:t.name).toString(),n.account.id=(0,x.I)(null==e||null===(o=e.account)||void 0===o?void 0:o.id).toString(),n.project.id=(0,x.I)(null==e||null===(i=e.project)||void 0===i?void 0:i.id).toString(),n.project.name=(0,x.I)(null==e||null===(s=e.project)||void 0===s?void 0:s.name).toString(),n.provider=(0,x.I)(null==e?void 0:e.provider).toString(),n.region=(0,x.I)(null==e?void 0:e.region).toString(),n):n})(i)),[i]);return(0,u.jsx)(r().Fragment,null,(0,u.jsx)(c,{id:"metadataHost",title:l.i18n.translate("xpack.sessionView.metadataDetailsTab.metadataHost",{defaultMessage:"Host"}),initialIsOpen:!0,listItems:[{title:(0,u.jsx)(m,null,"id"),description:(0,u.jsx)(v,{textToCopy:`host.id: "${d.id}"`,tooltipContent:d.id},d.id)},{title:(0,u.jsx)(m,null,"hostname"),description:(0,u.jsx)(v,{textToCopy:`host.hostname: "${d.hostname}"`,tooltipContent:d.hostname},d.hostname)},{title:(0,u.jsx)(m,null,"ip"),description:(0,u.jsx)(v,{textToCopy:`host.ip: "${d.ip}"`,tooltipContent:d.ip},d.ip)},{title:(0,u.jsx)(m,null,"mac"),description:(0,u.jsx)(v,{textToCopy:`host.mac: "${d.mac}"`,tooltipContent:d.mac},d.mac)},{title:(0,u.jsx)(m,null,"name"),description:(0,u.jsx)(v,{textToCopy:`host.name: "${d.name}"`,tooltipContent:d.name},d.name)}]},(0,u.jsx)(a.EuiPanel,{hasShadow:!1,color:"plain",hasBorder:!1,borderRadius:"m",paddingSize:"none",css:s.metadataHostOS},(0,u.jsx)(c,{id:"hostOS",title:l.i18n.translate("xpack.sessionView.metadataDetailsTab.host",{defaultMessage:"OS"}),listItems:[{title:(0,u.jsx)(m,null,"architecture"),description:(0,u.jsx)(v,{textToCopy:`host.architecture: "${d.architecture}"`,tooltipContent:d.architecture},d.architecture)},{title:(0,u.jsx)(m,null,"os.family"),description:(0,u.jsx)(v,{textToCopy:`host.os.family: "${d.os.family}"`,tooltipContent:d.os.family},d.os.family)},{title:(0,u.jsx)(m,null,"os.full"),description:(0,u.jsx)(v,{textToCopy:`host.os.full: "${d.os.full}"`,tooltipContent:d.os.full},d.os.full)},{title:(0,u.jsx)(m,null,"os.kernel"),description:(0,u.jsx)(v,{textToCopy:`host.os.kernel: "${d.os.kernel}"`,tooltipContent:d.os.kernel},d.os.kernel)},{title:(0,u.jsx)(m,null,"os.name"),description:(0,u.jsx)(v,{textToCopy:`host.os.name: "${d.os.name}"`,tooltipContent:d.os.name},d.os.name)},{title:(0,u.jsx)(m,null,"os.platform"),description:(0,u.jsx)(v,{textToCopy:`host.os.platform: "${d.os.platform}"`,tooltipContent:d.os.platform},d.os.platform)},{title:(0,u.jsx)(m,null,"os.version"),description:(0,u.jsx)(v,{textToCopy:`host.os.version: "${d.os.version}"`,tooltipContent:d.os.version},d.os.version)}]}))),i&&(0,u.jsx)(r().Fragment,null,(0,u.jsx)(c,{id:"metadataCloud",title:l.i18n.translate("xpack.sessionView.metadataDetailsTab.cloud",{defaultMessage:"Cloud"}),listItems:[{title:(0,u.jsx)(m,null,"instance.name"),description:(0,u.jsx)(v,{textToCopy:`cloud.provider: "${h.instance.name}"`,tooltipContent:h.instance.name},h.instance.name)},{title:(0,u.jsx)(m,null,"provider"),description:(0,u.jsx)(v,{textToCopy:`cloud.provider: "${h.provider}"`,tooltipContent:h.provider},h.provider)},{title:(0,u.jsx)(m,null,"region"),description:(0,u.jsx)(v,{textToCopy:`cloud.region: "${h.region}"`,tooltipContent:h.region},h.region)},{title:(0,u.jsx)(m,null,"account.id"),description:(0,u.jsx)(v,{textToCopy:`cloud.account.id: "${h.account.id}"`,tooltipContent:h.account.id},h.account.id)},{title:(0,u.jsx)(m,null,"project.id"),description:(0,u.jsx)(v,{textToCopy:`cloud.project.id: "${h.project.id}"`,tooltipContent:h.project.id},h.project.id)},{title:(0,u.jsx)(m,null,"project.name"),description:(0,u.jsx)(v,{textToCopy:`cloud.project.name: "${h.project.name}"`,tooltipContent:h.project.name},h.project.name)}]})),t&&(0,u.jsx)(r().Fragment,null,(0,u.jsx)(c,{id:"metadataContainer",title:l.i18n.translate("xpack.sessionView.metadataDetailsTab.container",{defaultMessage:"Container"}),listItems:[{title:(0,u.jsx)(m,null,"id"),description:(0,u.jsx)(v,{textToCopy:`container.id: "${p.id}"`,tooltipContent:p.id},p.id)},{title:(0,u.jsx)(m,null,"name"),description:(0,u.jsx)(v,{textToCopy:`container.name: "${p.name}"`,tooltipContent:p.name},p.name)},{title:(0,u.jsx)(m,null,"image.name"),description:(0,u.jsx)(v,{textToCopy:`container.image.name: "${p.image.name}"`,tooltipContent:p.image.name},p.image.name)},{title:(0,u.jsx)(m,null,"image.tag"),description:(0,u.jsx)(v,{textToCopy:`container.image.tag: "${p.image.tag}"`,tooltipContent:p.image.tag},p.image.tag)},{title:(0,u.jsx)(m,null,"image.hash.all"),description:(0,u.jsx)(v,{textToCopy:`container.image.hash.all: "${p.image.hash.all}"`,tooltipContent:p.image.hash.all},p.image.hash.all)}]})),o&&(0,u.jsx)(r().Fragment,null,(0,u.jsx)(c,{id:"metadataOrchestrator",title:l.i18n.translate("xpack.sessionView.metadataDetailsTab.orchestrator",{defaultMessage:"Orchestrator"}),listItems:[{title:(0,u.jsx)(m,null,"resource.ip"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.resource.ip: "${j.resource.ip}"`,tooltipContent:j.resource.ip},j.resource.ip)},{title:(0,u.jsx)(m,null,"resource.name"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.resource.name: "${j.resource.name}"`,tooltipContent:j.resource.name},j.resource.name)},{title:(0,u.jsx)(m,null,"resource.type"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.resource.type: "${j.resource.type}"`,tooltipContent:j.resource.type},j.resource.type)},{title:(0,u.jsx)(m,null,"resource.parent.type"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.resource.parent.type: "${j.resource.parent.type}"`,tooltipContent:j.resource.parent.type},j.resource.parent.type)},{title:(0,u.jsx)(m,null,"namespace"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.namespace: "${j.namespace}"`,tooltipContent:j.namespace},j.namespace)},{title:(0,u.jsx)(m,null,"cluster.id"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.cluster.id: "${j.cluster.id}"`,tooltipContent:j.cluster.id},j.cluster.id)},{title:(0,u.jsx)(m,null,"cluster.name"),description:(0,u.jsx)(v,{textToCopy:`orchestrator.cluster.name: "${j.cluster.name}"`,tooltipContent:j.cluster.name},j.cluster.name)}]})))};var _=o(879),I=o(770),$=o(716);const S=(e=!1,t=!1)=>{const{euiTheme:o}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>{const{colors:i,font:s,size:n,border:r}=o,l=(0,a.transparentize)(i.danger,.2),d=(0,a.transparentize)(i.danger,.08),c=r.width.thin,p=n.m;let m=i.text,v=i.lightShade;t&&(m=i.primaryText,v=l);const x=(0,u.css)("border:",c," solid ",v,";padding:",p,";border-radius:",r.radius.medium,";margin:0 ",p," ",p," ",p,";background-color:",i.emptyShade,";& .euiAccordion__buttonContent{width:100%;}& .euiAccordion__button{min-width:0;width:calc(100% - ",n.l,");}& .euiAccordion__childWrapper{overflow:visible;}","");return{alertItem:x,alertGroupItem:(0,u.css)(x," & .euiAccordion__childWrapper{overflow:hidden;}",""),alertTitleContainer:{display:e?"none":"initial",color:m,fontWeight:s.weight.semiBold},alertTitle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},alertIcon:{marginRight:n.s},alertAccordionButton:{width:`calc(100% - ${n.l})`,minWidth:0},alertCountArrowPad:{marginRight:n.xs},processPanel:{border:`${c} solid ${i.lightShade}`,fontFamily:s.familyCode,marginTop:e?n.s:n.m,padding:`${n.xs} ${n.s}`},investigatedLabel:{position:"relative",zIndex:1,bottom:`-${p}`,left:`-${p}`,width:`calc(100% + ${p} * 2)`,borderTop:`${c} solid ${l}`,borderBottomLeftRadius:r.radius.medium,borderBottomRightRadius:r.radius.medium,backgroundColor:d,textAlign:"center"},minimalContextMenu:{float:"right"},firstAlertPad:{"&:first-child":{paddingTop:n.base}},minimalHR:{marginBottom:0}}}),[o,t,e])},E=({event:e,onShowAlertDetails:t,onJumpToEvent:o})=>{var i,s,r;const[d,c]=(0,n.useState)(!1),p=(0,n.useCallback)((()=>{c(!1)}),[]),m=(0,n.useCallback)((()=>{c(!d)}),[d]),v=(0,n.useCallback)((()=>{o(e),c(!1)}),[e,o]),x=(0,n.useCallback)((()=>{var o,i;null!==(o=e.kibana)&&void 0!==o&&null!==(i=o.alert)&&void 0!==i&&i.uuid&&(t(e.kibana.alert.uuid),c(!1))}),[e,t]);if(!e.kibana)return null;const g=null!==(i=null===(s=e.kibana)||void 0===s||null===(r=s.alert)||void 0===r?void 0:r.uuid)&&void 0!==i?i:"",j=[(0,u.jsx)(a.EuiContextMenuItem,{key:"details","data-test-subj":"sessionView:detailPanelAlertActionShowDetails",onClick:x},(0,u.jsx)(_.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.showDetailsAction",defaultMessage:"View alert details"})),(0,u.jsx)(a.EuiContextMenuItem,{key:"jumpTo","data-test-subj":"sessionView:detailPanelAlertActionJumpToProcess",onClick:v},(0,u.jsx)(_.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.jumpToAlert",defaultMessage:"Jump to alerted process"}))];return(0,u.jsx)(a.EuiPopover,{id:g,button:(0,u.jsx)(a.EuiButtonIcon,{display:"empty",size:"s",iconType:"boxesHorizontal","aria-label":l.i18n.translate("xpack.sessionView.detailPanelAlertListItem.moreButton",{defaultMessage:"More"}),"data-test-subj":"sessionView:detailPanelAlertActionsBtn",onClick:m}),isOpen:d,closePopover:p,panelPaddingSize:"none",anchorPosition:"leftCenter"},(0,u.jsx)(a.EuiContextMenuPanel,{size:"s",items:j}))};var P=o(678),M=o(392);const A="sessionView:detailPanelAlertListItem",V="sessionView:detailPanelAlertListItemArgs",D=({event:e,onJumpToEvent:t,onShowAlertDetails:o,isInvestigated:i,minimal:n})=>{var r,l,d,c;const p=S(n,i),m=(0,P.N)();if(!e.kibana)return null;const v=(0,a.formatDate)(e["@timestamp"],m),g=null===(r=e.kibana)||void 0===r||null===(l=r.alert)||void 0===l?void 0:l.rule,j=(null==g?void 0:g.uuid)||"",h=(null==g?void 0:g.name)||"",{args:y,name:b}=null!==(d=e.process)&&void 0!==d?d:{},{event:f}=e,C=i?void 0:"open",w=Array.isArray(null==f?void 0:f.category)?null==f||null===(c=f.category)||void 0===c?void 0:c[0]:null==f?void 0:f.category,T=null!=w?w:"process",k="process"!==w?`${(0,x.I)(b)} ${(0,M.c)(e,w)}`:(0,x.I)(null==y?void 0:y.join(" ")),I=(0,$.U)(T);return n?(0,u.jsx)("div",{"data-test-subj":A,css:p.firstAlertPad},(0,u.jsx)(a.EuiSpacer,{size:"xs"}),(0,u.jsx)(a.EuiFlexGroup,{alignItems:"center"},(0,u.jsx)(a.EuiFlexItem,null,(0,u.jsx)(a.EuiText,{color:"subdued",size:"s"},(0,x.I)(v))),(0,u.jsx)(a.EuiFlexItem,{grow:!1},(0,u.jsx)(E,{css:p.minimalContextMenu,event:e,onJumpToEvent:t,onShowAlertDetails:o}))),(0,u.jsx)(a.EuiPanel,{css:p.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},(0,u.jsx)(a.EuiText,{"data-test-subj":V,size:"xs"},k)),(0,u.jsx)(a.EuiHorizontalRule,{css:p.minimalHR,margin:"m",size:"full"})):(0,u.jsx)(a.EuiAccordion,{id:j,"data-test-subj":A,arrowDisplay:i?"right":"none",buttonContent:(0,u.jsx)(a.EuiText,{css:p.alertTitleContainer,size:"s"},(0,u.jsx)("p",{css:p.alertTitle},(0,u.jsx)(a.EuiIconTip,{position:"top",content:I,type:s.OU[T],color:"danger",css:p.alertIcon}),(0,x.I)(h))),initialIsOpen:!0,forceState:C,css:p.alertItem,extraAction:(0,u.jsx)(E,{event:e,onJumpToEvent:t,onShowAlertDetails:o})},(0,u.jsx)(a.EuiSpacer,{size:"xs"}),(0,u.jsx)(a.EuiText,{"data-test-subj":"sessionView:detailPanelAlertListItemTimestamp",color:"subdued",size:"s"},(0,x.I)(v)),(0,u.jsx)(a.EuiPanel,{css:p.processPanel,color:"subdued",hasBorder:!0,hasShadow:!1,borderRadius:"m"},(0,u.jsx)(a.EuiText,{"data-test-subj":V,size:"xs"},k)),i&&(0,u.jsx)("div",{css:p.investigatedLabel},(0,u.jsx)(a.EuiText,{size:"xs",color:"danger"},(0,u.jsx)(_.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertListItem.investigatedLabel",defaultMessage:"Investigated alert"}))))},O=({alerts:e,onJumpToEvent:t,onShowAlertDetails:o})=>{var i,s,n,r;const l=S(),d=e.length.toLocaleString();if(!e[0].kibana)return null;const{rule:c}=null!==(i=null===(s=e[0])||void 0===s||null===(n=s.kibana)||void 0===n?void 0:n.alert)&&void 0!==i?i:{};return(0,u.jsx)(a.EuiAccordion,{id:null!==(r=null==c?void 0:c.uuid)&&void 0!==r?r:"","data-test-subj":"sessionView:detailPanelAlertGroupItem",arrowDisplay:"right",initialIsOpen:!1,buttonContent:(0,u.jsx)(a.EuiText,{"data-test-subj":"sessionView:detailPanelAlertGroupTitle",css:l.alertTitleContainer,size:"s"},(0,u.jsx)("p",{css:l.alertTitle},(0,u.jsx)(a.EuiIcon,{color:"danger",type:"warning",css:l.alertIcon}),(0,x.I)(null==c?void 0:c.name))),css:l.alertGroupItem,extraAction:(0,u.jsx)(a.EuiNotificationBadge,{"data-test-subj":"sessionView:detailPanelAlertGroupCount",className:"eui-alignCenter",size:"m",css:l.alertCountArrowPad},d)},e.map((e=>{var i,s;const n="minimal_"+(null===(i=e.kibana)||void 0===i||null===(s=i.alert)||void 0===s?void 0:s.uuid);return(0,u.jsx)(D,{key:n,minimal:!0,event:e,onJumpToEvent:t,onShowAlertDetails:o})})))},L="listView",z=({alerts:e,isFetchingAlerts:t,hasNextPageAlerts:o,fetchNextPageAlerts:i,onJumpToEvent:s,onShowAlertDetails:r,investigatedAlertId:d})=>{const c=(()=>{const{euiTheme:e}=(0,a.useEuiTheme)();return(0,n.useMemo)((()=>{const{colors:t,size:o}=e;return{container:{position:"relative",margin:o.base},stickyItem:{position:"sticky",top:0,zIndex:1,backgroundColor:t.emptyShade},loadMoreBtn:{margin:o.m,width:`calc(100% - ${o.m} * 2)`}}}),[e])})(),[p,m]=(0,n.useState)(L),v=[{id:L,label:l.i18n.translate("xpack.sessionView.alertDetailsTab.listView",{defaultMessage:"List view"})},{id:"groupView",label:l.i18n.translate("xpack.sessionView.alertDetailsTab.groupView",{defaultMessage:"Group view"})}],x=(0,n.useMemo)((()=>d&&e.find((e=>{var t,o;return(null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o?void 0:o.uuid)===d}))),[d,e]),g=(0,n.useMemo)((()=>(0,I.groupBy)(e,(e=>{var t,o,i;return null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o||null===(i=o.rule)||void 0===i?void 0:i.uuid}))),[e]);return 0===e.length?(0,u.jsx)(a.EuiEmptyPrompt,{"data-test-subj":"sessionView:detailPanelAlertsEmptyState",title:(0,u.jsx)("h2",null,(0,u.jsx)(_.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyTitle",defaultMessage:"No alerts"})),body:(0,u.jsx)("p",null,(0,u.jsx)(_.FormattedMessage,{id:"xpack.sessionView.detailPanelAlertsEmptyMsg",defaultMessage:"No alerts were created for this session."}))}):(0,u.jsx)("div",{css:c.container},(0,u.jsx)(a.EuiButtonGroup,{"data-test-subj":"sessionView:detailPanelAlertsViewMode",legend:l.i18n.translate("xpack.sessionView.alertDetailsTab.toggleViewMode",{defaultMessage:"Toggle view mode"}),options:v,idSelected:p,onChange:m,buttonSize:"compressed",isFullWidth:!0}),x&&(0,u.jsx)("div",{css:c.stickyItem,"data-test-subj":"sessionView:detailPanelInvestigatedAlert"},(0,u.jsx)(D,{event:x,onJumpToEvent:s,onShowAlertDetails:r,isInvestigated:!0}),(0,u.jsx)(a.EuiHorizontalRule,{margin:"m",size:"full"})),p===L?e.map((e=>{var t,o;const i=null===(t=e.kibana)||void 0===t||null===(o=t.alert)||void 0===o?void 0:o.uuid;if(i&&e!==x)return(0,u.jsx)(D,{key:i,event:e,onJumpToEvent:s,onShowAlertDetails:r})})):Object.keys(g).map((e=>{var t,o,i;const n=g[e],a=null===(t=n[0].kibana)||void 0===t||null===(o=t.alert)||void 0===o||null===(i=o.rule)||void 0===i?void 0:i.uuid;if(a)return(0,u.jsx)(O,{key:a,alerts:n,onJumpToEvent:s,onShowAlertDetails:r})})),o&&(0,u.jsx)(a.EuiButton,{color:"primary",isLoading:t,onClick:i,css:c.loadMoreBtn,"data-test-subj":"alerts-details-load-more"},(0,u.jsx)(_.FormattedMessage,{id:"xpack.sessionView.alertsLoadMoreButton",defaultMessage:"Load more alerts"})))};var N=o(616);function B(){return new SessionViewPlugin}},380:(e,t,o)=>{"use strict";o.d(t,{fK:()=>m,Vn:()=>j,EG:()=>p,fS:()=>g,q7:()=>y});var i=o(185),s=o(286),n=o(319),r=o(530);const a=__kbnSharedDeps__.KbnAnalytics;var l=o(787),u=o(791);const d=new r.QueryClient,c=(0,s.lazy)((()=>o.e(675).then(o.bind(o,675)))),p="endpoint",m="auditbeat",v=new RegExp(`([a-z0-9_-]+:)?[a-z0-9-.]*(${[p,m].join("|")})`,"i"),x="logs-*",g="logs-endpoint.events.process*",j="auditbeat-*",h={endpoint:g,auditbeat:j},y=e=>{const t=(e=>{if(!e)return x;const t=e.match(v),o=null==t?void 0:t[1],i=o?`${o}`:"",s=null==t?void 0:t[2];return i+(s?h[s]:x)})(e.index);return(0,u.jsx)(r.QueryClientProvider,{client:d},(0,u.jsx)(s.Suspense,{fallback:(0,u.jsx)(n.EuiLoadingSpinner,null)},(0,u.jsx)(c,(0,i.default)({},e,{index:t,trackEvent:t=>{e.usageCollection&&e.usageCollection.reportUiCounter(l.x2,a.METRIC_TYPE.CLICK,t)}}))))}},392:(e,t,o)=>{"use strict";o.d(t,{c:()=>s});var i=o(559);const s=(e,t)=>{var o;const s=null==e?void 0:e.destination,r=null==e||null===(o=e.file)||void 0===o?void 0:o.path;return r&&"file"===t?(0,i.I)(r):null!=s&&s.address&&"network"===t?(0,i.I)(n(s)):""},n=e=>{const t=!(null==e||!e.address||null==e||!e.port),o=`${null==e?void 0:e.address}:${null==e?void 0:e.port}`;return`${t?o:null==e?void 0:e.address}`}},559:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i=o(23);const s=e=>void 0===e||""===e||"number"==typeof e&&isNaN(e)?i.j:e},326:(e,t,o)=>{o.p=window.__kbnPublicPath__.sessionView},744:(e,t,o)=>{o.r(t);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},409:(e,t,o)=>{o.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},185:(e,t,o)=>{e.exports=o(497)(51858)},319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},8:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},64:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useLocalStorage},472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={id:e,exports:{}};return o[e](n,n.exports,s),n.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,o)=>(s.f[o](e,t),t)),[])),s.u=e=>"sessionView.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="@kbn/session-view-plugin:",s.l=(o,i,n,r)=>{if(e[o])e[o].push(i);else{var a,l;if(void 0!==n)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var c=u[d];if(c.getAttribute("src")==o||c.getAttribute("data-webpack")==t+n){a=c;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",t+n),a.src=o),e[o]=[i];var p=(t,i)=>{a.onerror=a.onload=null,clearTimeout(m);var s=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((e=>e(i))),t)return t(i)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var i=o.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=o[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={86:0};s.f.j=(t,o)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var n=new Promise(((o,s)=>i=e[t]=[o,s]));o.push(i[2]=n);var r=s.p+s.u(t),a=new Error;s.l(r,(o=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var n=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",a.name="ChunkLoadError",a.type=n,a.request=r,i[1](a)}}),"chunk-"+t,t)}};var t=(t,o)=>{var i,n,[r,a,l]=o,u=0;if(r.some((t=>0!==e[t]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);l&&l(s)}for(t&&t(o);u<r.length;u++)n=r[u],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0},o=self.sessionView_bundle_jsonpfunction=self.sessionView_bundle_jsonpfunction||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),s.nc=void 0,s(326),__kbnBundles__.define("plugin/sessionView/public",s,277)})();