(()=>{var e,t={67:(e,t,r)=>{"use strict";r.r(t),r.d(t,{plugin:()=>C});var s=r(219),n=r(494),a=r(107),i=r(619),o=r(783),l=r.n(o),c=r(500),u=r(904),p=r(627),d=r(8),b=r(770);function _(e,t,r,s,n,i,o){const l=-1===t.accessor?"_all":s[t.accessor],c=s[i.accessor],u=o&&s[o.accessor],p={x:l,y:c,z:u,extraMetrics:[],seriesRaw:r&&{table:e,column:r[0].column,row:n,value:s[r[0].accessor]},xRaw:{table:e,column:t.column,row:n,value:l},yRaw:{table:e,column:i.column,row:n,value:c},zRaw:o&&{table:e,column:o.column,row:n,value:u},tableRaw:e.$parent&&{table:e.$parent.table,column:e.$parent.column,row:e.$parent.row,value:e.$parent.formattedKey,title:e.$parent.name},parent:r?r[0]:null};if("NaN"!==p.y)return r?p.series=r.map((e=>(0,a.tz)().deserialize(e.format).convert(s[e.accessor]))).join(" - "):i&&(p.series=i.title),p}function m(e,t,r,s,n,a,i){var o,l;r=null==r?"":r+"",e.has(r)?e.get(r).values.push(t):e.set(r,{id:(o=r,null!==(l=(null!=o?o:"").split("-").pop())&&void 0!==l?l:""),rawId:r,label:null==s?r:s,count:0,values:[t],format:n,zLabel:i,zFormat:a})}function f(e,t){const r={};return Object.keys(t).forEach((s=>{const n=t[s];(Array.isArray(n)?n:[n]).forEach((t=>{if(!t)return;const n=e.columns[t.accessor];n&&(r[s]||(r[s]=[]),r[s].push({accessor:n.id,column:t.accessor,title:n.name,format:t.format,params:t.params}))}))})),r.x||(r.x=[{accessor:-1,title:d.i18n.translate("visTypeVislib.aggResponse.allDocsTitle",{defaultMessage:"All docs"}),params:{defaultValue:"_all"},format:{}}]),r}function g(e,t){const r=e.tables;if(!r||!r.length)return;const s=r[0];if(s.columns){const r=t(s);return e.$parent&&(r.label=e.title),r}const n={};let a;return r.forEach((function(r){if(!a){const t="row"===e.direction?"rows":"columns";a=n[t]=[]}let s;(s=g(r,t))&&a.push(s)})),n}const v=(h=(e,t)=>{const r={aspects:f(e,t)};return function(e,t){const{format:r,title:s,params:n,accessor:a}=e.aspects.x[0];if(e.xAxisOrderedValues=-1===a&&"defaultValue"in n?[n.defaultValue]:(0,b.uniq)(t.rows.map((e=>e[a]))),e.xAxisFormat=r,e.xAxisLabel=s,"interval"in n)if("date"in n){const{intervalESUnit:t,intervalESValue:r}=n;e.ordered={interval:l().duration(r,t),intervalESUnit:t,intervalESValue:r}}else e.ordered={interval:n.interval}}(r,e),function(e){const t=e.aspects.y;Array.isArray(t)&&(e.yAxisFormat=t[0].format,e.yAxisLabel=t.length>1?"":t[0].title);const r=e.aspects.series;r&&(e.zAxisFormat=r[0].format,e.zAxisLabel="")}(r),"date"in r.aspects.x[0].params&&function(e){const t=e.aspects.x[0],r="bounds"in t.params?t.params.bounds:void 0;e.ordered.date=!0,r?(e.ordered.min="string"==typeof r.min?Date.parse(r.min):r.min,e.ordered.max="string"==typeof r.max?Date.parse(r.max):r.max):e.ordered.endzones=!1}(r),r.series=function(e,t){const r=t.aspects,s=r.x[0],n=r.y[0],a=r.z&&r.z[0],i=Array.isArray(r.y)&&r.y.length>1,o=(0,b.partial)(_,e,s,r.series),l=new Map;return e.rows.forEach(((e,t)=>{if(i)r.y.forEach((function(s){const n=o(e,t,s,a);if(!n)return;let i=s.accessor,c=s.title;if(r.series){const e=n.series?n.series+": ":"";i=e+i,c=e+c}n.seriesId=i,m(l,n,i,c,s.format,a&&a.format,a&&a.title)}));else{const r=o(e,t,n,a);if(r){const e=`${r.series}-${n.accessor}`;r.seriesId=e,m(l,r,e,r.series,n.format,a&&a.format,a&&a.title)}}})),[...l.values()]}(e,r),delete r.aspects,r},function(e,t){const r=function(e,t){const r={tables:[]},s=t.splitColumn||t.splitRow;if(s){r.direction=t.splitRow?"row":"column";const n=s[0].accessor,i=(0,a.tz)().deserialize(s[0].format),o=e.columns[n],l={};let c=0;e.rows.forEach(((t,s)=>{const a=t[o.id],u=i.convert(a);if(!Object.hasOwn(l,a)){l[a]=c++;const t={$parent:r,title:`${u}: ${o.name}`,name:o.name,key:a,formattedKey:u,column:n,row:s,table:e,tables:[]};t.tables.push({$parent:t,columns:e.columns,rows:[]}),r.tables.push(t)}const p=l[a];r.tables[p].tables[0].rows.push(t)}))}else r.tables.push({columns:e.columns,rows:e.rows});return r}(e,t);let s=g(r,(e=>h(e,t)));return s||(s={rows:[]}),s.hits=e.rows.length,s});var h;const y="vislib_vis",x=async(e,t)=>{var r,s;const n=(0,c.getVisSchemas)(e,t),a={x:n.segment?n.segment[0]:null,y:n.metric,z:n.radius,width:n.width,series:n.group,splitRow:n.split_row,splitColumn:n.split_column},i=null!==(r=null===(s=e.data.aggs)||void 0===s?void 0:s.getResponseAggs())&&void 0!==r?r:[];if(a.x){const r=i[a.x.accessor];if(r.type.name===p.BUCKET_TYPES.DATE_HISTOGRAM){a.x.params.date=!0;const{esUnit:e,esValue:t}=r.buckets.getInterval();a.x.params.intervalESUnit=e,a.x.params.intervalESValue=t,a.x.params.interval=l().duration(t,e).asMilliseconds(),a.x.params.format=r.buckets.getScaledDateFormat(),a.x.params.bounds=r.buckets.getBounds()}else if(r.type.name===p.BUCKET_TYPES.HISTOGRAM){const s=r.type.paramByName("interval"),n={params:{}};await s.modifyAggConfigOnSearchRequestStart(r,e.data.searchSource,{abortSignal:t.abortSignal}),s.write(r,n),a.x.params.interval=n.params.interval}}const o={...e.params};(a.y||[]).forEach((e=>{var t;const r=i.filter((({enabled:e})=>e))[e.accessor],s=(o.seriesParams||[]).find((e=>e.data.id===r.id));if(s){const t=(o.valueAxes||[]).find((e=>e.id===s.valueAxis));"percentage"===(null==t?void 0:t.scale.mode)&&(e.format={id:"percent"})}var n;!0===(null==o||null===(t=o.gauge)||void 0===t?void 0:t.percentageMode)&&(e.format={id:"percent",params:{pattern:null==o||null===(n=o.gauge)||void 0===n?void 0:n.percentageFormatPattern}})}));const d=(0,u.buildExpressionFunction)(y,{type:e.type.name,visConfig:JSON.stringify({...o,dimensions:a})});return(0,u.buildExpression)([d]).toAst()},w={...(0,i.heatmapVisType)({}),toExpressionAst:x};var S=r(185),O=r(286);const k=__kbnSharedDeps__.ReactDom;var D=r(482),A=r(791);const E=(0,O.lazy)((()=>r.e(66).then(r.bind(r,66))));var P=r(834);const T={...(0,P.gaugeVisType)({}),toExpressionAst:x},j={...(0,P.goalVisType)({}),toExpressionAst:x};class VisTypeVislibPlugin{constructor(e){this.initializerContext=e}setup(e,{expressions:t,visualizations:r,charts:a}){t.registerRenderer(((e,t)=>({name:y,displayName:"Vislib visualization",reuseDomNode:!0,render:async(r,s,n)=>{const[a]=await e.getStartServices(),i=function(e,t){if(["goal","gauge"].includes(t))return!1;const r=null==e?void 0:e.rows,s=0===(null==e?void 0:e.hits)||r&&!r.length;return Boolean(s)}(s.visData,s.visType);n.onDestroy((()=>(0,k.unmountComponentAtNode)(r))),(0,k.render)((0,A.jsx)(D.KibanaRenderContextProvider,a,(0,A.jsx)(c.VisualizationContainer,{handlers:n,showNoResult:i},(0,A.jsx)(E,(0,S.default)({},s,{core:e,charts:t,handlers:n})))),r)}}))(e,a)),t.registerFunction({name:y,type:"render",inputTypes:["datatable"],help:d.i18n.translate("visTypeVislib.functions.vislib.help",{defaultMessage:"Vislib visualization"}),args:{type:{types:["string"],default:'""',help:"vislib vis type"},visConfig:{types:["string"],default:'"{}"',help:"vislib vis config"}},fn(e,t,r){var s;const n=t.type,a=JSON.parse(t.visConfig),i=v(e,a.dimensions);return null!=r&&null!==(s=r.inspectorAdapters)&&void 0!==s&&s.tables&&r.inspectorAdapters.tables.logDatatable("default",e),{type:"render",as:y,value:{visData:i,visConfig:a,visType:n}}}});const{readOnly:i}=this.initializerContext.config.get();e.uiSettings.get(s.LEGACY_HEATMAP_CHARTS_LIBRARY)&&r.createBaseVisualization({...w,disableCreate:Boolean(i),disableEdit:Boolean(i)}),e.uiSettings.get(n.LEGACY_GAUGE_CHARTS_LIBRARY)&&(r.createBaseVisualization({...T,disableCreate:Boolean(i),disableEdit:Boolean(i)}),r.createBaseVisualization({...j,disableCreate:Boolean(i),disableEdit:Boolean(i)}))}start(e,{data:t,usageCollection:r,fieldFormats:s,uiActions:n}){(0,a.yU)(e),(0,a.hX)(s),(0,a.s8)(t.actions),r&&(0,a._N)(r)}}function C(e){return new VisTypeVislibPlugin(e)}},107:(e,t,r)=>{"use strict";r.d(t,{G$:()=>u,_N:()=>p,hX:()=>c,oZ:()=>n,s8:()=>o,tz:()=>l,yU:()=>a});var s=r(215);const[n,a]=(0,s.createGetterSetter)("CoreStart"),[i,o]=(0,s.createGetterSetter)("vislib data.actions"),[l,c]=(0,s.createGetterSetter)("FieldFormats"),[u,p]=(0,s.createGetterSetter)("UsageCollection",!1)},312:(e,t,r)=>{r.p=window.__kbnPublicPath__.visTypeVislib},240:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},627:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},546:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},904:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},374:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/fieldFormats/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},215:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},494:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/visTypeGauge/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},834:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/visTypeGauge/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},219:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/visTypeHeatmap/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},619:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/visTypeHeatmap/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},500:(e,t,r)=>{r.r(t);var s=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(s))},185:(e,t,r)=>{e.exports=r(497)(51858)},113:e=>{"use strict";e.exports=__kbnSharedDeps__.ChromaJs},927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},521:e=>{"use strict";e.exports=__kbnSharedDeps__.Jquery},744:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnAnalytics},256:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnDatemath},8:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},482:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaContextRender},804:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaMount},433:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnStd},803:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnUiTheme},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},97:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDomServer},79:e=>{"use strict";e.exports=__kbnSharedDeps__.SaferLodashSet},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},r={};function s(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,s),a.exports}s.m=t,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,r)=>(s.f[r](e,t),t)),[])),s.u=e=>"visTypeVislib.chunk."+e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},s.l=(t,r,n,a)=>{if(e[t])e[t].push(r);else{var i,o;if(void 0!==n)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var u=l[c];if(u.getAttribute("src")==t){i=u;break}}i||(o=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.src=t),e[t]=[r];var p=(r,s)=>{i.onerror=i.onload=null,clearTimeout(d);var n=e[t];if(delete e[t],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach((e=>e(s))),r)return r(s)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),o&&document.head.appendChild(i)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={540:0};s.f.j=(t,r)=>{var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise(((r,s)=>n=e[t]=[r,s]));r.push(n[2]=a);var i=s.p+s.u(t),o=new Error;s.l(i,(r=>{if(s.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,a,[i,o,l]=r,c=0;if(i.some((t=>0!==e[t]))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);l&&l(s)}for(t&&t(r);c<i.length;c++)a=i[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.visTypeVislib_bundle_jsonpfunction=self.visTypeVislib_bundle_jsonpfunction||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),s(312),__kbnBundles__.define("plugin/visTypeVislib/public",s,67)})();