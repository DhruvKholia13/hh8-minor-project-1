/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e={306:(e,t,n)=>{"use strict";n.r(t),n.d(t,{plugin:()=>re});var a=n(915),s=n(286),o=n.n(s);const i=__kbnSharedDeps__.Rxjs,l=__kbnSharedDeps__.KbnI18n;var r=n(721);class ConnectionDetailsService{constructor(e){var t;(0,a.default)(this,"tabId$",new i.BehaviorSubject("endpoints")),(0,a.default)(this,"showCloudId$",new i.BehaviorSubject(!1)),(0,a.default)(this,"apiKeyName$",new i.BehaviorSubject("")),(0,a.default)(this,"apiKeyStatus$",new i.BehaviorSubject("configuring")),(0,a.default)(this,"apiKeyError$",new i.BehaviorSubject(void 0)),(0,a.default)(this,"apiKey$",new i.BehaviorSubject(null)),(0,a.default)(this,"apiKeyFormat$",new i.BehaviorSubject("encoded")),(0,a.default)(this,"apiKeyHasAccess$",new i.BehaviorSubject(null)),(0,a.default)(this,"setTab",(e=>{this.tabId$.next(e)})),(0,a.default)(this,"toggleShowCloudId",(()=>{this.emitTelemetryEvent(["show_cloud_id_toggled"]),this.showCloudId$.next(!this.showCloudId$.getValue())})),(0,a.default)(this,"setApiKeyName",(e=>{this.apiKeyName$.next(e),this.apiKeyError$.next(void 0)})),(0,a.default)(this,"setApiKeyFormat",(e=>{this.emitTelemetryEvent(["key_encoding_changed",{format:e}]),this.apiKeyFormat$.next(e)})),(0,a.default)(this,"validateName",(()=>{if(!this.apiKeyName$.getValue()){const e=l.i18n.translate("cloud.connectionDetails.tab.apiKeys.nameField.missingError",{defaultMessage:"API key name is required."});throw new Error(e)}})),(0,a.default)(this,"createKeyAsync",(async()=>{var e;const t=null===(e=this.opts.apiKeys)||void 0===e?void 0:e.createKey;if(!t)throw new Error("createKey() is not implemented");this.apiKeyStatus$.next("creating");try{this.validateName();const{apiKey:e}=await t({name:this.apiKeyName$.getValue()});this.apiKey$.next(e),this.emitTelemetryEvent(["new_api_key_created"])}catch(e){this.apiKeyError$.next(e)}finally{this.apiKeyStatus$.next("configuring")}})),(0,a.default)(this,"createKey",(()=>{this.createKeyAsync().catch((e=>{this.apiKeyError$.next(e)}))})),(0,a.default)(this,"emitTelemetryEvent",(e=>{try{var t,n;null===(t=(n=this.opts).onTelemetryEvent)||void 0===t||t.call(n,e)}catch(e){r.error("Error emitting telemetry event",e)}})),this.opts=e,null===(t=e.apiKeys)||void 0===t||t.hasPermission().then((e=>{this.apiKeyHasAccess$.next(e)})).catch((e=>{r.error("Error checking API key creation permissions",e)}))}}const c=s.createContext(null),u=()=>{const e=s.useContext(c);if(!e||0===Object.keys(e).length)throw new Error("ConnectionDetailsServiceProvider is not set up.");return e},d=__kbnSharedDeps__.EmotionReact,p=s.createContext({}),g=({children:e,...t})=>{const n=s.useMemo((()=>new ConnectionDetailsService(t)),[t]);return(0,d.jsx)(p.Provider,{value:t},(0,d.jsx)(c.Provider,{value:n},e))},y=()=>{const e=s.useContext(p);if(!e||0===Object.keys(e).length)throw new Error("ConnectionDetailsOptsContextValue is not set up.");return e},f=__kbnSharedDeps__.ElasticEui;var h=n(757);const k=e=>(0,h.A)(e,e.getValue()),m=({value:e,onCopyClick:t})=>{const n=s.useRef(null);return(0,d.jsx)(f.EuiPanel,{borderRadius:"none",hasShadow:!1,color:"subdued",grow:!1},(0,d.jsx)(f.EuiFlexGroup,{gutterSize:"s"},(0,d.jsx)(f.EuiFlexItem,null,(0,d.jsx)(f.EuiText,{size:"s",color:"subdued",style:{wordBreak:"break-all"},"data-test-subj":"copyInputValue"},(0,d.jsx)("span",{ref:n,onMouseDown:e=>{const t=n.current;if(t&&window.getSelection&&document.createRange){const n=window.getSelection();if(!n)return;e.preventDefault();const a=document.createRange();a.selectNodeContents(t),n.removeAllRanges(),n.addRange(a)}},"data-test-subj":"copyText"},e))),(0,d.jsx)(f.EuiFlexItem,{grow:!1},(0,d.jsx)(f.EuiCopy,{textToCopy:e},(e=>(0,d.jsx)(f.EuiButtonIcon,{onClick:n=>{null==t||t(n),e()},iconType:"copyClipboard",size:"m",color:"text","aria-label":l.i18n.translate("cloud.connectionDetails.components.copyInput.copyBtn.label",{defaultMessage:"Copy to clipboard"})}))))))},x=__kbnSharedDeps__.KbnI18nReact;var v={name:"z5y8xy",styles:"min-width:200px;height:16px"},b={name:"16ceglb",styles:"font-weight:600"};const M=({learnMoreUrl:e})=>{const[t,n]=s.useState(!1),a=l.i18n.translate("cloud.connectionDetails.tab.endpoints.cloudIdField.label",{defaultMessage:"Cloud ID"});return e?(0,d.jsx)(f.EuiFlexGroup,{css:v,alignItems:"center",gutterSize:"xs"},(0,d.jsx)(f.EuiFlexItem,{grow:!1},(0,d.jsx)(f.EuiText,{size:"xs",css:b},a)),(0,d.jsx)(f.EuiFlexItem,null,(0,d.jsx)(f.EuiPopover,{button:(0,d.jsx)(f.EuiButtonIcon,{iconType:"question",onClick:()=>{n((e=>!e))},"aria-label":l.i18n.translate("cloud.connectionDetails.tab.endpoints.cloudIdField.helpButtonAriaLabel",{defaultMessage:"Cloud ID help"})}),isOpen:t,closePopover:()=>{n(!1)},anchorPosition:"upLeft",hasArrow:!1},(0,d.jsx)("p",{style:{width:270}},(0,d.jsx)(x.FormattedMessage,{id:"cloud.connectionDetails.tab.endpoints.cloudIdField.label.tooltip",defaultMessage:"Get started with Elastic Agent or Logstash quickly. The Cloud ID simplifies sending data to Elastic. {link}",values:{link:(0,d.jsx)(f.EuiLink,{href:e,external:!0},l.i18n.translate("cloud.connectionDetails.tab.endpoints.cloudIdField.learnMore",{defaultMessage:"Learn more"}))}}))))):(0,d.jsx)(s.Fragment,null,a)},_=({value:e,showCloudId:t,learnMoreUrl:n,onShowCloudIdToggle:a,onCopyClick:o})=>(0,d.jsx)(s.Fragment,null,(0,d.jsx)(f.EuiSpacer,{size:"l"}),(0,d.jsx)(f.EuiSwitch,{label:l.i18n.translate("cloud.connectionDetails.tab.endpoints.cloudIdField.toggle",{defaultMessage:"Show Cloud ID"}),checked:t,onChange:()=>a(),"data-test-subj":"connectionDetailsCloudIdSwitch"}),t&&(0,d.jsx)(f.EuiSpacer,{size:"l"}),t&&(0,d.jsx)(f.EuiFormRow,{label:(0,d.jsx)(M,{learnMoreUrl:n,"aria-label":l.i18n.translate("cloud.connectionDetails.cloudId.learnMore",{defaultMessage:"Learn more about Cloud ID"})}),helpText:l.i18n.translate("cloud.connectionDetails.tab.endpoints.cloudIdField.helpText",{defaultMessage:"Specific client libraries and connectors can use this unique identifier specific to Elastic Cloud."}),fullWidth:!0,"data-test-subj":"connectionDetailsCloudId"},(0,d.jsx)(m,{value:e,onCopyClick:()=>null==o?void 0:o(),"aria-label":l.i18n.translate("cloud.connectionDetails.tab.cloudId.label",{defaultMessage:"Copy Cloud ID to clipboard"})}))),j=({url:e,onCopyClick:t})=>(0,d.jsx)(f.EuiFormRow,{label:l.i18n.translate("cloud.connectionDetails.tab.endpoints.endpointField.label",{defaultMessage:"Elasticsearch endpoint"}),helpText:l.i18n.translate("cloud.connectionDetails.tab.endpoints.endpointField.helpText",{defaultMessage:"The most common method for establishing an Elasticsearch connection."}),fullWidth:!0,"data-test-subj":"connectionDetailsEsUrl"},(0,d.jsx)(m,{value:e,onCopyClick:()=>null==t?void 0:t(),"aria-label":l.i18n.translate("cloud.connectionDetails.tab.endpoints.endpointField.copy",{defaultMessage:"Copy Elasticsearch endpoint to clipboard"})})),C=()=>{var e;const{endpoints:t}=y(),n=u(),a=k(n.showCloudId$);return t?(0,d.jsx)(f.EuiForm,{component:"div"},!(null==t||!t.url)&&(0,d.jsx)(j,{url:t.url,onCopyClick:()=>n.emitTelemetryEvent(["copy_endpoint_url_clicked"])}),!(null==t||!t.id)&&(0,d.jsx)(_,{value:t.id,showCloudId:a,learnMoreUrl:null===(e=n.opts.endpoints)||void 0===e?void 0:e.cloudIdLearMoreLink,onShowCloudIdToggle:n.toggleShowCloudId,onCopyClick:()=>n.emitTelemetryEvent(["copy_cloud_id_clicked"])})):null};var E=n(185);const S=({url:e,go:t,onClick:n,children:a,...s})=>(0,d.jsx)(f.EuiLink,(0,E.default)({},s,{href:e,onClick:a=>{var s;t&&((s=a).metaKey||s.altKey||s.ctrlKey||s.shiftKey||(a.preventDefault(),t(e)),null==n||n(a))}}),a),L=()=>{var e;const t=u(),n=null===(e=t.opts.apiKeys)||void 0===e?void 0:e.manageKeysLink;return n?(0,d.jsx)(S,{url:n,go:()=>{var e,a;t.emitTelemetryEvent(["manage_api_keys_clicked"]),null===(e=t.opts)||void 0===e||null===(a=e.navigateToUrl)||void 0===a||a.call(e,n)},"data-test-subj":"connectionDetailsManageApiKeysLink"},l.i18n.translate("cloud.connectionDetails.apiKeys.managerLinkLabel",{defaultMessage:"Manage API keys"})):null},w=({name:e,loading:t,error:n,onNameChange:a,onSubmit:o})=>{const i=(0,d.jsx)(s.Fragment,null,!!n&&(0,d.jsx)(s.Fragment,null,(0,d.jsx)(f.EuiCallOut,{color:"danger",iconType:"error",title:l.i18n.translate("cloud.connectionDetails.tab.apiKeys.error.title",{defaultMessage:"Error"})},n instanceof Error?n.message:String(n)),(0,d.jsx)(f.EuiSpacer,null)),(0,d.jsx)(f.EuiFormRow,{label:l.i18n.translate("cloud.connectionDetails.tab.apiKeys.nameField.label",{defaultMessage:"API key name"}),helpText:l.i18n.translate("cloud.connectionDetails.tab.apiKeys.nameField.helpText",{defaultMessage:"A good name makes it clear what your API key does."}),error:"test",isDisabled:t,fullWidth:!0},(0,d.jsx)(f.EuiFieldText,{name:"api-key-name",disabled:t,isLoading:t,value:e,onChange:a,"data-test-subj":"connectionDetailsApiKeyNameInput"}))),r=(0,d.jsx)(f.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},(0,d.jsx)(f.EuiFlexItem,{grow:!1},(0,d.jsx)(L,null)),(0,d.jsx)(f.EuiFlexItem,{grow:!1},(0,d.jsx)(f.EuiButton,{fill:!0,type:"submit",isLoading:t,"data-test-subj":"connectionDetailsApiKeySubmitBtn"},l.i18n.translate("cloud.connectionDetails.tab.apiKeys.nameField.createButton.label",{defaultMessage:"Create API key"}))));return(0,d.jsx)(f.EuiForm,{component:"form",fullWidth:!0,onSubmit:o,"data-test-subj":"connectionDetailsApiKeyConfigForm"},i,(0,d.jsx)(f.EuiSpacer,null),r)},T=()=>{const e=u(),t=k(e.apiKeyName$),n=k(e.apiKeyStatus$),a=k(e.apiKeyError$),s=null===k(e.apiKeyHasAccess$);return(0,d.jsx)(f.EuiSkeletonText,{isLoading:s},(0,d.jsx)(w,{name:t,error:a,loading:"creating"===n,onNameChange:t=>{e.setApiKeyName(t.target.value)},onSubmit:t=>{t.preventDefault(),e.createKey()}}))},D=()=>(0,d.jsx)(s.Fragment,null,(0,d.jsx)(f.EuiCallOut,{color:"warning",iconType:"info",title:l.i18n.translate("cloud.connectionDetails.tabs.apiKeys.missingPermPanel.title",{defaultMessage:"Missing permissions"})},(0,d.jsx)("p",null,l.i18n.translate("cloud.connectionDetails.tabs.apiKeys.missingPermPanel.description",{defaultMessage:"Your assigned role does not have the necessary permissions to create an API key. Please contact your administrator."}))),(0,d.jsx)(f.EuiSpacer,{size:"m"}),(0,d.jsx)(L,null)),K=({value:e,options:t,onChange:n})=>(0,d.jsx)(f.EuiSuperSelect,{"aria-label":l.i18n.translate("cloud.connectionDetails.components.fancySelect.superSelect.ariaLabel",{defaultMessage:"Fancy options"}),valueOfSelected:e,options:t.map((e=>({value:e.id,icon:e.icon,layoutAlign:"center",inputDisplay:(0,d.jsx)(f.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"s"},(0,d.jsx)(f.EuiFlexItem,{grow:!1},(0,d.jsx)(f.EuiIcon,{type:e.icon})),(0,d.jsx)(f.EuiFlexItem,{grow:!0},(0,d.jsx)(f.EuiText,{size:"s",textAlign:"left"},e.title))),dropdownDisplay:(0,d.jsx)(f.EuiText,{size:"s"},(0,d.jsx)("strong",null,e.title),(0,d.jsx)(f.EuiText,{size:"s",color:"subdued"},(0,d.jsx)("p",null,e.description)))}))),onChange:n}),P=({value:e,onChange:t})=>(0,d.jsx)(K,{value:e,options:[{id:"encoded",icon:"key",title:l.i18n.translate("cloud.connectionDetails.apiKeyFormat.encoded.title",{defaultMessage:"Encoded"}),description:l.i18n.translate("cloud.connectionDetails.apiKeyFormat.encoded.description",{defaultMessage:"Use to make requests to Elasticsearch REST API"})},{id:"beats",icon:"logoBeats",title:l.i18n.translate("cloud.connectionDetails.apiKeyFormat.beats.title",{defaultMessage:"Beats"}),description:l.i18n.translate("cloud.connectionDetails.apiKeyFormat.beats.description",{defaultMessage:"Use to configure Beats"})},{id:"logstash",icon:"logoLogstash",title:l.i18n.translate("cloud.connectionDetails.apiKeyFormat.logstash.title",{defaultMessage:"Logstash"}),description:l.i18n.translate("cloud.connectionDetails.apiKeyFormat.logstash.description",{defaultMessage:"Use to configure Logstash"})}],onChange:e=>t(e)}),I=({apiKey:e,format:t,onFormatChange:n,onCopyClick:a})=>{const o="encoded"===t?e.encoded:`${e.id}:${e.key}`;return(0,d.jsx)(s.Fragment,null,(0,d.jsx)(f.EuiCallOut,{color:"success",iconType:"check",title:l.i18n.translate("cloud.connectionDetails.apiKeys.successForm.title",{defaultMessage:'Created API key "{name}"',values:{name:e.name}}),"data-test-subj":"connectionDetailsApiKeySuccessForm"},(0,d.jsx)("p",null,l.i18n.translate("cloud.connectionDetails.apiKeys.successForm.message",{defaultMessage:"Copy your API key below now. It will not be available after you close this dialogue. The API key will expire in 90 days."})),(0,d.jsx)(f.EuiFormRow,{label:l.i18n.translate("cloud.connectionDetails.apiKeys.successForm.keyFormatTitle",{defaultMessage:"API key format"}),fullWidth:!0},(0,d.jsx)(P,{value:t,onChange:n})),(0,d.jsx)(f.EuiFormRow,{label:l.i18n.translate("cloud.connectionDetails.apiKeys.successForm.keyValueTitle",{defaultMessage:"API key value"}),fullWidth:!0,"data-test-subj":"connectionDetailsApiKeyValueRow"},(0,d.jsx)(m,{value:o,onCopyClick:a}))),(0,d.jsx)(f.EuiSpacer,{size:"m"}),(0,d.jsx)(L,null))},F=()=>{const e=u(),t=k(e.apiKey$),n=k(e.apiKeyFormat$);return t?(0,d.jsx)(I,{apiKey:t,format:n,onFormatChange:e.setApiKeyFormat,onCopyClick:()=>e.emitTelemetryEvent(["copy_api_key_clicked",{format:n}])}):null},A=()=>{const e=u(),{apiKeys:t}=e.opts,n=k(e.apiKey$),a=k(e.apiKeyHasAccess$);return t?!1===a?(0,d.jsx)(D,null):n?(0,d.jsx)(F,null):(0,d.jsx)(T,null):null},B=()=>{const e=u();switch(k(e.tabId$)){case"endpoints":return(0,d.jsx)(C,null);case"apiKeys":return(0,d.jsx)(A,null);default:return null}},R=()=>{const e=y(),t=u(),n=k(t.tabId$),a=[];return e.endpoints&&a.push(["endpoints",l.i18n.translate("cloud.connectionDetails.tab.endpoints",{defaultMessage:"Endpoints"})]),e.apiKeys&&a.push(["apiKeys",l.i18n.translate("cloud.connectionDetails.tab.apiKeys",{defaultMessage:"API key"})]),0===a.length?null:(0,d.jsx)(f.EuiTabs,null,a.map((([e,a])=>(0,d.jsx)(f.EuiTab,{key:e,onClick:()=>t.setTab(e),isSelected:n===e,"data-test-subj":`connectionDetailsTabBtn-${e}`},a))))},$=()=>{var e;const t=y(),n=u(),a=(0,d.jsx)(f.EuiFlyoutHeader,{hasBorder:!0},(0,d.jsx)(f.EuiTitle,{size:"m","data-test-subj":"connectionDetailsModalTitle"},(0,d.jsx)("h2",null,l.i18n.translate("cloud.connectionDetails.flyout.title",{defaultMessage:"Connection details"}))),(0,d.jsx)(f.EuiSpacer,{size:"s"}),(0,d.jsx)(f.EuiText,{color:"subdued",size:"s"},(0,d.jsx)("p",null,l.i18n.translate("cloud.connectionDetails.flyout.subtitle",{defaultMessage:"Connect to the Elasticsearch API by using the following details."})," ",!(null===(e=t.links)||void 0===e||!e.learnMore)&&(0,d.jsx)(f.EuiLink,{external:!0,href:t.links.learnMore,target:"_blank",onClick:()=>n.emitTelemetryEvent(["learn_more_clicked"])},l.i18n.translate("cloud.connectionDetails.learnMoreButtonLabel",{defaultMessage:"Learn more"})))),(0,d.jsx)("div",{style:{marginBottom:"-25px"}},(0,d.jsx)(R,null))),o=(0,d.jsx)(f.EuiFlyoutBody,{"data-test-subj":"connectionDetailsModalBody"},(0,d.jsx)(B,null));return(0,d.jsx)(s.Fragment,null,a,o)},U=e=>{const t=((t,n)=>{const[a,o]=s.useState(void 0);return s.useLayoutEffect((()=>{let t=!0;return(async e=>{var t,n,a,s,o,i,l,r,c;const{options:u,start:d}=e,{http:p,docLinks:g,analytics:y}=d.core,f=null===(t=d.plugins)||void 0===t||null===(n=t.share)||void 0===n||null===(a=n.url)||void 0===a?void 0:a.locators.get("MANAGEMENT_APP_LOCATOR"),h=await(null==f?void 0:f.getUrl({sectionId:"security",appId:"api_keys"})),k=await(null===(s=d.plugins)||void 0===s||null===(o=s.cloud)||void 0===o?void 0:o.fetchElasticsearchConfig());return{...u,navigateToUrl:d.core.application?t=>{var n,a,s;null===(n=e.onNavigation)||void 0===n||n.call(e),null===(a=d.core.application)||void 0===a||null===(s=a.navigateToUrl)||void 0===s||s.call(a,t)}:void 0,links:{learnMore:g.links.fleet.apiKeysLearnMore,...null==u?void 0:u.links},endpoints:{id:null===(i=d.plugins)||void 0===i||null===(l=i.cloud)||void 0===l?void 0:l.cloudId,url:null==k?void 0:k.elasticsearchUrl,cloudIdLearMoreLink:null==g||null===(r=g.links)||void 0===r||null===(c=r.cloud)||void 0===c?void 0:c.beatsAndLogstashConfiguration,...null==u?void 0:u.endpoints},apiKeys:{manageKeysLink:h,createKey:async({name:e})=>{if(!p)throw new Error("HTTP service is not available");const t={name:e,expiration:"90d",metadata:{},role_descriptors:{}},n=await p.post("/internal/security/api_key",{body:JSON.stringify(t)});return{apiKey:{id:n.id,name:n.name,key:n.api_key,encoded:n.encoded}}},hasPermission:async()=>!0,...null==u?void 0:u.apiKeys},onTelemetryEvent:e=>{if(y)switch(e[0]){case"learn_more_clicked":y.reportEvent("connection_details_learn_more_clicked",{});break;case"tab_switched":y.reportEvent("connection_details_tab_switched",{tab:e[1].tab});break;case"copy_endpoint_url_clicked":y.reportEvent("connection_details_copy_endpoint_url_clicked",{});break;case"show_cloud_id_toggled":y.reportEvent("connection_details_show_cloud_id_toggled",{});break;case"copy_cloud_id_clicked":y.reportEvent("connection_details_copy_cloud_id_clicked",{});break;case"new_api_key_created":y.reportEvent("connection_details_new_api_key_created",{});break;case"manage_api_keys_clicked":y.reportEvent("connection_details_manage_api_keys_clicked",{});break;case"key_encoding_changed":y.reportEvent("connection_details_key_encoding_changed",{format:e[1].format});break;case"copy_api_key_clicked":y.reportEvent("connection_details_copy_api_key_clicked",{format:e[1].format})}}}})(e).then((e=>{t&&o(e)})),()=>{t=!1}}),n),a})(0,[e.onNavigation,e.options,e.start]);return t?(0,d.jsx)(g,t,e.children):null},N="ConnectionDetailsGlobalDependencies",z=__kbnSharedDeps__.ReactDom;var O=n.n(z);const V=__kbnSharedDeps__.KbnReactKibanaContextRender,H=o().createContext(null),G=({children:e,...t})=>(0,d.jsx)(H.Provider,{value:t},e),q=({children:e,...t})=>{const{core:{notifications:n,...a},security:{userProfiles:s},toMountPoint:o}=t;return(0,d.jsx)(G,{userProfileApiClient:s,notifySuccess:({title:e,text:t},s)=>{const i={};null!=s&&s.durationMs&&(i.toastLifeTimeMs=s.durationMs),n.toasts.addSuccess({title:e,text:t?o(t,a):void 0},i)}},e)},W=__kbnSharedDeps__.KbnReactKibanaMount;var J={name:"1vpb80k",styles:"inline-size:420px"};function Y({title:e,values:t,onChange:n,selectedValue:a,ariaLabel:s}){return(0,d.jsx)(o().Fragment,null,(0,d.jsx)(f.EuiKeyPadMenu,{"aria-label":s,"data-test-subj":"appearanceColorMode",checkable:{legend:(0,d.jsx)("span",null,e)},css:J},t.map((({id:e,label:t,icon:s})=>(0,d.jsx)(f.EuiKeyPadMenuItem,{name:e,key:e,label:t,checkable:"single",isSelected:a===e,onChange:()=>{n(e)},"data-test-subj":`colorModeKeyPadItem${e}`},(0,d.jsx)(f.EuiIcon,{type:s,size:"l"}))))))}const Q=__kbnSharedDeps__.Lodash,X={notificationSuccess:{title:l.i18n.translate("userProfileComponents.updateUserProfile.notification.submitSuccessTitle",{defaultMessage:"Profile updated"}),pageReloadText:l.i18n.translate("userProfileComponents.updateUserProfile.notification.requiresPageReloadDescription",{defaultMessage:"One or more settings require you to reload the page to take effect."})}},Z=({uiSettingsClient:e,defaultColorMode:t,defaultContrastMode:n})=>{const a=e.isOverridden("theme:darkMode"),{userProfileData:i,isLoading:r,update:c,userProfileLoaded:u}=(({notificationSuccess:e={},pageReloadChecker:t}={})=>{const{userProfileApiClient:n,notifySuccess:a}=function(){const e=(0,s.useContext)(H);if(!e)throw new Error("UserProfilesContext is missing. Ensure your component or React root is wrapped with <UserProfilesProvider /> or <UserProfilesKibanaProvider />.");return e}(),{userProfile$:i,enabled$:r,userProfileLoaded$:c}=n,{enabled:u=!0,title:p=X.notificationSuccess.title,pageReloadText:g=X.notificationSuccess.pageReloadText}=e,[y,k]=(0,s.useState)(!1),m=(0,h.A)(i),x=(0,h.A)(r),v=(0,h.A)(c,!1),b=(0,s.useRef)(),M=(0,s.useRef)(!1),_=(0,s.useCallback)((({isRefreshRequired:e=!1}={})=>{e?a({title:p,text:(0,d.jsx)(o().Fragment,null,(0,d.jsx)("p",null,g),(0,d.jsx)(f.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},(0,d.jsx)(f.EuiFlexItem,{grow:!1},(0,d.jsx)(f.EuiButton,{size:"s",onClick:()=>window.location.reload(),"data-test-subj":"windowReloadButton",autoFocus:!0},l.i18n.translate("userProfileComponents.updateUserProfile.notification.requiresPageReloadButtonLabel",{defaultMessage:"Reload page"})))))},{durationMs:3e5}):a({title:p})}),[p,a,g]),j=(0,s.useCallback)((e=>{if(M.current&&k(!1),u){const n=null==t?void 0:t(b.current,e);_({isRefreshRequired:n})}}),[u,_,t]),C=(0,s.useCallback)((e=>(b.current=(0,Q.merge)({},m),k(!0),n.partialUpdate(e).then((()=>(j(e),e))))),[n,j,m]);return(0,s.useEffect)((()=>(M.current=!0,()=>{M.current=!1})),[]),{update:C,showSuccessNotification:_,userProfileData:m,isLoading:y,userProfileEnabled:x,userProfileLoaded:v}})({notificationSuccess:{title:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearance.successNotificationTitle",{defaultMessage:"Appearance settings updated"}),pageReloadText:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearance.successNotificationText",{defaultMessage:"Reload the page to see the changes"})},pageReloadChecker:(e,t)=>{var n,a,s,o;const i=(null==e||null===(n=e.userSettings)||void 0===n?void 0:n.darkMode)!==(null===(a=t.userSettings)||void 0===a?void 0:a.darkMode),l=(null==e||null===(s=e.userSettings)||void 0===s?void 0:s.contrastMode)!==(null===(o=t.userSettings)||void 0===o?void 0:o.contrastMode);return i||l}}),{userSettings:{darkMode:p=t,contrastMode:g=n}={}}=null!=i?i:{userSettings:{}},[y,k]=(0,s.useState)(p),[m,x]=(0,s.useState)(p),[v,b]=(0,s.useState)(g),[M,_]=(0,s.useState)(g),j=(0,s.useCallback)((({colorMode:e,contrastMode:t},n)=>{if(!r&&(e&&k(e),t&&b(t),n))return c({userSettings:{darkMode:e,contrastMode:t}})}),[r,c]);return(0,s.useEffect)((()=>{k(p),b(g)}),[p,g]),(0,s.useEffect)((()=>{if(u){var e;const{darkMode:t,contrastMode:n}=null!==(e=null==i?void 0:i.userSettings)&&void 0!==e?e:{};t&&x(t),n&&_(n)}}),[i,u]),{setColorMode:k,colorMode:y,initialColorModeValue:m,setContrastMode:b,contrastMode:v,initialContrastModeValue:M,isVisible:!a&&Boolean(i),isLoading:r,onChange:j}},ee=l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalSystemLabel",{defaultMessage:"System"}),te=[{id:"system",label:ee,icon:"desktop"},{id:"light",label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalLightLabel",{defaultMessage:"Light"}),icon:"sun"},{id:"dark",label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalDarkLabel",{defaultMessage:"Dark"}),icon:"moon"},{id:"space_default",label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalSpaceDefaultLabel",{defaultMessage:"Space default"}),icon:"spaces",betaBadgeLabel:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalBetaBadgeLabel",{defaultMessage:"Deprecated"}),betaBadgeTooltipContent:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalBetaBadgeTooltip",{defaultMessage:"Space default settings will be deprecated in 10.0."}),betaBadgeIconType:"warning"}],ne=({isServerless:e,colorMode:t,onChange:n})=>(0,d.jsx)(o().Fragment,null,(0,d.jsx)(Y,{title:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalColorModeTitle",{defaultMessage:"Color mode"}),values:e?te.filter((({id:e})=>"space_default"!==e)):te,selectedValue:t,onChange:e=>{n({colorMode:e},!1)},ariaLabel:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalColorModeAriaLabel",{defaultMessage:"Appearance color mode"})}),"space_default"===t&&(0,d.jsx)(o().Fragment,null,(0,d.jsx)(f.EuiSpacer,null),(0,d.jsx)(f.EuiCallOut,{title:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalDeprecatedSpaceDefaultTitle",{defaultMessage:"Space default settings will be removed in a future version"}),color:"warning",iconType:"warning"},(0,d.jsx)("p",null,l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalDeprecatedSpaceDefaultDescr",{defaultMessage:"All users with the Space default color mode enabled will be automatically transitioned to the System color mode."}))),(0,d.jsx)(f.EuiSpacer,null))),ae=({contrastMode:e,onChange:t})=>(0,d.jsx)(Y,{title:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalContrastModeTitle",{defaultMessage:"Interface contrast"}),values:[{id:"system",label:ee,icon:"desktop"},{id:"standard",label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalContrastModeStandard",{defaultMessage:"Normal"}),icon:"contrast"},{id:"high",label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalContrastModeHigh",{defaultMessage:"High"}),icon:"contrastHigh"}],selectedValue:e,onChange:e=>{t({contrastMode:e},!1)},ariaLabel:l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalContrastModeAriaLabel",{defaultMessage:"Appearance contrast mode"})}),se=({closeModal:e,uiSettingsClient:t,isServerless:n})=>{const a=(0,f.useGeneratedHtmlId)(),{colorMode:s,initialColorModeValue:o,contrastMode:i,initialContrastModeValue:r,isLoading:c,onChange:u}=Z({uiSettingsClient:t,defaultColorMode:n?"system":"space_default",defaultContrastMode:"standard"});return(0,d.jsx)(f.EuiModal,{"aria-labelledby":a,onClose:e,style:n?void 0:{width:580}},(0,d.jsx)(f.EuiModalHeader,null,(0,d.jsx)(f.EuiModalHeaderTitle,{size:"m",id:a},l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalTitle",{defaultMessage:"Appearance"}))),(0,d.jsx)(f.EuiModalBody,null,(0,d.jsx)(ne,{isServerless:n,colorMode:s,onChange:u}),(0,d.jsx)(f.EuiSpacer,null),(0,d.jsx)(ae,{contrastMode:i,onChange:u})),(0,d.jsx)(f.EuiModalFooter,null,(0,d.jsx)(f.EuiButtonEmpty,{"data-test-subj":"appearanceModalDiscardButton",onClick:e},l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalDiscardBtnLabel",{defaultMessage:"Discard"})),(0,d.jsx)(f.EuiButton,{"data-test-subj":"appearanceModalSaveButton",onClick:async()=>{s===o&&i===r||u({colorMode:s,contrastMode:i},!0),e()},fill:!0,isLoading:c},l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceModalSaveBtnLabel",{defaultMessage:"Save changes"}))))},oe=({security:e,core:t,closePopover:n,isServerless:a})=>(0,d.jsx)(q,{core:t,security:e,toMountPoint:W.toMountPoint},(0,d.jsx)(ie,{core:t,security:e,closePopover:n,isServerless:a}));function ie({security:e,core:t,closePopover:n,isServerless:a}){const{isVisible:o}=Z({uiSettingsClient:t.uiSettings,defaultColorMode:"space_default",defaultContrastMode:"standard"}),i=(0,s.useRef)(null),r=()=>{var e;null===(e=i.current)||void 0===e||e.close(),i.current=null};return o?(0,d.jsx)(f.EuiContextMenuItem,{icon:"brush",size:"s",onClick:()=>{i.current=t.overlays.openModal((0,W.toMountPoint)((0,d.jsx)(q,{core:t,security:e,toMountPoint:W.toMountPoint},(0,d.jsx)(se,{closeModal:r,uiSettingsClient:t.uiSettings,isServerless:a})),t),{"data-test-subj":"appearanceModal",maxWidth:600}),n()},"data-test-subj":"appearanceSelector"},l.i18n.translate("xpack.cloudLinks.userMenuLinks.appearanceLinkText",{defaultMessage:"Appearance"})):null}function le({core:e,security:t,cloud:a,isServerless:s}){const o=(0,i.defer)((()=>t.authc.getCurrentUser())).pipe((0,i.map)((e=>e.elastic_cloud_user)),(0,i.catchError)((()=>(0,i.of)(!0))),(0,i.filter)((e=>!0===e)),(0,i.switchMap)((()=>(a.deploymentUrl&&e.chrome.setCustomNavLink({title:l.i18n.translate("xpack.cloudLinks.deploymentLinkLabel",{defaultMessage:"Manage this deployment"}),euiIconType:"logoCloud",href:a.deploymentUrl}),(0,i.from)((async({core:e,cloud:t,security:n,isServerless:a})=>{const{profileUrl:s,organizationUrl:o}=t,i=[];s&&i.push({label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.profileLinkText",{defaultMessage:"Profile"}),iconType:"user",href:s,order:100,setAsProfile:!0});const{billingUrl:r}=await t.getPrivilegedUrls();return r&&i.push({label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.billingLinkText",{defaultMessage:"Billing"}),iconType:"visGauge",href:r,order:200}),o&&i.push({label:l.i18n.translate("xpack.cloudLinks.userMenuLinks.organizationLinkText",{defaultMessage:"Organization"}),iconType:"gear",href:o,order:300}),i.push({content:({closePopover:t})=>(0,d.jsx)(oe,{core:e,security:n,closePopover:t,isServerless:a}),order:400,label:"",iconType:"",href:""}),i})({core:e,cloud:a,security:t,isServerless:s})).pipe((0,i.map)((e=>{t.navControlService.addUserMenuLinks(e)}))))))),r=e.chrome.getHelpSupportUrl$();a.isCloudEnabled&&(0,i.combineLatest)({user:o,helpSupportUrl:r}).subscribe((({helpSupportUrl:t})=>{const a=(({docLinks:e,helpSupportUrl:t,isServerless:a})=>[{title:l.i18n.translate("xpack.cloudLinks.helpMenuLinks.documentation",{defaultMessage:"Documentation"}),href:e.links.elasticStackGetStarted},...a?[{title:l.i18n.translate("xpack.cloudLinks.helpMenuLinks.releaseNotes",{defaultMessage:"Release notes"}),href:e.links.serverlessReleaseNotes}]:[],{title:l.i18n.translate("xpack.cloudLinks.helpMenuLinks.support",{defaultMessage:"Support"}),href:t},{title:l.i18n.translate("xpack.cloudLinks.helpMenuLinks.giveFeedback",{defaultMessage:"Give feedback"}),href:e.links.kibana.feedback},{title:l.i18n.translate("xpack.cloudLinks.helpMenuLinks.connectionDetails",{defaultMessage:"Connection details"}),dataTestSubj:"connectionDetailsHelpLink",onClick:()=>{(async(e={})=>{const t=(()=>{const e=n.g[N];if(void 0===e)throw new Error("ConnectionDetailsGlobalDependencies not set");return e})().start;(async({props:e,start:t})=>{const n=t.core.overlays.openFlyout((a=>{const s=(0,d.jsx)(V.KibanaRenderContextProvider,t.core,(0,d.jsx)(U,(0,E.default)({},e,{onNavigation:()=>{null==n||n.close()}}),(0,d.jsx)($,null)));return O().render(s,a),()=>O().unmountComponentAtNode(a)}),{size:"s"})})({...e,props:{...e.props,start:t},start:t})})()}}])({docLinks:e.docLinks,helpSupportUrl:t,isServerless:s});e.chrome.setHelpMenuLinks(a)}))}class CloudLinksPlugin{constructor(e){(0,a.default)(this,"offering",void 0),this.offering=e.env.packageInfo.buildFlavor}setup({analytics:e}){e.registerEventType({eventType:"connection_details_learn_more_clicked",schema:{}}),e.registerEventType({eventType:"connection_details_tab_switched",schema:{tab:{type:"keyword",_meta:{description:"Connection details tab that was switched to.",optional:!1}}}}),e.registerEventType({eventType:"connection_details_copy_endpoint_url_clicked",schema:{}}),e.registerEventType({eventType:"connection_details_show_cloud_id_toggled",schema:{}}),e.registerEventType({eventType:"connection_details_copy_cloud_id_clicked",schema:{}}),e.registerEventType({eventType:"connection_details_new_api_key_created",schema:{}}),e.registerEventType({eventType:"connection_details_manage_api_keys_clicked",schema:{}}),e.registerEventType({eventType:"connection_details_key_encoding_changed",schema:{format:{type:"keyword",_meta:{description:"The format of the API key that was changed to.",optional:!1}}}}),e.registerEventType({eventType:"connection_details_copy_api_key_clicked",schema:{format:{type:"keyword",_meta:{description:"The format of the API key that was copied.",optional:!1}}}})}start(e,t){const{cloud:a,security:s,share:o}=t;var i;null!=a&&a.isCloudEnabled&&!e.http.anonymousPaths.isAnonymous(window.location.pathname)&&s&&le({core:e,security:s,cloud:a,share:o,isServerless:"serverless"===this.offering}),i={start:{core:e,plugins:t}},n.g[N]=i}stop(){}}function re(e){return new CloudLinksPlugin(e)}},310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNavigator=t.isBrowser=t.off=t.on=t.noop=void 0,t.noop=function(){},t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.addEventListener&&e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)},t.isBrowser="undefined"!=typeof window,t.isNavigator="undefined"!=typeof navigator},978:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(286),s=n(310).isBrowser?a.useLayoutEffect:a.useEffect;t.default=s},757:(e,t,n)=>{"use strict";var a=n(941),s=n(286),o=a.__importDefault(n(978));t.A=function(e,t){var n=s.useState(t),a=n[0],i=n[1];return o.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),a}},962:(e,t,n)=>{n.p=window.__kbnPublicPath__.cloudLinks},721:(e,t,n)=>{e.exports=n(497)(4971)},185:(e,t,n)=>{e.exports=n(497)(51858)},915:(e,t,n)=>{e.exports=n(497)(67493)},286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var s=a.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=a[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n(962),__kbnBundles__.define("plugin/cloudLinks/public",n,306)})();