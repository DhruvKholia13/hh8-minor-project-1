/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */(()=>{var e,t,s,a,n={8524:(e,t,s)=>{"use strict";s.d(t,{V:()=>r,mS:()=>i,vP:()=>n});var a=s(5008);const n=a.i18n.translate("cases.components.status.open",{defaultMessage:"Open"}),i=a.i18n.translate("cases.components.status.inProgress",{defaultMessage:"In progress"}),r=a.i18n.translate("cases.components.status.closed",{defaultMessage:"Closed"})},4395:(e,t,s)=>{"use strict";s.d(t,{F:()=>a});let a=function(e){return e.open="open",e["in-progress"]="in-progress",e.closed="closed",e}({})},2708:(e,t,s)=>{"use strict";s.d(t,{L$:()=>l,Ov:()=>n,_i:()=>r});var a=s(3614);const n={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",STREAMS:"streams",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml",STACK_ALERTS:"stackAlerts",EXAMPLE:"AlertingExample",MONITORING:"monitoring",ALERTS:"alerts",DISCOVER:"discover"},i=(n.OBSERVABILITY,Object.values(n).map((e=>e))),r=e=>"string"==typeof e&&i.includes(e),l=e=>e.startsWith("siem.")||e===a.ZJ},9219:(e,t,s)=>{"use strict";s.d(t,{BI:()=>T,Cl:()=>C,DW:()=>p,Ez:()=>v,Kp:()=>b,Rn:()=>M,Ry:()=>h,S2:()=>l,SL:()=>k,Wp:()=>d,ZQ:()=>E,_9:()=>F,at:()=>y,fJ:()=>w,gH:()=>r,h:()=>x,h9:()=>u,ht:()=>a,i2:()=>c,lj:()=>m,pR:()=>f,qT:()=>S,sR:()=>O,tU:()=>_,tV:()=>j,tg:()=>g,vT:()=>n,xv:()=>o,z1:()=>A,zt:()=>i});const a="@timestamp",n="kibana",i=`${n}.alert`,r=`${i}.rule`,l=`${n}.space_ids`,o=`${n}.version`,c=`${i}.action_group`,u=`${i}.case_ids`,d=`${i}.duration.us`,p=`${i}.end`,g=`${i}.flapping`,m=`${i}.maintenance_window_ids`,f=`${i}.instance.id`,y=`${i}.reason`,b=`${i}.start`,v=`${i}.status`,h=`${i}.time_range`,x=`${i}.uuid`,k=`${i}.workflow_status`,_=`${i}.workflow_tags`,C=`${i}.workflow_assignee_ids`,T=`${r}.category`,w=`${r}.consumer`,A=`${r}.execution.uuid`,S=`${r}.name`,E=`${r}.parameters`,M=`${r}.producer`,O=`${r}.tags`,j=`${r}.rule_type_id`,F=`${r}.uuid`},9673:(e,t,s)=>{"use strict";s.d(t,{A:()=>r,b:()=>l});var a=s(4286),n=s(6791);const i=(0,a.createContext)(null),r=()=>{const e=(0,a.useContext)(i);if(!e)throw new Error("FilesContext is not found!");return e},l=({client:e,children:t})=>(0,n.jsx)(i.Provider,{value:{client:e}},t)},3614:(e,t,s)=>{"use strict";s.d(t,{ZJ:()=>a});const a="attack-discovery"},3192:(e,t,s)=>{"use strict";s.d(t,{Mf:()=>x,k5:()=>l,uf:()=>r,OU:()=>d,Q1:()=>g,NH:()=>b,CZ:()=>h,ZY:()=>i,Yt:()=>n,T:()=>c,o$:()=>u,Ot:()=>k,gX:()=>v,Y2:()=>o,Mi:()=>m,Ic:()=>f,uE:()=>p,rB:()=>y,aJ:()=>A,kB:()=>T});var a=s(6735);const n=e=>a.Qq.replace("{case_id}",e),i=e=>a.eW.replace("{case_id}",e),r=e=>a.Ct.replace("{case_id}",e),l=(e,t)=>a.Vu.replace("{case_id}",e).replace("{comment_id}",t),o=e=>a.E1.replace("{case_id}",e),c=e=>a.FV.replace("{case_id}",e),u=(e,t)=>a.M7.replace("{case_id}",e).replace("{connector_id}",t),d=e=>a.ZG.replace("{configuration_id}",e),p=e=>a.Tc.replace("{alert_id}",e),g=e=>a.Bv.replace("{case_id}",e),m=e=>a.qy.replace("{case_id}",e),f=e=>a.m$.replace("{case_id}",e),y=(e,t)=>a.qL.replace("{case_id}",e).replace("{custom_field_id}",t),b=e=>a.eH.replace("{case_id}",e),v=(e,t)=>a.dL.replace("{case_id}",e).replace("{observable_id}",t),h=(e,t)=>a.y.replace("{case_id}",e).replace("{observable_id}",t),x=e=>a.IH.replace("{case_id}",e),k=e=>a.XI.replace("{case_id}",e);var _=s(3782),C=s(1060);const T=e=>t=>{throw e((e=>{const t=e.map((e=>{if(null!=e.message)return e.message;{const t=e.context.filter((e=>null!=e.key&&!Number.isInteger(+e.key)&&""!==e.key.trim())).map((e=>e.key)).join(","),s=e.context.find((e=>null!=e.type&&null!=e.type.name&&e.type.name.length>0)),a=""!==t?t:null!=s?s.type.name:"";return`Invalid value "${(0,C.isObject)(e.value)?JSON.stringify(e.value):e.value}" supplied to "${a}"`}}));return[...new Set(t)]})(t).join())},w=_.union([_.null,_.boolean,_.number,_.string]),A=_.recursion("JsonValue",(()=>_.union([w,S,E]))),S=_.recursion("JsonArray",(()=>_.array(A))),E=_.recursion("JsonObject",(()=>_.record(_.string,A)));s(2178)},2178:(e,t,s)=>{"use strict";s.d(t,{j:()=>i});var a=s(3782),n=s(1639);const i=new a.Type("NumberFromString",a.number.is,((e,t)=>n.either.chain(a.string.validate(e,t),(s=>{const n=+s;return isNaN(n)?a.failure(e,t,"cannot parse to a number"):a.success(n)}))),String)},6735:(e,t,s)=>{"use strict";s.d(t,{f2:()=>le,Xt:()=>re,sZ:()=>n,w3:()=>o,y1:()=>c,gT:()=>Ze,ll:()=>Qe,$$:()=>d,Gp:()=>We,Eg:()=>ot,yP:()=>rt,L:()=>ut,pl:()=>ct,Jv:()=>u,__:()=>U,Nk:()=>Ye,jP:()=>He,gv:()=>O,Tc:()=>$,L8:()=>ft,Ct:()=>I,Vu:()=>V,tX:()=>E,h8:()=>R,ZG:()=>N,CM:()=>P,Qq:()=>F,pj:()=>j,XR:()=>mt,M7:()=>L,$J:()=>D,N_:()=>g,l9:()=>p,Nt:()=>m,Uy:()=>Ue,yH:()=>Ke,D2:()=>A,Oh:()=>S,Oc:()=>$e,Un:()=>et,lZ:()=>qe,DU:()=>i,MP:()=>r,hL:()=>l,mR:()=>k,V0:()=>v,xz:()=>Xe,ZY:()=>B,IH:()=>ie,WR:()=>G,FV:()=>ae,qd:()=>ne,eW:()=>J,q4:()=>Z,y:()=>se,dL:()=>te,eH:()=>ee,XI:()=>Q,qy:()=>W,Bv:()=>q,m$:()=>Y,N3:()=>K,E1:()=>H,qL:()=>X,uZ:()=>z,Il:()=>w.I,rS:()=>it,KD:()=>ye,TO:()=>tt,A4:()=>Se,am:()=>ce,XK:()=>ue,ZT:()=>pe,$E:()=>Ae,yx:()=>me,Nr:()=>he,c0:()=>de,wT:()=>ke,IV:()=>Ee,NT:()=>Me,Q1:()=>Oe,lv:()=>je,p:()=>gt,nD:()=>De,lq:()=>C,rT:()=>Te,Lj:()=>xe,LF:()=>oe,W2:()=>Le,dG:()=>_,FO:()=>_e,zz:()=>at,rf:()=>dt,Sb:()=>pt,qu:()=>be,U9:()=>we,b:()=>fe,sr:()=>Ce,iZ:()=>Ve,QM:()=>Re,Kx:()=>Ne,Pb:()=>Fe,Nb:()=>Pe,qA:()=>Ie,tS:()=>ve,xG:()=>ge,BA:()=>lt,_y:()=>st,qN:()=>b,cu:()=>T.cu,Dg:()=>T.Dg,qT:()=>T.qT,in:()=>T.in,zX:()=>T.zX,lB:()=>T.lB,tR:()=>T.tR,H1:()=>h,lO:()=>x,sc:()=>Ge,IM:()=>Be,uU:()=>M,e1:()=>nt,tn:()=>y,Vw:()=>f,uO:()=>Je,ty:()=>ze});var a=s(2708);s(7371);const n="cases",i="generalCases",r="generalCasesV2",l="generalCasesV3",o="cases",c="/app/management/insightsAndAlerting/cases",u="/create",d="/configure",p="/:detailName",g=`${p}/:commentId`,m=`${p}/?tabId=:tabId`,f="management",y="securitySolution",b="observability",v=n,h=[v,b,y],x={[y]:{id:y,appId:"securitySolutionUI",label:"Security",iconType:"logoSecurity",appRoute:"/app/security",validRuleConsumers:[a.Ov.SIEM],serverlessProjectType:"security"},[b]:{id:b,appId:"observability-overview",label:"Observability",iconType:"logoObservability",appRoute:"/app/observability",validRuleConsumers:[a.Ov.OBSERVABILITY,a.Ov.APM,a.Ov.INFRASTRUCTURE,a.Ov.LOGS,a.Ov.SLO,a.Ov.UPTIME,a.Ov.MONITORING,a.Ov.STREAMS],serverlessProjectType:"observability"},[v]:{id:v,appId:"management",label:"Management",iconType:"managementApp",appRoute:"/app/management/insightsAndAlerting",validRuleConsumers:[a.Ov.ML,a.Ov.STACK_ALERTS,a.Ov.EXAMPLE,a.Ov.DISCOVER]}},k=".files",_=104857600,C=10;var T=s(4578),w=s(7);const A="dateFormat",S="dateFormat:tz",E="cases-comments",M=["cases","cases-connector-mappings","cases-user-actions",E,"cases-configure"],O="/api/cases",j=`${O}/_find`,F=`${O}/{case_id}`,P=`${O}/configure`,N=`${O}/configure/{configuration_id}`,R=`${P}/connectors`,I=`${F}/comments`,V=`${F}/comments/{comment_id}`,L=`${F}/connector/{connector_id}/_push`,D=`${O}/tags`,$=`${O}/alerts/{alert_id}`,U="/internal/cases",B=`${U}/{case_id}/attachments/_bulk_create`,z=`${U}/_suggest_user_profiles`,q=`${U}/{case_id}/_connectors`,G=`${U}/_bulk_get`,H=`${U}/{case_id}/user_actions/_stats`,W=`${U}/{case_id}/_users`,Y=`${U}/{case_id}/attachments/files/_bulk_delete`,K=`${U}/categories`,Z=`${U}/metrics`,J=`${U}/metrics/{case_id}`,Q=`${U}/{case_id}/_similar`,X=`${U}/{case_id}/custom_fields/{custom_field_id}`,ee=`${U}/{case_id}/observables`,te=`${ee}/{observable_id}`,se=`${ee}/{observable_id}`,ae=`${U}/{case_id}/user_actions/_find`,ne=`${U}/case/alerts/_find_containing_all`,ie=`${U}/{case_id}/observables/_bulk_create`,re="/api/actions",le=`${re}/connector_types`,oe=1e4,ce=100,ue=1e3,de=100,pe=100,ge=100,me=100,fe=100,ye=100,be=100,ve=160,he=50,xe=3e4,ke=3e4,_e=256,Ce=200,Te=100,we=10,Ae=100,Se=100,Ee=10,Me=36,Oe=50,je=160,Fe=36,Pe=50,Ne=1e3,Re=10,Ie=50,Ve=10,Le=160,De=50,$e=Object.freeze({alerts:{sync:!0,enabled:!0,isExperimental:!1},metrics:[],observables:{enabled:!0,autoExtract:!1},events:{enabled:!1}}),Ue="create_cases",Be="read_cases",ze="update_cases",qe="delete_cases",Ge="push_cases",He="cases_settings",We="cases_connectors",Ye="case_reopen",Ke="create_comment",Ze="cases_assign",Je="casesSuggestUserProfiles",Qe="bulkGetUserProfiles",Xe="casesGetConnectorsConfigure",et=10,tt=10,st="none",at=50,nt=500,it={casesTableColumns:"cases.list.tableColumns",casesTableFiltersConfig:"cases.list.tableFiltersConfig",casesTableState:"cases.list.state"};let rt=function(e){return e.RUN="run",e}({});const lt="none",ot=".cases",ct="Cases",ut="^[1-9][0-9]*[d,w,h,m]$",dt=36,pt=50,gt=10,mt="case_page_view",ft="case_attach_events"},8760:(e,t,s)=>{"use strict";s.d(t,{EK:()=>i,Ms:()=>l,QI:()=>r,Tq:()=>n,fT:()=>o});const a=["image/aces","image/apng","image/avci","image/avcs","image/avif","image/bmp","image/cgm","image/dicom-rle","image/dpx","image/emf","image/example","image/fits","image/g3fax","image/heic","image/heic-sequence","image/heif","image/heif-sequence","image/hej2k","image/hsj2","image/jls","image/jp2","image/jpeg","image/jph","image/jphc","image/jpm","image/jpx","image/jxr","image/jxrA","image/jxrS","image/jxs","image/jxsc","image/jxsi","image/jxss","image/ktx","image/ktx2","image/naplps","image/png","image/prs.btif","image/prs.pti","image/pwg-raster","image/svg+xml","image/t38","image/tiff","image/tiff-fx","image/vnd.adobe.photoshop","image/vnd.airzip.accelerator.azv","image/vnd.cns.inf2","image/vnd.dece.graphic","image/vnd.djvu","image/vnd.dwg","image/vnd.dxf","image/vnd.dvb.subtitle","image/vnd.fastbidsheet","image/vnd.fpx","image/vnd.fst","image/vnd.fujixerox.edmics-mmr","image/vnd.fujixerox.edmics-rlc","image/vnd.globalgraphics.pgb","image/vnd.microsoft.icon","image/vnd.mix","image/vnd.ms-modi","image/vnd.mozilla.apng","image/vnd.net-fpx","image/vnd.pco.b16","image/vnd.radiance","image/vnd.sealed.png","image/vnd.sealedmedia.softseal.gif","image/vnd.sealedmedia.softseal.jpg","image/vnd.svf","image/vnd.tencent.tap","image/vnd.valve.source.texture","image/vnd.wap.wbmp","image/vnd.xiff","image/vnd.zbrush.pcx","image/webp","image/wmf"],n=["text/plain","text/csv","text/json","application/json"],i=["application/zip","application/gzip","application/x-bzip","application/x-bzip2","application/x-7z-compressed","application/x-tar"],r=["application/pdf"],l=[...a,...n,...i,...r],o=new Set(a)},4578:(e,t,s)=>{"use strict";s.d(t,{Bq:()=>d,Dg:()=>g,N2:()=>l,cu:()=>p,in:()=>c,lB:()=>n,qT:()=>u,tR:()=>i,vg:()=>r,w2:()=>o,zX:()=>a});const a={label:"IPv4",key:"observable-type-ipv4"},n={label:"IPv6",key:"observable-type-ipv6"},i={label:"URL",key:"observable-type-url"},r={label:"Host name",key:"observable-type-hostname"},l={label:"File hash",key:"observable-type-file-hash"},o={label:"File path",key:"observable-type-file-path"},c={label:"Email",key:"observable-type-email"},u={label:"Domain",key:"observable-type-domain"},d={label:"Agent id",key:"observable-type-agent-id"},p=[d,a,n,i,r,l,o,c,u],g=p.map((({key:e})=>e))},7:(e,t,s)=>{"use strict";s.d(t,{I:()=>a});const a=".lens"},2194:(e,t,s)=>{"use strict";s.d(t,{Fs:()=>i,Ng:()=>r});var a=s(3782);s(770),s(6735),a.strict({caseIds:a.array(a.string)});const n="FilesCases",i=(e,t)=>`${e}${n}${t}`,r=e=>`${e}${n}`},9113:(e,t,s)=>{"use strict";s.r(t),s.d(t,{APP_ID:()=>n.sZ,ASSIGN_CASE_CAPABILITY:()=>n.gT,AttachmentType:()=>a.wh,CASES_CONNECTORS_CAPABILITY:()=>n.Gp,CASES_REOPEN_CAPABILITY:()=>n.Nk,CASES_SETTINGS_CAPABILITY:()=>n.jP,CASES_URL:()=>n.gv,CASE_COMMENT_SAVED_OBJECT:()=>n.tX,CREATE_CASES_CAPABILITY:()=>n.Uy,CREATE_COMMENT_CAPABILITY:()=>n.yH,CaseMetricsFeature:()=>u.KC,CaseSeverity:()=>a.EQ,ConnectorTypes:()=>a.J4,DELETE_CASES_CAPABILITY:()=>n.lZ,ExternalReferenceStorageType:()=>a.wL,FEATURE_ID:()=>n.DU,FEATURE_ID_V2:()=>n.MP,GENERAL_CASES_OWNER:()=>n.V0,GET_CONNECTORS_CONFIGURE_API_TAG:()=>n.xz,INTERNAL_BULK_CREATE_ATTACHMENTS_URL:()=>n.ZY,INTERNAL_BULK_GET_CASES_URL:()=>n.WR,LENS_ATTACHMENT_TYPE:()=>n.Il,OBSERVABILITY_OWNER:()=>n.qN,PUSH_CASES_CAPABILITY:()=>n.sc,READ_CASES_CAPABILITY:()=>n.IM,SAVED_OBJECT_TYPES:()=>n.uU,SECURITY_SOLUTION_OWNER:()=>n.tn,UPDATE_CASES_CAPABILITY:()=>n.ty,createUICapabilities:()=>r.F,getApiTags:()=>c,getCaseFindUserActionsUrl:()=>i.T,getCasesFromAlertsUrl:()=>i.uE,throwErrors:()=>i.kB});var a=s(6013),n=s(6735),i=s(3192),r=s(3728);let l=function(e){return e.Read="Read",e.Create="Create",e.Delete="Delete",e}({});var o=s(2194);const c=e=>{const t=(0,o.Fs)(e,l.Create),s=(0,o.Fs)(e,l.Delete),a=(0,o.Fs)(e,l.Read);return{all:[n.uO,n.ll,n.xz,a],read:[n.uO,n.ll,n.xz,a],delete:[s],createComment:[t]}};var u=s(3198)},1629:(e,t,s)=>{"use strict";s.d(t,{uk:()=>u,NQ:()=>p,Zk:()=>f,Xq:()=>m,tj:()=>d,gJ:()=>b,gC:()=>g,D0:()=>y});var a=s(3782),n=s(1639),i=s(6735),r=s(2178);const l=a.union([a.number,r.j]),o=a.exact(a.partial({page:l,perPage:l}));var c=s(8760);const u=new a.Type("NonEmptyString",a.string.is,((e,t)=>n.either.chain(a.string.validate(e,t),(s=>""!==s.trim()?a.success(s):a.failure(e,t,"string must have length >= 1")))),a.identity),d=({fieldName:e,min:t,max:s})=>new a.Type("LimitedString",a.string.is,((i,r)=>n.either.chain(a.string.validate(i,r),(n=>{const l=n.trim();return 0===l.length&&l.length<t?a.failure(i,r,`The ${e} field cannot be an empty string.`):l.length<t?a.failure(i,r,`The length of the ${e} is too short. The minimum length is ${t}.`):l.length>s?a.failure(i,r,`The length of the ${e} is too long. The maximum length is ${s}.`):a.success(n)}))),a.identity),p=({codec:e,fieldName:t,min:s,max:i})=>new a.Type("LimitedArray",(t=>a.array(e).is(t)),((r,l)=>n.either.chain(a.array(e).validate(r,l),(e=>e.length<s?a.failure(r,l,`The length of the field ${t} is too short. Array must be of length >= ${s}.`):e.length>i?a.failure(r,l,`The length of the field ${t} is too long. Array must be of length <= ${i}.`):a.success(e)))),a.identity),g=({maxPerPage:e})=>new a.PartialType("Pagination",o.is,((t,s)=>n.either.chain(o.validate(t,s),(n=>{var r,l;if(null==n.page&&null==n.perPage)return a.success(n);const o=null!==(r=n.page)&&void 0!==r?r:0,c=null!==(l=n.perPage)&&void 0!==l?l:0;return c>e?a.failure(t,s,`The provided perPage value is too high. The maximum allowed perPage value is ${e}.`):Math.max(o,o*c)>i.LF?a.failure(t,s,`The number of documents is too high. Paginating through more than ${i.LF} documents is not possible.`):a.success({...null!=n.page&&{page:o},...null!=n.perPage&&{perPage:c}})}))),a.identity,void 0),m=({fieldName:e,min:t,max:s})=>new a.Type("LimitedNumber",a.number.is,((i,r)=>n.either.chain(a.number.validate(i,r),(n=>n<t?a.failure(i,r,`The ${e} field cannot be less than ${t}.`):n>s?a.failure(i,r,`The ${e} field cannot be more than ${s}.`):a.success(n)))),a.identity),f=({fieldName:e})=>new a.Type("LimitedNumberAsInteger",a.number.is,((t,s)=>n.either.chain(a.number.validate(t,s),(n=>Number.isSafeInteger(n)?a.success(n):a.failure(t,s,`The ${e} field should be an integer between -(2^53 - 1) and 2^53 - 1, inclusive.`)))),a.identity),y=({codec:e,pattern:t,message:s})=>new a.Type("RegexString",e.is,((i,r)=>n.either.chain(e.validate(i,r),(e=>new RegExp(t,"g").test(e)?a.success(e):a.failure(i,r,s)))),a.identity),b=new a.Type("mimeTypeString",a.string.is,((e,t)=>n.either.chain(a.string.validate(e,t),(s=>c.Ms.includes(s)?a.success(s):a.failure(e,t,`The mime type field value ${s} is not allowed.`)))),a.identity)},7371:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=function(e){return e.ALERTS="alerts",e.ACTIVITY="activity",e.EVENTS="events",e.FILES="files",e.OBSERVABLES="observables",e.SIMILAR_CASES="similar_cases",e}({})},3196:(e,t,s)=>{"use strict";s.d(t,{zA:()=>c});var a=s(3782),n=s(6735),i=s(1629),r=s(7070);a.strict({ids:(0,i.NQ)({codec:i.uk,min:1,max:n.lq,fieldName:"ids"})}),a.intersection([a.strict({file:a.unknown}),a.exact(a.partial({filename:(0,i.tj)({fieldName:"filename",min:1,max:n.W2})}))]);const l=a.union([r.Eo,r.IF,r.lF,r.f7,r.bi,r.Ox]),o=a.union([a.strict({comment:(0,i.tj)({fieldName:"comment",min:1,max:n.wT}),type:a.literal(r.wh.user),owner:a.string}),r.Ox,r.IF,a.strict({type:a.literal(r.wh.actions),comment:(0,i.tj)({fieldName:"comment",min:1,max:n.wT}),actions:a.strict({targets:a.array(a.strict({hostname:a.string,endpointId:a.string})),type:a.string}),owner:a.string}),r.f7,r.MD,r.bi]),c=a.union([l,r.gP]);a.intersection([o,a.strict({id:a.string,version:a.string})]),a.strict({comments:a.array(r.m1),page:a.number,per_page:a.number,total:a.number}),a.intersection([a.exact(a.partial({sortOrder:a.union([a.literal("desc"),a.literal("asc")])})),(0,i.gC)({maxPerPage:n.c0})]),(0,i.NQ)({codec:o,min:0,max:n.A4,fieldName:"attachments"}),a.strict({ids:(0,i.NQ)({codec:a.string,min:1,max:n.am,fieldName:"ids"})}),a.strict({attachments:r.BN,errors:a.array(a.strict({error:a.string,message:a.string,status:a.union([a.undefined,a.number]),attachmentId:a.string}))})},3198:(e,t,s)=>{"use strict";s.d(t,{KC:()=>Z,EO:()=>S,oW:()=>U,nO:()=>E,aI:()=>w,qd:()=>ae,e9:()=>A,kd:()=>O,P6:()=>se});var a=s(3782),n=s(6735),i=s(1629),r=s(6013),l=s(2905),o=s(2448),c=s(1025),u=s(9072);const d=a.strict({count_open_cases:a.number,count_in_progress_cases:a.number,count_closed_cases:a.number}),p=(a.exact(a.partial({from:a.string,to:a.string,owner:a.union([a.array(a.string),a.string])})),e=>(0,i.tj)({fieldName:e,min:1,max:n.lv})),g=({fieldName:e})=>(0,i.Zk)({fieldName:e}),m=(a.strict({value:a.union([a.boolean,a.null,p("value"),g({fieldName:"value"})]),caseVersion:a.string}),a.strict({key:a.string,type:r.bQ,value:a.union([p("value"),a.null])})),f=a.strict({key:a.string,type:r.fj,value:a.union([g({fieldName:"value"}),a.null])}),y=a.union([m,r.u2,f]),b=(0,i.NQ)({codec:y,fieldName:"customFields",min:0,max:n.IV}),v=a.exact(a.partial({description:(0,i.tj)({fieldName:"description",min:1,max:n.Lj}),tags:(0,i.NQ)({codec:(0,i.tj)({fieldName:"tag",min:1,max:n.FO}),min:0,max:n.sr,fieldName:"tags"}),title:(0,i.tj)({fieldName:"title",min:1,max:n.tS}),connector:o.ab,severity:c.cf,assignees:(0,i.NQ)({codec:u.FW,fieldName:"assignees",min:0,max:n.TO}),category:a.union([(0,i.tj)({fieldName:"category",min:1,max:n.Nr}),a.null]),customFields:b,settings:c.c6})),h=a.intersection([v,a.exact(a.partial({status:c.pG,owner:a.string}))]),x=a.intersection([a.strict({description:(0,i.tj)({fieldName:"description",min:1,max:n.Lj}),tags:(0,i.NQ)({codec:(0,i.tj)({fieldName:"tag",min:1,max:n.FO}),fieldName:"tags",min:0,max:n.sr}),title:(0,i.tj)({fieldName:"title",min:1,max:n.tS}),connector:o.ab,settings:c.c6,owner:a.string}),a.exact(a.partial({assignees:(0,i.NQ)({codec:u.FW,fieldName:"assignees",min:0,max:n.TO}),severity:c.cf,category:a.union([(0,i.tj)({fieldName:"category",min:1,max:n.Nr}),a.null]),customFields:b}))]),k=a.intersection([x,a.exact(a.partial({id:a.string}))]),_=(a.strict({cases:a.array(k)}),a.strict({cases:a.array(c.xv)}),a.keyof({description:null,title:null,"incremental_id.text":null})),C=a.keyof({title:null,category:null,createdAt:null,updatedAt:null,closedAt:null,status:null,severity:null}),T=a.intersection([a.exact(a.partial({tags:a.union([(0,i.NQ)({codec:a.string,fieldName:"tags",min:0,max:n.b}),a.string]),status:a.union([c.pG,a.array(c.pG)]),severity:a.union([c.cf,a.array(c.cf)]),assignees:a.union([(0,i.NQ)({codec:a.string,fieldName:"assignees",min:0,max:n.KD}),a.string]),reporters:a.union([(0,i.NQ)({codec:a.string,fieldName:"reporters",min:0,max:n.qu}),a.string]),defaultSearchOperator:a.union([a.literal("AND"),a.literal("OR")]),from:a.string,search:a.string,searchFields:a.union([a.array(_),_]),sortField:C,sortOrder:a.union([a.literal("desc"),a.literal("asc")]),to:a.string,owner:a.union([a.array(a.string),a.string]),category:a.union([(0,i.NQ)({codec:a.string,fieldName:"category",min:0,max:n.yx}),a.string])})),(0,i.gC)({maxPerPage:n.ZT})]),w=(a.intersection([a.exact(a.partial({customFields:a.record(a.string,a.array(a.union([a.string,a.boolean,a.number,a.null])))})),T]),a.intersection([a.strict({cases:a.array(c.xv),page:a.number,per_page:a.number,total:a.number}),d])),A=a.strict({cases:a.array(c.sx),page:a.number,per_page:a.number,total:a.number}),S=((0,i.NQ)({codec:i.uk,min:1,max:n.rT,fieldName:"ids"}),a.intersection([a.strict({case:c.xv,outcome:a.union([a.literal("exactMatch"),a.literal("aliasMatch"),a.literal("conflict")])}),a.exact(a.partial({alias_target_id:a.string,alias_purpose:a.union([a.literal("savedObjectConversion"),a.literal("savedObjectImport")])}))])),E=(a.strict({ids:(0,i.NQ)({codec:a.string,min:1,max:n.XK,fieldName:"ids"})}),a.strict({cases:c.Wm,errors:a.array(a.strict({error:a.string,message:a.string,status:a.union([a.undefined,a.number]),caseId:a.string}))})),M=a.intersection([h,a.strict({id:a.string,version:a.string})]),O=(a.strict({cases:(0,i.NQ)({codec:M,min:1,max:n.$E,fieldName:"cases"})}),a.strict({case_id:a.string,connector_id:a.string}),a.exact(a.partial({owner:a.union([a.array(a.string),a.string])})),a.exact(a.partial({owner:a.union([a.array(a.string),a.string])})),a.array(a.string),a.array(a.string),a.array(u.oH),a.exact(a.partial({owner:a.union([a.array(a.string),a.string])})),a.array(c.wW),(0,i.gC)({maxPerPage:n.ZT}),a.exact(a.type({alertIds:a.array(a.string),caseIds:a.array(a.string)})),a.exact(a.type({casesWithAllAttachments:a.array(a.string)}))),j=a.strict({key:(0,i.D0)({codec:(0,i.tj)({fieldName:"key",min:1,max:n.NT}),pattern:"^[a-z0-9_-]+$",message:"Key must be lower case, a-z, 0-9, '_', and '-' are allowed"}),label:(0,i.tj)({fieldName:"label",min:1,max:n.Q1}),required:a.boolean}),F=a.intersection([a.strict({type:r.bQ}),j,a.exact(a.partial({defaultValue:a.union([p("defaultValue"),a.null])}))]),P=a.intersection([a.strict({type:r.g1}),j,a.exact(a.partial({defaultValue:a.union([a.boolean,a.null])}))]),N=a.intersection([a.strict({type:r.fj}),j,a.exact(a.partial({defaultValue:a.union([g({fieldName:"defaultValue"}),a.null])}))]),R=(0,i.NQ)({codec:a.union([F,P,N]),min:0,max:n.IV,fieldName:"customFields"}),I=(0,i.NQ)({min:0,max:n.p,fieldName:"observableTypes",codec:a.strict({key:(0,i.D0)({codec:(0,i.tj)({fieldName:"key",min:1,max:n.rf}),pattern:"^[a-z0-9_-]+$",message:"Key must be lower case, a-z, 0-9, '_', and '-' are allowed"}),label:(0,i.tj)({fieldName:"label",min:1,max:n.Sb})})}),V=a.intersection([a.strict({key:(0,i.D0)({codec:(0,i.tj)({fieldName:"key",min:1,max:n.Pb}),pattern:"^[a-z0-9_-]+$",message:"Key must be lower case, a-z, 0-9, '_', and '-' are allowed"}),name:(0,i.tj)({fieldName:"name",min:1,max:n.Nb}),caseFields:a.union([a.null,v])}),a.exact(a.partial({description:(0,i.tj)({fieldName:"description",min:0,max:n.Kx}),tags:(0,i.NQ)({codec:(0,i.tj)({fieldName:"template's tag",min:1,max:n.qA}),min:0,max:n.iZ,fieldName:"template's tags"})}))]),L=(0,i.NQ)({codec:V,min:0,max:n.QM,fieldName:"templates"});a.intersection([a.strict({connector:o.ab,closure_type:l._4,owner:a.string}),a.exact(a.partial({customFields:R,templates:L,observableTypes:I}))]),a.exact(a.partial({owner:a.union([a.array(a.string),a.string])})),a.strict({configuration_id:a.string}),a.intersection([a.exact(a.partial({closure_type:l.q2.type.props.closure_type,connector:l.q2.type.props.connector,customFields:R,templates:L,observableTypes:I})),a.strict({version:a.string})]);var D=s(5506),$=s(5886);const U=a.strict({total:a.number,total_deletions:a.number,total_comments:a.number,total_comment_deletions:a.number,total_other_actions:a.number,total_other_action_deletions:a.number}),B=a.intersection([$.Ww,$.VD]),z=(a.array(B),{...D.rB,action:"action",alert:"alert",user:"user",attachment:"attachment"}),q=a.keyof(z),G=(a.intersection([a.exact(a.partial({types:a.array(q),sortOrder:a.union([a.literal("desc"),a.literal("asc")])})),(0,i.gC)({maxPerPage:n.xG})]),a.strict({userActions:$.fm,page:a.number,perPage:a.number,total:a.number}),a.strict({id:a.string,index:a.string,attached_at:a.string}));a.array(G),a.intersection([a.strict({title:a.string,id:a.string,pushedDate:a.string,url:a.string}),a.exact(a.partial({comments:a.array(a.intersection([a.strict({commentId:a.string,pushedDate:a.string}),a.exact(a.partial({externalCommentId:a.string}))]))}))]),a.strict({assignees:a.array(u.p2),unassignedUsers:a.array(u.p2),participants:a.array(u.p2),reporter:u.p2}),a.intersection([a.strict({name:a.string,owners:a.array(a.string)}),a.exact(a.partial({size:(0,i.Xq)({fieldName:"size",min:1,max:n.U9})}))]);var H=s(5632);const W=a.strict({latestUserActionPushDate:a.string,oldestUserActionPushDate:a.string,externalService:H.v}),Y=a.intersection([a.strict({needsToBePushed:a.boolean,hasBeenPushed:a.boolean}),a.exact(a.partial({details:W}))]),K=(a.record(a.string,a.intersection([a.strict({push:Y}),o.ab])),a.intersection([a.strict({id:a.string,actionTypeId:a.string,name:a.string,isDeprecated:a.boolean,isPreconfigured:a.boolean,isSystemAction:a.boolean,referencedByCount:a.number}),a.exact(a.partial({config:a.record(a.string,a.unknown),isMissingSecrets:a.boolean}))]));a.array(K),a.strict({id:a.string,version:a.string,mappings:o.p2}),s(3196);let Z=function(e){return e.ALERTS_COUNT="alerts.count",e.ALERTS_USERS="alerts.users",e.ALERTS_HOSTS="alerts.hosts",e.ACTIONS_ISOLATE_HOST="actions.isolateHost",e.CONNECTORS="connectors",e.LIFESPAN="lifespan",e.MTTR="mttr",e.STATUS="status",e}({});const J=a.union([a.literal(Z.ALERTS_COUNT),a.literal(Z.ALERTS_USERS),a.literal(Z.ALERTS_HOSTS),a.literal(Z.ACTIONS_ISOLATE_HOST),a.literal(Z.CONNECTORS),a.literal(Z.LIFESPAN)]),Q=a.union([J,a.literal(Z.MTTR),a.literal(Z.STATUS)]),X=a.strict({openDuration:a.number,inProgressDuration:a.number,reopenDates:a.array(a.string)}),ee=a.strict({total:a.number,values:a.array(a.strict({name:a.union([a.string,a.undefined]),id:a.string,count:a.number}))}),te=a.strict({total:a.number,values:a.array(a.strict({name:a.string,count:a.number}))}),se=(a.strict({features:a.array(J)}),a.intersection([a.strict({features:a.array(Q)}),a.exact(a.partial({from:a.string,to:a.string,owner:a.union([a.array(a.string),a.string])}))]),a.exact(a.partial({alerts:a.exact(a.partial({count:a.number,hosts:ee,users:te})),connectors:a.strict({total:a.number}),actions:a.exact(a.partial({isolateHost:a.strict({isolate:a.strict({total:a.number}),unisolate:a.strict({total:a.number})})})),lifespan:a.strict({creationDate:a.string,closeDate:a.union([a.string,a.null]),statusInfo:X})}))),ae=a.exact(a.partial({mttr:a.union([a.number,a.null]),status:a.strict({open:a.number,inProgress:a.number,closed:a.number})})),ne=s(9122).xX,ie=a.strict({value:a.string,description:a.union([a.string,a.null])});a.strict({observable:ne}),a.strict({observable:ie}),a.strict({caseId:a.string,observables:a.array(ne)})},7070:(e,t,s)=>{"use strict";s.d(t,{BN:()=>V,Bs:()=>c,Eo:()=>p,IF:()=>f,MD:()=>w,Ox:()=>m,bi:()=>F,f7:()=>T,gP:()=>A,kT:()=>N,lF:()=>v,m1:()=>I,wL:()=>x,wh:()=>d});var a=s(3782),n=s(1629),i=s(3192),r=s(9072),l=s(6735);const o=a.strict({name:a.string,extension:a.string,mimeType:a.string,created:a.string}),c=a.strict({files:a.array(o)}),u=a.strict({created_at:a.string,created_by:r.oH,owner:a.string,pushed_at:a.union([a.string,a.null]),pushed_by:a.union([r.oH,a.null]),updated_at:a.union([a.string,a.null]),updated_by:a.union([r.oH,a.null])});a.strict({mimeType:n.gJ,filename:(0,n.tj)({fieldName:"filename",min:1,max:l.W2})});let d=function(e){return e.actions="actions",e.alert="alert",e.event="event",e.externalReference="externalReference",e.persistableState="persistableState",e.user="user",e}({});const p=a.strict({comment:a.string,type:a.literal(d.user),owner:a.string}),g=a.intersection([p,u]),m=(a.intersection([g,a.strict({id:a.string,version:a.string})]),a.strict({type:a.literal(d.event),eventId:a.union([a.array(a.string),a.string]),index:a.union([a.array(a.string),a.string]),owner:a.string})),f=a.strict({type:a.literal(d.alert),alertId:a.union([a.array(a.string),a.string]),index:a.union([a.array(a.string),a.string]),rule:a.strict({id:a.union([a.string,a.null]),name:a.union([a.string,a.null])}),owner:a.string}),y=a.intersection([f,u]),b=a.intersection([m,u]);a.intersection([y,a.strict({id:a.string,version:a.string})]),a.intersection([b,a.strict({id:a.string,version:a.string})]);const v=a.strict({type:a.literal(d.actions),comment:a.string,actions:a.strict({targets:a.array(a.strict({hostname:a.string,endpointId:a.string})),type:a.string}),owner:a.string}),h=a.intersection([v,u]);a.intersection([h,a.strict({id:a.string,version:a.string})]);let x=function(e){return e.savedObject="savedObject",e.elasticSearchDoc="elasticSearchDoc",e}({});const k=a.strict({type:a.literal(x.elasticSearchDoc)}),_=a.strict({type:a.literal(x.savedObject),soType:a.string}),C=a.strict({externalReferenceAttachmentTypeId:a.string,externalReferenceMetadata:a.union([a.null,a.record(a.string,i.aJ)]),type:a.literal(d.externalReference),owner:a.string}),T=a.strict({...C.type.props,externalReferenceId:a.string,externalReferenceStorage:k}),w=a.strict({...C.type.props,externalReferenceId:a.string,externalReferenceStorage:_}),A=a.strict({...C.type.props,externalReferenceStorage:_}),S=a.union([T,w]),E=a.union([T,A]),M=a.intersection([S,u]),O=a.intersection([E,u]),j=a.intersection([T,u]),F=(a.intersection([w,u]),a.intersection([M,a.strict({id:a.string,version:a.string})]),a.strict({type:a.literal(d.persistableState),owner:a.string,persistableStateAttachmentTypeId:a.string,persistableStateAttachmentState:a.record(a.string,i.aJ)})),P=a.intersection([F,u]),N=(a.intersection([P,a.strict({id:a.string,version:a.string})]),a.union([p,f,m,v,T,w,F])),R=a.union([g,y,b,h,M,P]),I=(a.union([g,y,b,h,j,P]),a.union([g,y,b,h,O,P]),a.intersection([R,a.strict({id:a.string,version:a.string})])),V=a.array(I);a.intersection([a.union([a.exact(a.partial(p.type.props)),a.exact(a.partial(f.type.props)),a.exact(a.partial(m.type.props)),a.exact(a.partial(v.type.props)),a.exact(a.partial(T.type.props)),a.exact(a.partial(w.type.props)),a.exact(a.partial(F.type.props))]),a.exact(a.partial(u.type.props))])},1025:(e,t,s)=>{"use strict";s.d(t,{EQ:()=>g,F$:()=>n.F,Pq:()=>p,Wm:()=>k,c6:()=>f,cf:()=>m,pG:()=>d,sx:()=>w,wW:()=>C,xv:()=>x,xx:()=>b});var a=s(3782),n=s(4395),i=s(5632),r=s(9072),l=s(2448),o=s(7070),c=s(7197),u=s(9122);const d=a.union([a.literal(n.F.open),a.literal(n.F["in-progress"]),a.literal(n.F.closed)]),p=Object.values(n.F);let g=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e}({});const m=a.union([a.literal(g.LOW),a.literal(g.MEDIUM),a.literal(g.HIGH),a.literal(g.CRITICAL)]),f=a.intersection([a.strict({syncAlerts:a.boolean}),a.exact(a.partial({extractObservables:a.boolean}))]),y={description:a.string,tags:a.array(a.string),title:a.string,connector:l.ab,severity:m,assignees:r.rh,category:a.union([a.string,a.null]),customFields:c.DH,settings:f,observables:a.array(u.kE)},b=a.exact(a.partial({...y})),v=a.strict({status:d,owner:a.string,...y}),h=a.intersection([v,a.strict({duration:a.union([a.number,a.null]),closed_at:a.union([a.string,a.null]),closed_by:a.union([r.oH,a.null]),created_at:a.string,created_by:r.oH,external_service:a.union([i.v,a.null]),updated_at:a.union([a.string,a.null]),updated_by:a.union([r.oH,a.null]),total_observables:a.union([a.number,a.null])}),a.exact(a.partial({incremental_id:a.union([a.number,a.null]),in_progress_at:a.union([a.string,a.null]),time_to_acknowledge:a.union([a.number,a.null]),time_to_investigate:a.union([a.number,a.null]),time_to_resolve:a.union([a.number,a.null])}))]),x=a.intersection([h,a.strict({id:a.string,totalComment:a.number,totalAlerts:a.number,totalEvents:a.union([a.number,a.undefined]),version:a.string}),a.exact(a.partial({comments:a.array(o.m1)}))]),k=a.array(x),_=a.strict({alerts:a.number,events:a.number,userComments:a.number}),C=a.strict({id:a.string,title:a.string,description:a.string,status:d,createdAt:a.string,totals:_}),T=a.strict({typeKey:a.string,typeLabel:a.string,value:a.string}),w=a.intersection([x,a.strict({similarities:a.strict({observables:a.array(T)})})])},2905:(e,t,s)=>{"use strict";s.d(t,{Vv:()=>C,_4:()=>c,q2:()=>h,wp:()=>T});var a=s(3782),n=s(2448),i=s(9072),r=s(7197),l=s(1025),o=s(9122);const c=a.union([a.literal("close-by-user"),a.literal("close-by-pushing")]),u=a.strict({key:a.string,label:a.string,required:a.boolean}),d=a.intersection([a.strict({type:r.bQ}),u,a.exact(a.partial({defaultValue:a.union([a.string,a.null])}))]),p=a.intersection([a.strict({type:r.g1}),u,a.exact(a.partial({defaultValue:a.union([a.boolean,a.null])}))]),g=a.intersection([a.strict({type:r.fj}),u,a.exact(a.partial({defaultValue:a.union([a.number,a.null])}))]),m=a.union([d,p,g]),f=a.array(m),y=a.array(o.uR),b=a.intersection([a.strict({key:a.string,name:a.string,caseFields:a.union([a.null,l.xx])}),a.exact(a.partial({description:a.string,tags:a.array(a.string)}))]),v=a.array(b),h=a.strict({connector:n.ab,closure_type:c,customFields:f,templates:v,observableTypes:y}),x=a.intersection([h,a.strict({owner:a.string})]),k=a.strict({created_at:a.string,created_by:i.oH,updated_at:a.union([a.string,a.null]),updated_by:a.union([i.oH,a.null])}),_=a.intersection([x,k]),C=a.intersection([_,a.strict({id:a.string,version:a.string,error:a.union([a.string,a.null]),owner:a.string,mappings:n.p2})]),T=a.array(C)},2448:(e,t,s)=>{"use strict";s.d(t,{J4:()=>n,NI:()=>x,aL:()=>f,ab:()=>k,p2:()=>A});var a=s(3782);let n=function(e){return e.casesWebhook=".cases-webhook",e.jira=".jira",e.none=".none",e.resilient=".resilient",e.serviceNowITSM=".servicenow",e.serviceNowSIR=".servicenow-sir",e.swimlane=".swimlane",e.theHive=".thehive",e}({});const i=a.strict({type:a.literal(n.casesWebhook),fields:a.null}),r=a.intersection([a.strict({issueType:a.union([a.string,a.null]),priority:a.union([a.string,a.null]),parent:a.union([a.string,a.null])}),a.exact(a.partial({otherFields:a.union([a.string,a.null])}))]),l=a.strict({type:a.literal(n.jira),fields:a.union([r,a.null])}),o=a.intersection([a.strict({incidentTypes:a.union([a.array(a.string),a.null]),severityCode:a.union([a.string,a.null])}),a.exact(a.partial({additionalFields:a.union([a.string,a.null])}))]),c=a.intersection([a.strict({type:a.literal(n.resilient),fields:a.union([o,a.null])}),a.exact(a.partial({additionalFields:a.union([a.string,a.null])}))]),u=a.intersection([a.strict({impact:a.union([a.string,a.null]),severity:a.union([a.string,a.null]),urgency:a.union([a.string,a.null]),category:a.union([a.string,a.null]),subcategory:a.union([a.string,a.null])}),a.exact(a.partial({additionalFields:a.union([a.string,a.null])}))]),d=a.strict({type:a.literal(n.serviceNowITSM),fields:a.union([u,a.null])}),p=a.intersection([a.strict({category:a.union([a.string,a.null]),destIp:a.union([a.boolean,a.null]),malwareHash:a.union([a.boolean,a.null]),malwareUrl:a.union([a.boolean,a.null]),priority:a.union([a.string,a.null]),sourceIp:a.union([a.boolean,a.null]),subcategory:a.union([a.string,a.null])}),a.exact(a.partial({additionalFields:a.union([a.string,a.null])}))]),g=a.strict({type:a.literal(n.serviceNowSIR),fields:a.union([p,a.null])}),m=a.strict({caseId:a.union([a.string,a.null])});let f=function(e){return e.All="all",e.Alerts="alerts",e.Cases="cases",e}({});const y=a.strict({type:a.literal(n.swimlane),fields:a.union([m,a.null])}),b=a.strict({tlp:a.union([a.number,a.null])}),v=a.strict({type:a.literal(n.theHive),fields:a.union([b,a.null])}),h=a.strict({type:a.literal(n.none),fields:a.null}),x=(a.union([i,l,h,c,d,g,y,v]),a.union([a.intersection([i,a.strict({name:a.string})]),a.intersection([l,a.strict({name:a.string})]),a.intersection([h,a.strict({name:a.string})]),a.intersection([c,a.strict({name:a.string})]),a.intersection([d,a.strict({name:a.string})]),a.intersection([g,a.strict({name:a.string})]),a.intersection([y,a.strict({name:a.string})]),a.intersection([v,a.strict({name:a.string})])])),k=a.intersection([a.strict({id:a.string}),x]),_=a.union([a.literal("append"),a.literal("nothing"),a.literal("overwrite")]),C=a.union([a.literal("title"),a.literal("description"),a.literal("comments"),a.literal("tags")]),T=a.union([a.string,a.literal("not_mapped")]),w=a.strict({action_type:_,source:C,target:T}),A=a.array(w);a.strict({mappings:A,owner:a.string})},7197:(e,t,s)=>{"use strict";s.d(t,{DH:()=>p,bQ:()=>i,fj:()=>l,g1:()=>r,je:()=>n,u2:()=>c});var a=s(3782);let n=function(e){return e.TEXT="text",e.TOGGLE="toggle",e.NUMBER="number",e}({});const i=a.literal(n.TEXT),r=a.literal(n.TOGGLE),l=a.literal(n.NUMBER),o=a.strict({key:a.string,type:i,value:a.union([a.string,a.null])}),c=a.strict({key:a.string,type:r,value:a.union([a.boolean,a.null])}),u=a.strict({key:a.string,type:l,value:a.union([a.number,a.null])}),d=a.union([o,c,u]),p=a.array(d)},5632:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i,v:()=>r});var a=s(3782),n=s(9072);const i=a.strict({connector_name:a.string,external_id:a.string,external_title:a.string,external_url:a.string,pushed_at:a.string,pushed_by:n.oH}),r=a.intersection([a.strict({connector_id:a.string}),i])},6013:(e,t,s)=>{"use strict";s.d(t,{wh:()=>o.wh,u2:()=>n.u2,xv:()=>r.xv,EQ:()=>r.EQ,cf:()=>r.cf,pG:()=>r.pG,F$:()=>r.F$,Wm:()=>r.Wm,Vv:()=>a.Vv,wp:()=>a.wp,J4:()=>l.J4,fj:()=>n.fj,bQ:()=>n.bQ,g1:()=>n.g1,je:()=>n.je,wL:()=>o.wL,Bs:()=>o.Bs,aL:()=>l.aL,zS:()=>i.zS,rB:()=>i.rB,fm:()=>i.fm,Pq:()=>r.Pq});var a=s(2905),n=s(7197),i=s(5886),r=(s(5632),s(1025)),l=(s(9072),s(2448)),o=s(7070);s(9122)},9122:(e,t,s)=>{"use strict";s.d(t,{kE:()=>i,uR:()=>r,xX:()=>n});var a=s(3782);const n=a.strict({typeKey:a.string,value:a.string,description:a.union([a.string,a.null])}),i=a.intersection([a.strict({id:a.string,createdAt:a.string,updatedAt:a.union([a.string,a.null])}),n]),r=a.strict({key:a.string,label:a.string})},9072:(e,t,s)=>{"use strict";s.d(t,{FW:()=>l,oH:()=>i,p2:()=>r,rh:()=>o});var a=s(3782);const n=a.strict({email:a.union([a.undefined,a.null,a.string]),full_name:a.union([a.undefined,a.null,a.string]),username:a.union([a.undefined,a.null,a.string])}),i=a.intersection([n,a.exact(a.partial({profile_uid:a.string}))]),r=a.intersection([a.strict({user:n}),a.exact(a.partial({uid:a.string})),a.exact(a.partial({avatar:a.exact(a.partial({initials:a.union([a.string,a.null]),color:a.union([a.string,a.null]),imageUrl:a.union([a.string,a.null])}))}))]),l=(a.array(i),a.strict({uid:a.string})),o=a.array(l)},5506:(e,t,s)=>{"use strict";s.d(t,{pC:()=>r,rB:()=>n,zS:()=>i});var a=s(3782);const n={assignees:"assignees",comment:"comment",connector:"connector",description:"description",pushed:"pushed",tags:"tags",title:"title",status:"status",settings:"settings",severity:"severity",create_case:"create_case",delete_case:"delete_case",category:"category",customFields:"customFields",observables:"observables"},i={add:"add",create:"create",delete:"delete",update:"update",push_to_service:"push_to_service"},r=a.keyof(i)},5886:(e,t,s)=>{"use strict";s.d(t,{Ww:()=>le,VD:()=>ee,zS:()=>i.zS,rB:()=>i.rB,fm:()=>ue});var a=s(3782),n=s(9072),i=s(5506);const r=a.strict({assignees:n.rh}),l=a.strict({type:a.literal(i.rB.assignees),payload:r}),o=a.strict({category:a.union([a.string,a.null])}),c=a.strict({type:a.literal(i.rB.category),payload:o});var u=s(3196),d=s(7070);const p=a.strict({comment:d.kT}),g=a.strict({comment:u.zA}),m=a.strict({type:a.literal(i.rB.comment),payload:p}),f=a.strict({type:a.literal(i.rB.comment),payload:g});var y=s(2448);const b=a.strict({connector:y.NI}),v=a.strict({connector:y.ab}),h=a.strict({type:a.literal(i.rB.connector),payload:b}),x=a.strict({type:a.literal(i.rB.connector),payload:v});var k=s(7197);const _=a.strict({customFields:k.DH}),C=a.strict({type:a.literal(i.rB.customFields),payload:_}),T=a.strict({description:a.string}),w=a.strict({type:a.literal(i.rB.description),payload:T}),A=a.strict({settings:a.partial({syncAlerts:a.boolean,extractObservables:a.boolean})}),S=a.strict({type:a.literal(i.rB.settings),payload:A}),E=a.strict({tags:a.array(a.string)}),M=a.strict({type:a.literal(i.rB.tags),payload:E}),O=a.strict({title:a.string}),j=a.strict({type:a.literal(i.rB.title),payload:O}),F=a.strict({type:a.literal(i.rB.create_case)}),P=a.strict({assignees:r.type.props.assignees,description:T.type.props.description,status:a.string,severity:a.string,tags:E.type.props.tags,title:O.type.props.title,settings:A.type.props.settings,owner:a.string}),N=a.exact(a.partial({category:o.type.props.category,customFields:_.type.props.customFields})),R=a.intersection([P,N]),I=a.intersection([F,a.strict({payload:a.intersection([v,R])})]),V=a.intersection([F,a.strict({payload:a.intersection([b,R])})]),L=a.strict({type:a.literal(i.rB.delete_case),payload:a.strict({})});var D=s(5632);const $=a.strict({externalService:D.Z}),U=a.strict({externalService:D.v}),B=a.strict({type:a.literal(i.rB.pushed),payload:$}),z=a.strict({type:a.literal(i.rB.pushed),payload:U});var q=s(1025);const G=a.strict({severity:q.cf}),H=a.strict({type:a.literal(i.rB.severity),payload:G}),W=a.strict({status:q.pG}),Y=a.strict({type:a.literal(i.rB.status),payload:W}),K=a.union([a.literal("add"),a.literal("delete"),a.literal("update")]),Z=a.strict({count:a.number,actionType:K}),J=a.strict({observables:Z}),Q=a.strict({type:a.literal(i.rB.observables),payload:J}),X=a.strict({created_at:a.string,created_by:n.oH,owner:a.string,action:i.pC}),ee=a.strict({action_id:a.string,case_id:a.string,comment_id:a.union([a.string,a.null])}),te=a.strict({comment_id:a.union([a.string,a.null])}),se=a.union([w,M,j,S,Y,H,l,L,c,C,Q]),ae=a.union([se,m]),ne=a.union([se,f]),ie=a.union([ae,I,x,z]),re=a.union([ne,V,h,B]),le=a.intersection([ie,X]),oe=(a.intersection([re,X]),a.intersection([le,te])),ce=a.intersection([oe,a.strict({id:a.string,version:a.string})]),ue=a.array(ce)},7297:(e,t,s)=>{"use strict";s.d(t,{ls:()=>a.ls,xv:()=>a.xv});var a=s(3844)},3844:(e,t,s)=>{"use strict";s.d(t,{ls:()=>a,xv:()=>n});const a=["asc","desc"];let n=function(e){return e.closedAt="closedAt",e.createdAt="createdAt",e.updatedAt="updatedAt",e.severity="severity",e.status="status",e.title="title",e.category="category",e}({})},3728:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var a=s(6735);const n=()=>({all:[a.Uy,a.IM,a.ty,a.sc,a.Gp],read:[a.IM,a.Gp],delete:[a.lZ],settings:[a.jP],reopenCase:[a.Nk],createComment:[a.yH],assignCase:[a.gT]})},8849:(e,t,s)=>{"use strict";s.d(t,{bW:()=>n,i7:()=>i});var a=s(6735);const n=()=>a.f2,i=e=>`${a.Xt}/connector/${e}/_execute`},2727:(e,t,s)=>{"use strict";s.d(t,{Cj:()=>l,V1:()=>r,yi:()=>i});var a=s(2708),n=s(6735);const i=e=>Object.keys(n.lO).includes(e),r=e=>{var t;return null===(t=Object.values(n.lO).find((t=>t.appId===e)))||void 0===t?void 0:t.id},l=({consumer:e,producer:t,serverlessProjectType:s})=>{if(s){const e=Object.entries(n.lO).find((([,e])=>e.serverlessProjectType===s));return e?e[1].id:n.lO.cases.id}const i=e===a.Ov.ALERTS?t:e;for(const e of Object.values(n.lO)){var r;if(null===(r=e.validRuleConsumers)||void 0===r?void 0:r.find((e=>e===i||e===t)))return e.id}return n.lO.cases.id}},5408:(e,t,s)=>{"use strict";s.d(t,{N:()=>c});var a=s(4286),n=s(9113),i=s(6735),r=s(3867),l=s(4124),o=s(9942);const c=()=>{const{analytics:e}=(0,r.o1)().services,{owner:t}=(0,l.g)();return(0,a.useCallback)(((s,a)=>{a.some((e=>e.type===n.AttachmentType.event))&&e.reportEvent(i.L8,{owner:t[0]&&(0,o.q)(t[0])?t[0]:"unknown",attachment_source:s})}),[e,t])}},2196:(e,t,s)=>{"use strict";s.d(t,{Ho:()=>d,ME:()=>u,_p:()=>p,wl:()=>c});var a=s(1639),n=s(166),i=s(6730),r=s(3198),l=s(6338),o=s(9113);const c=e=>(0,i.pipe)(r.aI.decode(e),(0,a.fold)((0,o.throwErrors)(l.jT),n.identity)),u=e=>(0,i.pipe)(r.qd.decode(e),(0,a.fold)((0,o.throwErrors)(l.jT),n.identity)),d=e=>((0,i.pipe)(r.nO.decode(e),(0,a.fold)((0,o.throwErrors)(l.jT),n.identity)),e),p=e=>(0,i.pipe)(r.e9.decode(e),(0,a.fold)((0,o.throwErrors)(l.jT),n.identity))},2537:(e,t,s)=>{"use strict";s.d(t,{Eh:()=>r,es:()=>o,lY:()=>l});var a=s(6735),n=s(9614),i=s(2196);const r=async({http:e,signal:t,query:s})=>{const r=await e.get(a.pj,{query:s,signal:t});return(0,n.Dl)((0,i.wl)(r))},l=async({http:e,signal:t,query:s})=>{const r=await e.get(a.q4,{signal:t,query:s});return(0,n.fp)((0,i.ME)(r))},o=async({http:e,signal:t,params:s})=>{const n=await e.post(a.WR,{body:JSON.stringify({...s}),signal:t});return(0,i.Ho)(n)}},9614:(e,t,s)=>{"use strict";s.d(t,{Dl:()=>y,cq:()=>r,T2:()=>p,vZ:()=>d,FA:()=>o,eD:()=>c,dh:()=>b,fp:()=>l,XA:()=>m});var a=s(5079),n=s(770),i=s(6013);const r=e=>e.reduce(((e,t)=>((0,n.isArray)(t)?e.push(r(t)):(0,n.isObject)(t)?e.push(l(t)):e.push(t),e)),[]),l=e=>Object.entries(e).reduce(((e,[t,s])=>((0,n.isArray)(s)?(0,a.set)(e,(0,n.camelCase)(t),r(s)):(0,n.isObject)(s)?(0,a.set)(e,(0,n.camelCase)(t),l(s)):(0,a.set)(e,(0,n.camelCase)(t),s),e)),{}),o=e=>{const{comments:t,...s}=e;return{...l(s),...null!=t?{comments:p(t)}:{}}},c=e=>e.map(o),u=e=>{const{comments:t,...s}=e;return{...l(s)}},d=e=>{const{case:t,...s}=e;return{...l(s),case:o(t)}},p=e=>e.map((e=>g(e))),g=e=>e.type===i.wh.externalReference?f(e,"externalReferenceMetadata"):e.type===i.wh.persistableState?f(e,"persistableStateAttachmentState"):l(e),m=e=>e.map((e=>{if((e=>{var t;return(null==e?void 0:e.type)===i.rB.comment&&null!=(null==e||null===(t=e.payload)||void 0===t?void 0:t.comment)})(e)){const t=(0,n.omit)(e,"payload.comment");return{...l(t),payload:{comment:g(e.payload.comment)}}}return l(e)})),f=(e,t)=>{const s=(0,n.get)(e,t),a=(0,n.omit)(e,t);return{...l(a),[t]:s}},y=e=>({cases:c(e.cases),countOpenCases:e.count_open_cases,countInProgressCases:e.count_in_progress_cases,countClosedCases:e.count_closed_cases,page:e.page,perPage:e.per_page,total:e.total}),b=e=>{return{cases:(t=e.cases,t.map(u)),page:e.page,perPage:e.per_page,total:e.total};var t}},8274:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=function(e){return e.BUTTON="button",e.CUSTOM="custom",e}({})},5630:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var a=s(6735),n=s(3222);const i=e=>(t=[a.qN,a.tn,a.V0])=>({...t.reduce(((t,s)=>{const a=(0,n.r)(e[r(s)]);t.create=t.create||a.create,t.read=t.read||a.read,t.update=t.update||a.update,t.delete=t.delete||a.delete,t.push=t.push||a.push,t.connectors=t.connectors||a.connectors,t.settings=t.settings||a.settings,t.reopenCase=t.reopenCase||a.reopenCase,t.createComment=t.createComment||a.createComment,t.assign=t.assign||a.assign;const i=t.create&&t.read&&t.update&&t.delete&&t.push&&t.connectors&&t.settings&&t.reopenCase&&t.createComment&&t.assign;return t.all=t.all||a.all||i,t}),{all:!1,create:!1,read:!1,update:!1,delete:!1,push:!1,connectors:!1,settings:!1,reopenCase:!1,createComment:!1,assign:!1})}),r=e=>e===a.V0?a.hL:`${e}CasesV3`},3222:(e,t,s)=>{"use strict";s.d(t,{r:()=>n});var a=s(6735);const n=e=>{const t=!(null==e||!e[a.Uy]),s=!(null==e||!e[a.IM]),n=!(null==e||!e[a.ty]),i=!(null==e||!e[a.lZ]),r=!(null==e||!e[a.sc]),l=!(null==e||!e[a.Gp]),o=!(null==e||!e[a.jP]),c=!(null==e||!e[a.Nk]),u=!(null==e||!e[a.yH]),d=!(null==e||!e[a.gT]);return{all:t&&s&&n&&i&&r&&l&&o&&c&&u&&d,create:t,read:s,update:n,delete:i,push:r,connectors:l,settings:o,reopenCase:c,createComment:u,assign:d}}},7033:(e,t,s)=>{"use strict";s.d(t,{n:()=>c,z:()=>o});var a=s(4286),n=s(1319),i=s(6558),r=s(6791);const l=(0,a.lazy)((()=>Promise.all([s.e(177),s.e(126),s.e(847)]).then(s.bind(s,7482)))),o=({externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s,owner:o,permissions:c,hiddenStatuses:u,onRowClick:d,onClose:p})=>(0,r.jsx)(i.CasesProvider,{value:{externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s,owner:o,permissions:c}},(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(n.EuiLoadingSpinner,null)},(0,r.jsx)(l,{hiddenStatuses:u,onRowClick:d,onClose:p}))),c=({hiddenStatuses:e,onRowClick:t,onClose:s,getAttachments:i})=>(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(n.EuiLoadingSpinner,null)},(0,r.jsx)(l,{hiddenStatuses:e,onRowClick:t,onClose:s,getAttachments:i}))},7659:(e,t,s)=>{"use strict";s.d(t,{M:()=>o});var a=s(1319),n=s(4286),i=s(6558),r=s(6791);const l=(0,n.lazy)((()=>Promise.all([s.e(678),s.e(177),s.e(126),s.e(657),s.e(536)]).then(s.bind(s,4536)))),o=({externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s,owner:o,permissions:c,basePath:u,actionsNavigation:d,ruleDetailsNavigation:p,showAlertDetails:g,useFetchAlertData:m,onAlertsTableLoaded:f,refreshRef:y,timelineIntegration:b,features:v,releasePhase:h,renderAlertsTable:x,renderEventsTable:k})=>(0,r.jsx)(i.CasesProvider,{value:{externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s,owner:o,permissions:c,basePath:u,features:v,releasePhase:h}},(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)(a.EuiLoadingSpinner,null)},(0,r.jsx)(l,{actionsNavigation:d,ruleDetailsNavigation:p,showAlertDetails:g,useFetchAlertData:m,onAlertsTableLoaded:f,refreshRef:y,timelineIntegration:b,renderAlertsTable:x,renderEventsTable:k})))},3170:(e,t,s)=>{"use strict";s.d(t,{g:()=>c,S:()=>o});var a=s(4286),n=s(6013),i=s(3867);const r={managed:!0},l=()=>{const{apm:e}=(0,i.o1)().services;return{startTransaction:(0,a.useCallback)(((t,{type:s="user-interaction",options:a=r}={})=>null==e?void 0:e.startTransaction(t,s,a)),[e])}},o=()=>{const{startTransaction:e}=l();return{startTransaction:(0,a.useCallback)((({appId:t,attachments:s}={})=>{if(!t)return;if(!s)return e(`Cases [${t}] createCase`);const a=u(s);if(a<=1)return e(`Cases [${t}] addAttachmentToNewCase`);const n=e(`Cases [${t}] bulkAddAttachmentsToNewCase`);return null==n||n.addLabels({alert_count:a}),n}),[e])}},c=()=>{const{startTransaction:e}=l();return{startTransaction:(0,a.useCallback)((({appId:t,attachments:s})=>{if(!t)return;const a=u(s);if(a<=1)return e(`Cases [${t}] addAttachmentToExistingCase`);const n=e(`Cases [${t}] bulkAddAttachmentsToExistingCase`);return null==n||n.addLabels({alert_count:a}),n}),[e])}},u=e=>e.reduce(((e,t)=>t.type!==n.wh.alert?e:Array.isArray(t.alertId)?e+t.alertId.length:e+1),0)},3867:(e,t,s)=>{"use strict";s.d(t,{Xf:()=>u.Xf,P7:()=>KibanaServices,Ix:()=>b,iZ:()=>f,NR:()=>d,qs:()=>m,o1:()=>u.o1,cq:()=>y,pH:()=>p,Yf:()=>g,UW:()=>u.UW});var a=s(2488),n=s.n(a),i=s(4286),r=s(5008),l=s(3222),o=s(9614),c=s(6735),u=s(5083);const d=()=>(0,u.SZ)(c.D2),p=()=>{const e=(0,u.SZ)(c.Oh);return"Browser"===e?n().tz.guess():e},g=()=>(0,u.o1)().services.notifications.toasts,m=()=>(0,u.o1)().services.http,f=()=>{const[e,t]=(0,i.useState)(null),s=g(),{security:a}=(0,u.o1)().services,n=(0,i.useCallback)((()=>{let e=!1;return(async()=>{try{if(null!=a){const s=await a.authc.getCurrentUser();e||t((0,o.fp)(s))}else t({username:r.i18n.translate("xpack.cases.getCurrentUser.unknownUser",{defaultMessage:"Unknown"}),email:"",fullName:"",roles:[],enabled:!1,authenticationRealm:{name:"",type:""},lookupRealm:{name:"",type:""},authenticationProvider:""})}catch(a){e||(s.addError(a.body&&a.body.message?new Error(a.body.message):a,{title:r.i18n.translate("xpack.cases.getCurrentUser.Error",{defaultMessage:"Error getting user"})}),t(null))}})(),()=>{e=!0}}),[a,s]);return(0,i.useEffect)((()=>{n()}),[n]),e},y=e=>{const{navigateTo:t}=(e=>{const{navigateToApp:t,navigateToUrl:s}=(0,u.o1)().services.application;return{navigateTo:(0,i.useCallback)((({url:a,...n})=>{a?s(a):t(null!=e?e:"",n)}),[e,t,s])}})(e),{getAppUrl:s}=(e=>{const{getUrlForApp:t}=(0,u.o1)().services.application;return{getAppUrl:(0,i.useCallback)((s=>t(null!=e?e:"",s)),[e,t])}})(e);return{navigateTo:t,getAppUrl:s}},b=()=>{var e,t,s,a,n,r,o,d;const p=null===(e=(0,u.o1)().services)||void 0===e||null===(t=e.application)||void 0===t?void 0:t.capabilities,g=p[c.hL],m=(0,l.r)(g);return(0,i.useMemo)((()=>{var e,t,s,a,n,i;return{actions:{crud:!(null===(e=p.actions)||void 0===e||!e.save),read:!(null===(t=p.actions)||void 0===t||!t.show)},generalCasesV3:{all:m.all,create:m.create,read:m.read,update:m.update,delete:m.delete,push:m.push,connectors:m.connectors,settings:m.settings,reopenCase:m.reopenCase,createComment:m.createComment,assign:m.assign},visualize:{crud:!(null===(s=p.visualize_v2)||void 0===s||!s.save),read:!(null===(a=p.visualize_v2)||void 0===a||!a.show)},dashboard:{crud:!(null===(n=p.dashboard_v2)||void 0===n||!n.createNew),read:!(null===(i=p.dashboard_v2)||void 0===i||!i.show)}}}),[null===(s=p.actions)||void 0===s?void 0:s.save,null===(a=p.actions)||void 0===a?void 0:a.show,null===(n=p.dashboard_v2)||void 0===n?void 0:n.createNew,null===(r=p.dashboard_v2)||void 0===r?void 0:r.show,null===(o=p.visualize_v2)||void 0===o?void 0:o.save,null===(d=p.visualize_v2)||void 0===d?void 0:d.show,m.all,m.create,m.read,m.update,m.delete,m.push,m.connectors,m.settings,m.reopenCase,m.createComment,m.assign])};var v=s(8915);class KibanaServices{static init({application:e,config:t,http:s,serverless:a,kibanaVersion:n,...i}){this.services={application:e,http:s,serverless:a,...i},this.kibanaVersion=n,this.config=t}static get(){return this.services||this.throwUninitializedError(),this.services}static getKibanaVersion(){return this.kibanaVersion||this.throwUninitializedError(),this.kibanaVersion}static getConfig(){return this.config}static throwUninitializedError(){throw new Error("Kibana services not initialized - are you trying to import this module from outside of the Cases app?")}}(0,v.default)(KibanaServices,"kibanaVersion",void 0),(0,v.default)(KibanaServices,"services",void 0),(0,v.default)(KibanaServices,"config",void 0)},5083:(e,t,s)=>{"use strict";s.d(t,{SZ:()=>a.useUiSetting,UW:()=>a.useUiSetting$,Xf:()=>a.KibanaContextProvider,o1:()=>n});var a=s(409);const n=()=>(0,a.useKibana)()},6467:(e,t,s)=>{"use strict";s.d(t,{Y:()=>r});var a=s(7880),n=s(5083);const i=e=>{let t;return(e=>"value"in e)(e)&&(t=e.value),(0,a.A)(e,t)},r=()=>{var e,t,s,a;const{currentAppId$:r,applications$:l}=(0,n.o1)().services.application,o=i(r),c=i(l);return{appId:o,appTitle:o?null!==(e=null==c||null===(t=c.get(o))||void 0===t||null===(s=t.category)||void 0===s?void 0:s.label)&&void 0!==e?e:null==c||null===(a=c.get(o))||void 0===a?void 0:a.title:void 0}}},6753:(e,t,s)=>{"use strict";s.d(t,{H:()=>y,TG:()=>u,dd:()=>b,g4:()=>m,uP:()=>f,zm:()=>d});var a=s(4286),n=s(1493),i=s(6735),r=s(3867),l=s(6497),o=s(7402),c=s(6467);const u=()=>(0,n.useParams)();function d(){const{search:e}=(0,n.useLocation)(),[t,s]=(0,a.useState)((()=>(0,o.vx)(e))),i=(0,a.useCallback)(((e=t)=>(0,o.sn)(e)),[t]);return(0,a.useEffect)((()=>{s((0,o.vx)(e))}),[e]),{urlParams:t,toUrlParams:i}}const p=({path:e,deepLinkId:t})=>{const{appId:s}=(0,c.Y)(),{navigateTo:n,getAppUrl:i}=(0,r.cq)(s);return[(0,a.useCallback)((s=>i({path:e,deepLinkId:t,absolute:s})),[i,t,e]),(0,a.useCallback)((()=>n({path:e,deepLinkId:t})),[n,t,e])]},g={all:{path:"/"},create:{path:i.Jv},configure:{path:i.$$}},m=()=>{const[e,t]=p({path:g.all.path,deepLinkId:i.sZ});return{getAllCasesUrl:e,navigateToAllCases:t}},f=()=>{const[e,t]=p({path:g.create.path,deepLinkId:i.sZ});return{getCreateCaseUrl:e,navigateToCreateCase:t}},y=()=>{const[e,t]=p({path:g.configure.path,deepLinkId:i.sZ});return{getConfigureCasesUrl:e,navigateToConfigureCases:t}},b=()=>{const{appId:e}=(0,c.Y)(),{navigateTo:t,getAppUrl:s}=(0,r.cq)(e),n=i.sZ;return{getCaseViewUrl:(0,a.useCallback)(((e,t)=>s({deepLinkId:n,absolute:t,path:(0,l._M)(e)})),[n,s]),navigateToCaseView:(0,a.useCallback)((e=>t({deepLinkId:n,path:(0,l._M)(e)})),[t,n])}}},4345:(e,t,s)=>{"use strict";s.d(t,{Bu:()=>i,Cy:()=>n.Cy,_M:()=>n._M,F4:()=>n.F4,Sg:()=>n.Sg,$k:()=>n.$k,Rh:()=>r,uC:()=>n.uC,g4:()=>l.g4,dd:()=>l.dd,TG:()=>l.TG,H:()=>l.H,uP:()=>l.uP,zm:()=>l.zm});var a=s(5008),n=s(6497);const i={cases:"cases",casesCreate:"cases_create",casesConfigure:"cases_configure"},r=({basePath:e=n.Cy,extend:t={}})=>{var s,r,l;return{title:a.i18n.translate("xpack.cases.navigation.cases",{defaultMessage:"Cases"}),...null!==(s=t[i.cases])&&void 0!==s?s:{},id:i.cases,path:e,deepLinks:[{title:a.i18n.translate("xpack.cases.navigation.create",{defaultMessage:"Create"}),...null!==(r=t[i.casesCreate])&&void 0!==r?r:{},id:i.casesCreate,path:(0,n.uC)(e)},{title:a.i18n.translate("xpack.cases.navigation.settings",{defaultMessage:"Settings"}),...null!==(l=t[i.casesConfigure])&&void 0!==l?l:{},id:i.casesConfigure,path:(0,n.$k)(e)}]}};var l=s(6753)},6497:(e,t,s)=>{"use strict";s.d(t,{$k:()=>o,Cy:()=>i,F4:()=>c,Sg:()=>u,_M:()=>d,uC:()=>l});var a=s(1493),n=s(6735);const i="/cases",r=e=>e.replaceAll("//","/"),l=e=>r(`${e}${n.Jv}`),o=e=>r(`${e}${n.$$}`),c=e=>r(`${e}${n.l9}`),u=e=>r(`${e}${n.N_}`),d=e=>{const{commentId:t,tabId:s}=e;return r(t?(0,a.generatePath)(n.N_,e):void 0!==s?(0,a.generatePath)(n.Nt,e):(0,a.generatePath)(n.l9,e))}},8228:(e,t,s)=>{"use strict";s.d(t,{$4:()=>ce,$w:()=>re,Ai:()=>Ee,B_:()=>xe,C$:()=>U,Ch:()=>q,Cn:()=>T,Co:()=>Ce,Cw:()=>ye,FH:()=>g,GT:()=>D,Gc:()=>b,Gm:()=>u,HV:()=>G,Hk:()=>l,Kd:()=>r,Kx:()=>de,MG:()=>$,My:()=>N,N$:()=>y,P7:()=>ge,PN:()=>Se,PW:()=>R,R6:()=>M,TO:()=>A,TT:()=>z,Un:()=>ke,V$:()=>V,Vg:()=>Me,W:()=>X,W0:()=>B,XJ:()=>E,XS:()=>ae,ZD:()=>L,ZS:()=>me,Zl:()=>ne,Zr:()=>ue,_E:()=>fe,_G:()=>Te,aE:()=>ve,bO:()=>n,dC:()=>we,dr:()=>J,dv:()=>Ae,eh:()=>Q,ez:()=>Y,gJ:()=>k,gp:()=>S,hW:()=>_e,iZ:()=>O,j0:()=>h,jF:()=>w,k:()=>ie,kl:()=>j,lm:()=>C,m2:()=>te,mr:()=>F,o4:()=>ee,oA:()=>le,o_:()=>o,pI:()=>_,pj:()=>m,pk:()=>v,qY:()=>oe,r_:()=>P,tC:()=>f,tU:()=>W,tt:()=>d,u3:()=>x,uJ:()=>se,uU:()=>p,up:()=>pe,v9:()=>he,vM:()=>i,vN:()=>K,x2:()=>be,x9:()=>H,xD:()=>Z,yv:()=>I,zj:()=>c});var a=s(5008);a.i18n.translate("xpack.cases.caseView.backLabel",{defaultMessage:"Back to cases"});const n=a.i18n.translate("xpack.cases.caseView.cancel",{defaultMessage:"Cancel"}),i=(e=1)=>a.i18n.translate("xpack.cases.confirmDeleteCase.deleteCase",{values:{quantity:e},defaultMessage:"Delete {quantity, plural, =1 {case} other {{quantity} cases}}"}),r=a.i18n.translate("xpack.cases.caseView.copyID",{defaultMessage:"Copy case ID"}),l=a.i18n.translate("xpack.cases.caseView.copyIDSuccess",{defaultMessage:"Copied case ID to clipboard"}),o=a.i18n.translate("xpack.cases.caseView.name",{defaultMessage:"Name"}),c=a.i18n.translate("xpack.cases.caseView.createdOn",{defaultMessage:"Created on"}),u=a.i18n.translate("xpack.cases.caseView.updatedOn",{defaultMessage:"Updated on"}),d=a.i18n.translate("xpack.cases.caseView.closedOn",{defaultMessage:"Closed on"}),p=a.i18n.translate("xpack.cases.caseView.reporterLabel",{defaultMessage:"Reporter"}),g=a.i18n.translate("xpack.cases.caseView.particpantsLabel",{defaultMessage:"Participants"}),m=a.i18n.translate("xpack.cases.caseView.create",{defaultMessage:"Create case"}),f=a.i18n.translate("xpack.cases.caseView.description",{defaultMessage:"Description"}),y=a.i18n.translate("xpack.cases.createCase.descriptionFieldRequiredError",{defaultMessage:"A description is required."}),b=(a.i18n.translate("xpack.cases.createCase.solutionFieldRequiredError",{defaultMessage:"A solution is required"}),a.i18n.translate("xpack.cases.createCase.ariaKeypadSolutionSelection",{defaultMessage:"Single solution select"}),a.i18n.translate("xpack.cases.caseView.commentFieldRequiredError",{defaultMessage:"Empty comments are not allowed."})),v=(a.i18n.translate("xpack.cases.caseView.fieldRequiredError",{defaultMessage:"Required field"}),a.i18n.translate("xpack.cases.caseView.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.cases.caseView.optional",{defaultMessage:"Optional"})),h=a.i18n.translate("xpack.cases.pageTitle",{defaultMessage:"Cases"}),x=a.i18n.translate("xpack.cases.caseView.createCase",{defaultMessage:"Create case"}),k=a.i18n.translate("xpack.cases.caseView.closeCase",{defaultMessage:"Close case"}),_=a.i18n.translate("xpack.cases.caseView.markInProgress",{defaultMessage:"Mark in progress"}),C=a.i18n.translate("xpack.cases.caseView.reopenCase",{defaultMessage:"Reopen case"}),T=a.i18n.translate("xpack.cases.caseView.openCase",{defaultMessage:"Open case"}),w=a.i18n.translate("xpack.cases.caseView.caseName",{defaultMessage:"Case name"}),A=a.i18n.translate("xpack.cases.caseView.to",{defaultMessage:"to"}),S=a.i18n.translate("xpack.cases.caseView.tags",{defaultMessage:"Tags"}),E=a.i18n.translate("xpack.cases.caseView.category",{defaultMessage:"Category"}),M=a.i18n.translate("xpack.cases.caseView.categories",{defaultMessage:"Categories"}),O=a.i18n.translate("xpack.cases.caseView.solution",{defaultMessage:"Solution"}),j=a.i18n.translate("xpack.cases.allCases.actions",{defaultMessage:"Actions"}),F=e=>a.i18n.translate("xpack.cases.allCases.actions.button.ariaLabel",{defaultMessage:'Actions for "{title}" column',values:{title:e}}),P=(a.i18n.translate("xpack.cases.allCases.noTagsAvailable",{defaultMessage:"No tags available"}),a.i18n.translate("xpack.cases.caseView.noReportersAvailable",{defaultMessage:"No reporters available."}),a.i18n.translate("xpack.cases.allCases.noCategoriesAvailable",{defaultMessage:"No categories available"}),a.i18n.translate("xpack.cases.allCases.comments",{defaultMessage:"Comments"})),N=a.i18n.translate("xpack.cases.createCase.fieldTagsHelpText",{defaultMessage:"Separate tags with a line break."}),R=a.i18n.translate("xpack.cases.createCase.fieldTagsEmptyError",{defaultMessage:"A tag must contain at least one non-space character."}),I=a.i18n.translate("xpack.cases.caseView.noTags",{defaultMessage:"No tags are added"}),V=a.i18n.translate("xpack.cases.caseView.noCategories",{defaultMessage:"No category is added"}),L=a.i18n.translate("xpack.cases.createCase.titleFieldRequiredError",{defaultMessage:"A name is required."}),D=a.i18n.translate("xpack.cases.configureCasesButton",{defaultMessage:"Settings"}),$=a.i18n.translate("xpack.cases.caseView.comment.addComment",{defaultMessage:"Add comment"}),U=a.i18n.translate("xpack.cases.caseView.comment.addCommentHelpText",{defaultMessage:"Add a new comment..."}),B=a.i18n.translate("xpack.cases.caseView.description.save",{defaultMessage:"Save"}),z=a.i18n.translate("xpack.cases.caseView.connectors",{defaultMessage:"External incident management system"}),q=a.i18n.translate("xpack.cases.common.noConnector",{defaultMessage:"No connector selected"}),G=a.i18n.translate("xpack.cases.caseView.unknown",{defaultMessage:"Unknown"}),H=a.i18n.translate("xpack.cases.caseView.markedCaseAs",{defaultMessage:"marked case as"}),W=a.i18n.translate("xpack.cases.caseView.addCategory",{defaultMessage:"added the category"}),Y=a.i18n.translate("xpack.cases.caseView.userAction.removeCategory",{defaultMessage:"removed the category"}),K=a.i18n.translate("xpack.cases.caseView.setSeverityTo",{defaultMessage:"set severity to"}),Z=a.i18n.translate("xpack.cases.caseTable.openCases",{defaultMessage:"Open cases"}),J=a.i18n.translate("xpack.cases.caseTable.closedCases",{defaultMessage:"Closed cases"}),Q=a.i18n.translate("xpack.cases.caseTable.inProgressCases",{defaultMessage:"In progress cases"}),X=a.i18n.translate("xpack.cases.settings.syncAlertsSwitchLabelOn",{defaultMessage:"On"}),ee=a.i18n.translate("xpack.cases.settings.syncAlertsSwitchLabelOff",{defaultMessage:"Off"}),te=a.i18n.translate("xpack.cases.settings.syncAlerts",{defaultMessage:"Sync alerts"}),se=a.i18n.translate("xpack.cases.components.create.syncAlertHelpText",{defaultMessage:"Enabling this option will sync the alert statuses with the case status."}),ae=a.i18n.translate("xpack.cases.settings.extractObservablesSwitchLabelOn",{defaultMessage:"On"}),ne=a.i18n.translate("xpack.cases.settings.extractObservablesSwitchLabelOff",{defaultMessage:"Off"}),ie=a.i18n.translate("xpack.cases.settings.extractObservablesLabel",{defaultMessage:"Extract observables"}),re=a.i18n.translate("xpack.cases.components.create.extractObservablesHelpText",{defaultMessage:"Enabling this option will extract observables from the alert automatically."}),le=(a.i18n.translate("xpack.cases.common.alertLabel",{defaultMessage:"Alert"}),a.i18n.translate("xpack.cases.common.alertsLabel",{defaultMessage:"Alerts"})),oe=(a.i18n.translate("xpack.cases.common.alertAddedToCase",{defaultMessage:"added to case"}),a.i18n.translate("xpack.cases.common.eventsLabel",{defaultMessage:"Events"})),ce=a.i18n.translate("xpack.cases.common.allCases.caseModal.title",{defaultMessage:"Select case"}),ue=(e,t)=>a.i18n.translate("xpack.cases.createCase.maxLengthError",{values:{field:e,length:t},defaultMessage:"The length of the {field} is too long. The maximum length is {length} characters."}),de=e=>a.i18n.translate("xpack.cases.customFields.safeIntegerNumberError",{values:{field:e},defaultMessage:"The value of the {field} should be an integer between -(2^53 - 1) and 2^53 - 1, inclusive."}),pe=e=>a.i18n.translate("xpack.cases.createCase.maxTagsError",{values:{length:e},defaultMessage:"Too many tags. The maximum number of allowed tags is {length}"}),ge=a.i18n.translate("xpack.cases.common.appropriateLicense",{defaultMessage:"appropriate license"}),me=e=>a.i18n.translate("xpack.cases.actions.caseSuccessToast",{values:{title:e},defaultMessage:"Case {title} updated"}),fe=(e,t=1)=>a.i18n.translate("xpack.cases.actions.caseAlertSuccessToast",{values:{quantity:t,title:e},defaultMessage:'{quantity, plural, =1 {An alert was} other {Alerts were}} added to "{title}"'}),ye=a.i18n.translate("xpack.cases.actions.caseAlertSuccessSyncText",{defaultMessage:"Alert statuses were synced with the case's status."}),be=a.i18n.translate("xpack.cases.actions.caseAlertSuccessObservablesText",{defaultMessage:"Observables were extracted and added to the case."}),ve=a.i18n.translate("xpack.cases.actions.caseAlertSuccessSyncAndExtractText",{defaultMessage:"Alert statuses were synced with the case's status and observables were extracted and added to the case."}),he=a.i18n.translate("xpack.cases.actions.viewCase",{defaultMessage:"View case"}),xe=a.i18n.translate("xpack.cases.common.appTitle",{defaultMessage:"Cases"}),ke=a.i18n.translate("xpack.cases.common.appDescription",{defaultMessage:"Open and track issues, push information to third party systems."}),_e=a.i18n.translate("xpack.cases.configure.readPermissionsErrorDescription",{defaultMessage:"You do not have permission to view connectors. If you would like to view connectors, contact your Kibana administrator."}),Ce=e=>a.i18n.translate("xpack.cases.containers.deletedCases",{values:{totalCases:e},defaultMessage:"Deleted {totalCases, plural, =1 {case} other {{totalCases} cases}}"}),Te=e=>a.i18n.translate("xpack.cases.configure.addTagCustomOptionLabel",{defaultMessage:"Add {searchValue} as a tag",values:{searchValue:e}}),we=e=>a.i18n.translate("xpack.cases.configure.commentVersionConflictWarning",{defaultMessage:"This {markdownId} has been updated by another user. Saving your {markdownId} will overwrite their update.",values:{markdownId:e}}),Ae=Te("{searchValue}"),Se=a.i18n.translate("xpack.cases.configure.addCategoryCustomOptionLabel",{defaultMessage:"Add {searchValue} as a category",values:{searchValue:"{searchValue}"}});const Ee=a.i18n.translate("xpack.cases.badge.experimentalLabel",{defaultMessage:"Technical preview"}),Me=a.i18n.translate("xpack.cases.badge.experimentalDesc",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})},4621:(e,t,s)=>{"use strict";s.d(t,{a:()=>v});var a=s(1319),n=s(4286),i=s.n(n),r=s(6791),l=s(5804),o=s(2727),c=s(6013),u=s(3867),d=s(4345),p=s(8228),g=s(6735),m=s(6467),f=s(3480);const y=e=>Object.hasOwn(e,"body"),b=e=>{var t,s;return y(e)?null!==(t=null===(s=e.body)||void 0===s?void 0:s.message)&&void 0!==t?t:"":e.message},v=()=>{const{appId:e}=(0,m.Y)(),{application:t,i18n:s,theme:a,userProfile:i}=(0,u.o1)().services,{getUrlForApp:v,navigateToUrl:x}=t,k=(0,u.Yf)();return(0,n.useMemo)((()=>({showSuccessAttach:({theCase:t,attachments:n,observables:u,title:m,content:y})=>{const b=(0,o.yi)(t.owner)?g.lO[t.owner].appId:e,_=null!=b?v(b,{deepLinkId:"cases",path:(0,d._M)({detailName:t.id})}):null,C=function({theCase:e,title:t,attachments:s}){if(void 0!==t)return t;if(void 0!==s){const t=function(e){let t=0;for(const s of e)s.type===c.wh.alert&&(Array.isArray(s.alertId)&&s.alertId.length>1?t+=s.alertId.length:t++);return t}(s);if(t>0)return(0,p._E)(e.title,t)}return(0,p.ZS)(e.title)}({theCase:t,title:m,attachments:n}),T=function({theCase:e,content:t,attachments:s}){if(void 0!==t)return t;let a;if(void 0!==s)for(const t of s)t.type===c.wh.alert&&(e.settings.syncAlerts&&e.settings.extractObservables?a=p.aE:e.settings.syncAlerts?a=p.Cw:e.settings.extractObservables&&(a=p.x2));return a}({theCase:t,content:y,attachments:n});return k.addSuccess({color:"success",iconType:"check",title:(0,l.toMountPoint)((0,r.jsx)(f.G,{text:C}),{i18n:s,theme:a,userProfile:i}),text:(0,l.toMountPoint)((0,r.jsx)(h,{content:T,onViewCaseClick:null!=_?()=>{_&&x(_)}:void 0}),{i18n:s,theme:a,userProfile:i})})},showErrorToast:(e,t)=>{"AbortError"!==e.name&&k.addError((e=>{var t;return y(e)?new Error(null===(t=e.body)||void 0===t?void 0:t.message):e})(e),{title:b(e),...t})},showSuccessToast:e=>{k.addSuccess({title:e,className:"eui-textBreakWord"})},showDangerToast:(e,t)=>{k.addDanger({title:e,text:t,className:"eui-textBreakWord"})},showInfoToast:(e,t)=>{k.addInfo({title:e,text:t,className:"eui-textBreakWord"})}})),[s,a,i,e,v,x,k])},h=({onViewCaseClick:e,content:t})=>{const{euiTheme:s}=(0,a.useEuiTheme)();return(0,r.jsx)(i().Fragment,null,void 0!==t?(0,r.jsx)(a.EuiText,{size:"s",css:(0,r.css)((0,a.logicalCSS)("margin-bottom",s.size.s),";",""),"data-test-subj":"toaster-content-sync-text"},t):null,void 0!==e?(0,r.jsx)(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},(0,r.jsx)(a.EuiFlexItem,{grow:!1},(0,r.jsx)(a.EuiButton,{size:"s",onClick:e,"data-test-subj":"toaster-content-case-view-link"},p.v9))):null)};h.displayName="CaseToastSuccessContent"},4407:(e,t,s)=>{"use strict";s.d(t,{P:()=>f});var a=s(4286),n=s(5408),i=s(6467),r=s(6013),l=s(4621),o=s(9090),c=s(4124),u=s(921),d=s(5498),p=s(3170),g=s(6517),m=s(1199);const f=({successToaster:e,noAttachmentsToaster:t,onSuccess:s,onClose:f,onCreateCaseClicked:y}={})=>{const b=(0,a.useCallback)((e=>{if(s&&e)return s(e)}),[s]),{open:v}=(0,u.I)({onClose:f,onSuccess:b,toastTitle:null==e?void 0:e.title,toastContent:null==e?void 0:e.content}),{dispatch:h}=(0,c.g)(),{appId:x}=(0,i.Y)(),k=(0,l.a)(),{mutateAsync:_}=(0,d.Q)(),{mutateAsync:C}=(0,m.U)(),{startTransaction:T}=(0,p.g)(),w=(0,a.useCallback)((()=>{h({type:o.NG.CLOSE_ADD_TO_CASE_MODAL}),h({type:o.NG.CLOSE_CREATE_CASE_FLYOUT})}),[h]),A=(0,n.N)(),S=(0,a.useCallback)((async(a,n,i)=>{var r,l;const o=null!==(r=null==n?void 0:n({theCase:a}))&&void 0!==r?r:[],c=null!==(l=null==i?void 0:i({theCase:a}))&&void 0!==l?l:[];if(void 0===a)return w(),void v({attachments:o,observables:c});try{var u;if(void 0===o||0===o.length){var d;const e=null!==(d=null==t?void 0:t.title)&&void 0!==d?d:g.uv,s=null==t?void 0:t.content;return void k.showInfoToast(e,s)}T({appId:x,attachments:o}),await _({caseId:a.id,caseOwner:a.owner,attachments:o}),A(window.location.pathname,o),null!==(u=a.settings)&&void 0!==u&&u.extractObservables&&c.length>0&&await C({caseId:a.id,observables:c}),null==s||s(a),k.showSuccessAttach({theCase:a,attachments:o,observables:c,title:null==e?void 0:e.title,content:null==e?void 0:e.content})}catch(e){}}),[w,v,T,x,_,A,s,k,null==e?void 0:e.title,null==e?void 0:e.content,null==t?void 0:t.title,null==t?void 0:t.content,C]),E=(0,a.useCallback)((({getAttachments:e,getObservables:t}={})=>{h({type:o.NG.OPEN_ADD_TO_CASE_MODAL,payload:{hiddenStatuses:[r.F$.closed],onCreateCaseClicked:y,getAttachments:e,onRowClick:s=>{S(s,e,t)},onClose:(e,t)=>{if(w(),f)return f(e,t)}}})}),[w,h,S,f,y]);return(0,a.useMemo)((()=>({open:E,close:w})),[E,w])}},6517:(e,t,s)=>{"use strict";s.d(t,{BN:()=>f,Dn:()=>z,F:()=>B,GT:()=>n.GT,Gm:()=>n.Gm,HT:()=>R,Hp:()=>q,IN:()=>k,JI:()=>b,JK:()=>Y,JY:()=>F,Lo:()=>r.mS,Mc:()=>P,NK:()=>m,Ni:()=>y,Ou:()=>r.V,Q$:()=>V,Q0:()=>h,R6:()=>n.R6,Ro:()=>C,SZ:()=>O,Th:()=>x,UO:()=>G,X5:()=>c,XJ:()=>n.XJ,XQ:()=>S,YD:()=>j,Yk:()=>d,_1:()=>u,aI:()=>w,cZ:()=>$,dH:()=>g,dl:()=>_,e8:()=>M,ei:()=>L,fG:()=>p,gp:()=>n.gp,gu:()=>A,iZ:()=>n.iZ,j0:()=>n.j0,kO:()=>I,kl:()=>n.kl,kr:()=>l,l5:()=>i.l5,lE:()=>H,lw:()=>W,mU:()=>v,mr:()=>n.mr,o_:()=>n.o_,ox:()=>E,pj:()=>n.pj,q8:()=>r.vP,rH:()=>o,r_:()=>n.r_,s7:()=>N,sA:()=>T,tt:()=>n.tt,u6:()=>U,uv:()=>D,yD:()=>i.yD,zj:()=>n.zj});var a=s(5008),n=s(8228),i=s(2432),r=s(8524);const l=a.i18n.translate("xpack.cases.caseTable.noCases.title",{defaultMessage:"No cases to display"}),o=a.i18n.translate("xpack.cases.caseTable.noCases.body",{defaultMessage:"Create a case or edit your filters."}),c=a.i18n.translate("xpack.cases.caseTable.noCases.readonly.body",{defaultMessage:"Edit your filter settings."}),u=e=>a.i18n.translate("xpack.cases.caseTable.selectedCasesTitle",{values:{totalRules:e},defaultMessage:"Selected {totalRules} {totalRules, plural, =1 {case} other {cases}}"}),d=(e,t)=>a.i18n.translate("xpack.cases.caseTable.showingCasesTitle",{values:{totalRules:e,pageSize:t},defaultMessage:"Showing {pageSize} of {totalRules} {totalRules, plural, =1 {case} other {cases}}"}),p=e=>a.i18n.translate("xpack.cases.caseTable.maxCases",{values:{maxCases:e},defaultMessage:"The results were capped at {maxCases} to maintain performance. Try limiting your search to reduce the results."}),g=a.i18n.translate("xpack.cases.caseTable.dismiss",{defaultMessage:"Dismiss"}),m=a.i18n.translate("xpack.cases.caseTable.notShowAgain",{defaultMessage:"Do not show again"}),f=a.i18n.translate("xpack.cases.caseTable.searchAriaLabel",{defaultMessage:"Search cases"}),y=a.i18n.translate("xpack.cases.caseTable.bulkActions",{defaultMessage:"Bulk actions"}),b=a.i18n.translate("xpack.cases.caseTable.snIncident",{defaultMessage:"External incident"}),v=a.i18n.translate("xpack.cases.caseTable.severity",{defaultMessage:"Severity"}),h=(a.i18n.translate("xpack.cases.caseTable.incidentSystem",{defaultMessage:"Incident management system"}),a.i18n.translate("xpack.cases.caseTable.searchPlaceholder",{defaultMessage:"Search cases"})),x=(a.i18n.translate("xpack.cases.caseTable.closed",{defaultMessage:"Closed"}),a.i18n.translate("xpack.cases.caseTable.select",{defaultMessage:"Select"})),k=a.i18n.translate("xpack.cases.caseTable.alreadyAttached",{defaultMessage:"Added",description:'In this context, "Added" is letting the user know that all of their selected alerts were previously added to the case in question, and the "Add to case" button is disabled'}),_=a.i18n.translate("xpack.cases.caseTable.requiresUpdate",{defaultMessage:" requires update"}),C=a.i18n.translate("xpack.cases.caseTable.upToDate",{defaultMessage:" is up to date"}),T=a.i18n.translate("xpack.cases.caseTable.notPushed",{defaultMessage:"Not pushed"}),w=a.i18n.translate("xpack.cases.caseTable.refreshTitle",{defaultMessage:"Refresh"}),A=e=>a.i18n.translate("xpack.cases.caseTable.pushLinkAria",{values:{thirdPartyName:e},defaultMessage:"click to view the incident on { thirdPartyName }."}),S=a.i18n.translate("xpack.cases.caseTable.status",{defaultMessage:"Status"}),E=a.i18n.translate("xpack.cases.caseTable.changeStatus",{defaultMessage:"Change status"}),M=a.i18n.translate("xpack.cases.casesStats.mttr",{defaultMessage:"Average time to close"}),O=a.i18n.translate("xpack.cases.casesStats.mttr.info.ariaLabel",{defaultMessage:"More about average time to close"}),j=a.i18n.translate("xpack.cases.casesStats.mttrDescription",{defaultMessage:"The average duration (from creation to closure) for your current cases"}),F=a.i18n.translate("xpack.cases.allCasesView.filterAssigneesAriaLabel",{defaultMessage:"click to filter assignees"}),P=a.i18n.translate("xpack.cases.allCasesView.clearFilters",{defaultMessage:"Clear filters"}),N=e=>a.i18n.translate("xpack.cases.allCasesView.totalFilteredUsers",{defaultMessage:"{total, plural, one {# filter} other {# filters}} selected",values:{total:e}}),R=a.i18n.translate("xpack.cases.allCasesView.filterAssignees.noAssigneesLabel",{defaultMessage:"No assignees"}),I=(e,t)=>a.i18n.translate("xpack.cases.userProfile.maxSelectedAssigneesFilter",{defaultMessage:"You've selected the maximum number of {count} {field}",values:{count:e,field:t}}),V=a.i18n.translate("xpack.cases.allCasesView.showLessAvatars",{defaultMessage:"show less"}),L=e=>a.i18n.translate("xpack.cases.allCasesView.showMoreAvatars",{defaultMessage:"+{count} more",values:{count:e}}),D=a.i18n.translate("xpack.cases.modal.attachments.noAttachmentsTitle",{defaultMessage:"No attachments added to the case"}),$=a.i18n.translate("xpack.cases.allCasesView.columnSelection",{defaultMessage:"Columns"}),U=a.i18n.translate("xpack.cases.allCasesView.columnSelectionShowAll",{defaultMessage:"Show All"}),B=a.i18n.translate("xpack.cases.allCasesView.columnSelectionHideAll",{defaultMessage:"Hide All"}),z=a.i18n.translate("xpack.cases.allCasesView.columnSelectionSearch",{defaultMessage:"Search"}),q=a.i18n.translate("xpack.cases.allCasesView.columnSelectionSearchColumns",{defaultMessage:"Search Columns"}),G=a.i18n.translate("xpack.cases.allCasesView.columnSelectionDragHandle",{defaultMessage:"Drag Handle"}),H=a.i18n.translate("xpack.cases.tableFilters.useFilters.emptyMessage",{defaultMessage:"No options"}),W=e=>a.i18n.translate("xpack.cases.tableFilters.useFilters.options",{defaultMessage:"{totalCount, plural, one {# option} other {# options}}",values:{totalCount:e}}),Y=a.i18n.translate("xpack.cases.tableFilters.moreFiltersLabel",{defaultMessage:"More"})},6558:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CasesContext:()=>x,CasesProvider:()=>k,default:()=>_});var a=s(770),n=s(4286),i=s.n(n),r=s(9673),l=s(3530),o=s(7033),c=s(1319),u=s(6791);const d=(0,n.lazy)((()=>Promise.all([s.e(678),s.e(177),s.e(657),s.e(442)]).then(s.bind(s,5442)))),p=i().memo((({state:e})=>{return(0,u.jsx)(i().Fragment,null,e.createCaseFlyout.isFlyoutOpen&&void 0!==e.createCaseFlyout.props?(t=e.createCaseFlyout.props,(0,u.jsx)(n.Suspense,{fallback:(0,u.jsx)(c.EuiLoadingSpinner,null)},(0,u.jsx)(d,t))):null,e.selectCaseModal.isModalOpen&&void 0!==e.selectCaseModal.props?(0,o.n)(e.selectCaseModal.props):null);var t}));p.displayName="CasesContextUi";var g=s(6735),m=s(2194),f=s(4345),y=s(9090),b=s(4756),v=s(9942);const h=new l.QueryClient({defaultOptions:{queries:{networkMode:"always"},mutations:{networkMode:"always"}}}),x=i().createContext(void 0),k=({children:e,value:{externalReferenceAttachmentTypeRegistry:t,persistableStateAttachmentTypeRegistry:s,owner:o,permissions:c,basePath:d=f.Cy,features:k={},releasePhase:_="ga",getFilesClient:C},queryClient:T=h})=>{const[w,A]=(0,n.useReducer)(y.RT,(0,y.s_)()),S=(0,n.useMemo)((()=>({externalReferenceAttachmentTypeRegistry:t,persistableStateAttachmentTypeRegistry:s,owner:o,permissions:{all:c.all,connectors:c.connectors,create:c.create,delete:c.delete,push:c.push,read:c.read,settings:c.settings,update:c.update,reopenCase:c.reopenCase,createComment:c.createComment,assign:c.assign},basePath:d,features:(0,a.merge)({},g.Oc,k),releasePhase:_,dispatch:A})),[c.all,c.connectors,c.create,c.delete,c.push,c.read,c.settings,c.update,c.reopenCase,c.createComment,c.assign]),E=(0,n.useCallback)((e=>{if(0===o.length)return e;if((0,v.q)(o[0]))return(0,u.jsx)(r.b,{client:C((0,m.Ng)(o[0]))},e);throw new Error("Invalid owner provided to cases context. See https://github.com/elastic/kibana/blob/main/x-pack/platform/plugins/shared/cases/README.md#casescontext-setup")}),[C,o]);return(0,u.jsx)(l.QueryClientProvider,{client:T},(0,u.jsx)(b._.Provider,{value:w},(0,u.jsx)(x.Provider,{value:S},E((0,u.jsx)(i().Fragment,null,(0,u.jsx)(p,{state:w}),e)))))};k.displayName="CasesProvider";const _=k},9090:(e,t,s)=>{"use strict";s.d(t,{NG:()=>i,RT:()=>r,s_:()=>n});const a=__kbnSharedDeps__.KbnStd,n=()=>({createCaseFlyout:{isFlyoutOpen:!1},selectCaseModal:{isModalOpen:!1}});let i=function(e){return e[e.OPEN_CREATE_CASE_FLYOUT=0]="OPEN_CREATE_CASE_FLYOUT",e[e.CLOSE_CREATE_CASE_FLYOUT=1]="CLOSE_CREATE_CASE_FLYOUT",e[e.OPEN_ADD_TO_CASE_MODAL=2]="OPEN_ADD_TO_CASE_MODAL",e[e.CLOSE_ADD_TO_CASE_MODAL=3]="CLOSE_ADD_TO_CASE_MODAL",e}({});const r=(e,t)=>{switch(t.type){case i.OPEN_CREATE_CASE_FLYOUT:return{...e,createCaseFlyout:{isFlyoutOpen:!0,props:t.payload}};case i.CLOSE_CREATE_CASE_FLYOUT:return{...e,createCaseFlyout:{isFlyoutOpen:!1}};case i.OPEN_ADD_TO_CASE_MODAL:return{...e,selectCaseModal:{isModalOpen:!0,props:t.payload}};case i.CLOSE_ADD_TO_CASE_MODAL:return{...e,selectCaseModal:{isModalOpen:!1}};default:(0,a.assertNever)(t)}}},4756:(e,t,s)=>{"use strict";s.d(t,{J:()=>i,_:()=>n});var a=s(4286);const n=s.n(a)().createContext(void 0),i=()=>{const e=(0,a.useContext)(n);if(!e)throw new Error("useCasesStateContext must be used within a CasesProvider and have a defined value. See https://github.com/elastic/kibana/blob/main/x-pack/platform/plugins/shared/cases/README.md#cases-ui");return e}},4124:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});var a=s(4286),n=s(6558);const i=()=>{const e=(0,a.useContext)(n.CasesContext);if(!e)throw new Error("useCasesContext must be used within a CasesProvider and have a defined value. See https://github.com/elastic/kibana/blob/main/x-pack/platform/plugins/shared/cases/README.md#cases-ui");return e}},9049:(e,t,s)=>{"use strict";s.d(t,{Y:()=>i});var a=s(6013);const n=["caseIdConfig","caseNameConfig","descriptionConfig","commentsConfig"],i=e=>{const t=e.config;var s;if(null!=t)return t.connectorType===a.aL.Alerts||(s=t.mappings,n.some((e=>null==(null==s?void 0:s[e]))))?{message:"Invalid connector"}:void 0}},921:(e,t,s)=>{"use strict";s.d(t,{I:()=>l});var a=s(4286),n=s(4621),i=s(9090),r=s(4124);const l=({initialValue:e,toastTitle:t,toastContent:s,afterCaseCreated:l,onSuccess:o,onClose:c}={})=>{const{dispatch:u}=(0,r.g)(),d=(0,n.a)(),p=(0,a.useCallback)((()=>{u({type:i.NG.CLOSE_CREATE_CASE_FLYOUT})}),[u]),g=(0,a.useCallback)((({attachments:a,headerContent:n,observables:r}={})=>{u({type:i.NG.OPEN_CREATE_CASE_FLYOUT,payload:{initialValue:e,attachments:a,headerContent:n,observables:r,onClose:()=>{if(p(),c)return c()},onSuccess:async e=>{if(e&&d.showSuccessAttach({theCase:e,attachments:null!=a?a:[],observables:r,title:t,content:s}),o)return o(e)},afterCaseCreated:async(...e)=>{if(p(),l)return l(...e)}}})}),[e,d,p,u,t,s,l,o,c]);return(0,a.useMemo)((()=>({open:g,close:p})),[g,p])}},1119:(e,t,s)=>{"use strict";s.d(t,{k:()=>K});var a=s(6013),n=s(2533),i=s(4286),r=s.n(i),l=s(6791);const o=({label:e})=>({name:e,width:"250px",render:e=>(0,l.jsx)("p",{className:"eui-textTruncate","data-test-subj":`text-custom-field-column-view-${e.key}`},e.value),"data-test-subj":"text-custom-field-column"});var c=s(770),u=s(1319),d=s(2602),p=s(5296);const g=({customField:e})=>{var t;const s=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"-";return(0,l.jsx)(u.EuiText,{className:"eui-textBreakWord","data-test-subj":`text-custom-field-view-${null==e?void 0:e.key}`},s)};g.displayName="View";const m=r().memo(g);var f=s(791),y=s(6735);const{emptyField:b}=f.fieldValidators,v=({required:e,label:t,defaultValue:s})=>{const a=[];return e&&a.push({validator:b((0,n.BJ)(t))}),{...s&&{defaultValue:s},validations:[...a,{validator:({value:e})=>{if(null!=e)return e.length>y.lv?{message:(0,n.Zr)(t,y.lv)}:void 0}}]}},h=({initialValue:e,customFieldConfiguration:t,isLoading:s,onChange:a})=>{const{form:r}=(0,d.useForm)({defaultValue:{value:null!=(null==t?void 0:t.defaultValue)&&(0,c.isEmpty)(e)?String(t.defaultValue):e}}),[{value:o}]=(0,d.useFormData)({form:r}),{submit:u,isValid:g}=r,m=v({required:t.required,label:t.label}),f=o===(null==t?void 0:t.defaultValue)&&(0,c.isEmpty)(e);return(0,i.useEffect)((()=>{a({value:o,isValid:g,submit:u})}),[g,a,u,o]),(0,l.jsx)(d.Form,{form:r},(0,l.jsx)(d.UseField,{path:"value",config:m,component:p.TextField,helpText:f&&n.kn,componentProps:{euiFieldProps:{fullWidth:!0,disabled:s,isLoading:s,"data-test-subj":`case-text-custom-field-form-field-${t.key}`}}}))};h.displayName="FormWrapper";const x=({customField:e,customFieldConfiguration:t,onSubmit:s,isLoading:o,canUpdate:d})=>{var p;const g=null!==(p=null==e?void 0:e.value)&&void 0!==p?p:"",[f,y]=(0,i.useState)(!1),[b,v]=(0,i.useState)({isValid:void 0,submit:async()=>({isValid:!1,data:{value:""}}),value:g}),x=t.label,k=b.isValid||b.value===t.defaultValue&&!g,_=!(0,c.isEmpty)(null==e?void 0:e.value);return(0,l.jsx)(r().Fragment,null,(0,l.jsx)(u.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween",responsive:!1},(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiText,null,(0,l.jsx)("h4",null,x))),o&&(0,l.jsx)(u.EuiLoadingSpinner,{"data-test-subj":`case-text-custom-field-loading-${t.key}`}),!o&&d&&(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiButtonIcon,{"data-test-subj":`case-text-custom-field-edit-button-${t.key}`,"aria-label":(0,n.TZ)(x),iconType:"pencil",onClick:()=>{y(!0)}}))),(0,l.jsx)(u.EuiHorizontalRule,{margin:"xs"}),(0,l.jsx)(u.EuiFlexGroup,{gutterSize:"m","data-test-subj":`case-text-custom-field-${t.key}`,direction:"column"},!_&&!f&&(0,l.jsx)("p",{"data-test-subj":"no-custom-field-value"},n.CS),!f&&_&&(0,l.jsx)(u.EuiFlexItem,null,(0,l.jsx)(m,{customField:e})),f&&d&&(0,l.jsx)(u.EuiFlexGroup,{gutterSize:"m",direction:"column"},(0,l.jsx)(u.EuiFlexItem,null,(0,l.jsx)(h,{initialValue:g,isLoading:o,onChange:v,customFieldConfiguration:t})),(0,l.jsx)(u.EuiFlexItem,null,(0,l.jsx)(u.EuiFlexGroup,{alignItems:"center",responsive:!1},(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiButton,{color:"primary","data-test-subj":`case-text-custom-field-submit-button-${t.key}`,fill:!0,iconType:"save",onClick:async()=>{const{isValid:n,data:i}=await b.submit();if(n){var r;const n=(0,c.isEmpty)(i.value)?null:i.value;s({...e,key:null!==(r=null==e?void 0:e.key)&&void 0!==r?r:t.key,type:a.je.TEXT,value:n})}y(!1)},size:"s",disabled:!k||o},n.W0)),(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiButtonEmpty,{"data-test-subj":`case-text-custom-field-cancel-button-${t.key}`,iconType:"cross",onClick:()=>{y(!1)},size:"s"},n.bO)))))))};x.displayName="Edit";const k=r().memo(x);var _=s(7778);const C=()=>{const e=v({required:!1,label:n.kH.toLocaleLowerCase()});return(0,l.jsx)(r().Fragment,null,(0,l.jsx)(d.UseField,{path:"required",component:p.CheckBoxField,componentProps:{label:n.iV,"data-test-subj":"text-custom-field-required-wrapper",euiFieldProps:{label:n.HS,"data-test-subj":"text-custom-field-required"}}}),(0,l.jsx)(d.UseField,{path:"defaultValue",component:p.TextField,config:e,componentProps:{label:n.kH,labelAppend:_.$,euiFieldProps:{"data-test-subj":"text-custom-field-default-value"}}}))};C.displayName="Configure";const T=r().memo(C),w=({customFieldConfiguration:e,isLoading:t,setAsOptional:s,setDefaultValue:a=!0})=>{const{key:n,label:i,required:r,defaultValue:o}=e,c=v({required:!s&&r,label:i,...o&&a&&{defaultValue:String(o)}});return(0,l.jsx)(d.UseField,{path:`customFields.${n}`,config:c,component:p.TextField,label:i,componentProps:{labelAppend:s?_.$:null,euiFieldProps:{"data-test-subj":`${n}-text-create-custom-field`,fullWidth:!0,disabled:t,isLoading:t}}})};w.displayName="Create";const A=r().memo(w),S=({label:e})=>({name:e,width:"100px",render:e=>(0,l.jsx)(u.EuiIcon,{"data-test-subj":`toggle-custom-field-column-view-${e.key}-${null!=e&&e.value?"check":"cross"}`,type:null!=e&&e.value?"check":"cross"}),"data-test-subj":"toggle-custom-field-column"}),E=({customField:e,customFieldConfiguration:t,onSubmit:s,isLoading:n,canUpdate:i})=>{const o=Boolean(null==e?void 0:e.value),c=t.label,{form:g}=(0,d.useForm)({defaultValue:{value:o}});return(0,l.jsx)(r().Fragment,null,(0,l.jsx)(u.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween",responsive:!1},(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiText,null,(0,l.jsx)("h4",null,c)))),(0,l.jsx)(u.EuiHorizontalRule,{margin:"xs"}),(0,l.jsx)(u.EuiFlexGroup,{gutterSize:"m","data-test-subj":`case-toggle-custom-field-${t.key}`,direction:"column"},(0,l.jsx)(d.Form,{form:g},(0,l.jsx)(d.UseField,{path:"value",component:p.ToggleField,onChange:async()=>{const{isValid:n,data:i}=await g.submit();var r;n&&s({...e,key:null!==(r=null==e?void 0:e.key)&&void 0!==r?r:t.key,type:a.je.TOGGLE,value:i.value})},componentProps:{euiFieldProps:{disabled:n||!i,"data-test-subj":`case-toggle-custom-field-form-field-${t.key}`}}}))))};E.displayName="Edit";const M=r().memo(E),O=({customField:e})=>{const t=Boolean(null==e?void 0:e.value),s=t?"check":"empty";return(0,l.jsx)(u.EuiIcon,{"data-test-subj":`toggle-custom-field-view-${null==e?void 0:e.key}`,type:s},t)};O.displayName="View";const j=r().memo(O),F=()=>(0,l.jsx)(r().Fragment,null,(0,l.jsx)(d.UseField,{path:"required",component:p.CheckBoxField,componentProps:{label:n.iV,"data-test-subj":"toggle-custom-field-required-wrapper",euiFieldProps:{label:n.HS,"data-test-subj":"toggle-custom-field-required"}}}),(0,l.jsx)(d.UseField,{path:"defaultValue",component:p.ToggleField,config:{defaultValue:!1},componentProps:{label:n.kH,euiFieldProps:{"data-test-subj":"toggle-custom-field-default-value"}}}));F.displayName="Configure";const P=r().memo(F),N=({customFieldConfiguration:e,isLoading:t,setDefaultValue:s=!0})=>{const{key:a,label:n,defaultValue:i}=e;return(0,l.jsx)(d.UseField,{path:`customFields.${a}`,component:p.ToggleField,config:{defaultValue:!(!i||!s)&&i},key:a,label:n,componentProps:{euiFieldProps:{"data-test-subj":`${a}-toggle-create-custom-field`,disabled:t}}})};N.displayName="Create";const R=r().memo(N),I=({label:e})=>({name:e,width:"150px",render:e=>(0,l.jsx)("p",{className:"eui-textNumber","data-test-subj":`number-custom-field-column-view-${e.key}`},e.value),"data-test-subj":"number-custom-field-column"}),V=({customField:e})=>{var t;const s=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"-";return(0,l.jsx)(u.EuiText,{className:"eui-textNumber","data-test-subj":`text-custom-field-view-${null==e?void 0:e.key}`},s)};V.displayName="View";const L=r().memo(V),{emptyField:D}=f.fieldValidators,$=({required:e,label:t,defaultValue:s})=>{const a=[];return e&&a.push({validator:D((0,n.BJ)(t))}),{...s&&{defaultValue:s},validations:[...a,{validator:({value:e})=>{if(null==e)return;const s=Number(e);return Number.isSafeInteger(s)?void 0:{message:(0,n.Kx)(t)}}}]}},U=e=>null==e,B=({initialValue:e,customFieldConfiguration:t,isLoading:s,onChange:a})=>{const{form:r}=(0,d.useForm)({defaultValue:{value:null!=(null==t?void 0:t.defaultValue)&&U(e)?Number(t.defaultValue):e}}),[{value:o}]=(0,d.useFormData)({form:r}),{submit:c,isValid:u}=r,g=$({required:t.required,label:t.label}),m=o===(null==t?void 0:t.defaultValue)&&U(e);return(0,i.useEffect)((()=>{a({value:o,isValid:u,submit:c})}),[u,a,c,o]),(0,l.jsx)(d.Form,{form:r},(0,l.jsx)(d.UseField,{path:"value",config:g,component:p.NumericField,helpText:m&&n.kn,componentProps:{euiFieldProps:{fullWidth:!0,disabled:s,isLoading:s,"data-test-subj":`case-number-custom-field-form-field-${t.key}`}}}))};B.displayName="FormWrapper";const z=({customField:e,customFieldConfiguration:t,onSubmit:s,isLoading:o,canUpdate:c})=>{var d;const p=null!==(d=null==e?void 0:e.value)&&void 0!==d?d:null,[g,m]=(0,i.useState)(!1),[f,y]=(0,i.useState)({isValid:void 0,submit:async()=>({isValid:!1,data:{value:null}}),value:p}),b=(0,i.useCallback)((()=>{m(!0)}),[]),v=(0,i.useCallback)((()=>{m(!1)}),[]),h=(0,i.useCallback)((async()=>{const{isValid:n,data:i}=await f.submit();var r;n&&s({...e,key:null!==(r=null==e?void 0:e.key)&&void 0!==r?r:t.key,type:a.je.NUMBER,value:i.value?Number(i.value):null}),m(!1)}),[e,t.key,f,s]),x=t.label,k=f.isValid||f.value===t.defaultValue&&U(p),_=!U(null==e?void 0:e.value);return(0,l.jsx)(r().Fragment,null,(0,l.jsx)(u.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween",responsive:!1},(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiText,null,(0,l.jsx)("h4",null,x))),o&&(0,l.jsx)(u.EuiLoadingSpinner,{"data-test-subj":`case-number-custom-field-loading-${t.key}`}),!o&&c&&(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiButtonIcon,{"data-test-subj":`case-number-custom-field-edit-button-${t.key}`,"aria-label":(0,n.TZ)(x),iconType:"pencil",onClick:b}))),(0,l.jsx)(u.EuiHorizontalRule,{margin:"xs"}),(0,l.jsx)(u.EuiFlexGroup,{gutterSize:"m","data-test-subj":`case-number-custom-field-${t.key}`,direction:"column"},!_&&!g&&(0,l.jsx)("p",{"data-test-subj":"no-number-custom-field-value"},n.CS),!g&&_&&(0,l.jsx)(u.EuiFlexItem,null,(0,l.jsx)(L,{customField:e})),g&&c&&(0,l.jsx)(u.EuiFlexGroup,{gutterSize:"m",direction:"column"},(0,l.jsx)(u.EuiFlexItem,null,(0,l.jsx)(B,{initialValue:p,isLoading:o,onChange:y,customFieldConfiguration:t})),(0,l.jsx)(u.EuiFlexItem,null,(0,l.jsx)(u.EuiFlexGroup,{alignItems:"center",responsive:!1},(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiButton,{color:"primary","data-test-subj":`case-number-custom-field-submit-button-${t.key}`,fill:!0,iconType:"save",onClick:h,size:"s",disabled:!k||o},n.W0)),(0,l.jsx)(u.EuiFlexItem,{grow:!1},(0,l.jsx)(u.EuiButtonEmpty,{"data-test-subj":`case-number-custom-field-cancel-button-${t.key}`,iconType:"cross",onClick:v,size:"s"},n.bO)))))))};z.displayName="Edit";const q=r().memo(z),G=()=>{const e=$({required:!1,label:n.kH.toLocaleLowerCase()});return(0,l.jsx)(r().Fragment,null,(0,l.jsx)(d.UseField,{path:"required",component:p.CheckBoxField,componentProps:{label:n.iV,"data-test-subj":"number-custom-field-required-wrapper",euiFieldProps:{label:n.HS,"data-test-subj":"number-custom-field-required"}}}),(0,l.jsx)(d.UseField,{path:"defaultValue",component:p.NumericField,config:e,componentProps:{label:n.kH,labelAppend:_.$,euiFieldProps:{"data-test-subj":"number-custom-field-default-value",step:1}}}))};G.displayName="Configure";const H=r().memo(G),W=({customFieldConfiguration:e,isLoading:t,setAsOptional:s,setDefaultValue:a=!0})=>{const{key:n,label:i,required:r,defaultValue:o}=e,c=$({required:!s&&r,label:i,...o&&a&&!isNaN(Number(o))&&{defaultValue:Number(o)}});return(0,l.jsx)(d.UseField,{path:`customFields.${n}`,config:c,component:p.NumericField,label:i,componentProps:{labelAppend:s?_.$:null,euiFieldProps:{"data-test-subj":`${n}-number-create-custom-field`,fullWidth:!0,disabled:t,isLoading:t}}})};W.displayName="Create";const Y=r().memo(W),K=Object.freeze({[a.je.TEXT]:()=>({id:a.je.TEXT,label:n.Rz,getEuiTableColumn:o,build:()=>({Configure:T,Edit:k,View:m,Create:A}),convertNullToEmpty:e=>null==e?"":String(e)}),[a.je.TOGGLE]:()=>({id:a.je.TOGGLE,label:n.sp,getEuiTableColumn:S,build:()=>({Configure:P,Edit:M,View:j,Create:R}),filterOptions:[{key:"on",label:n.IG,value:!0},{key:"off",label:n.jN,value:!1}],getDefaultValue:()=>!1}),[a.je.NUMBER]:()=>({id:a.je.NUMBER,label:n.BM,getEuiTableColumn:I,build:()=>({Configure:H,Edit:q,View:L,Create:Y})})})},2533:(e,t,s)=>{"use strict";s.d(t,{BJ:()=>h,BM:()=>g,CS:()=>k,HS:()=>b,IG:()=>w,Kx:()=>n.Kx,Rz:()=>d,SJ:()=>T,TZ:()=>x,U2:()=>u,U5:()=>C,W0:()=>n.W0,Zr:()=>n.Zr,bO:()=>n.bO,di:()=>o,iV:()=>f,jN:()=>A,kH:()=>y,kn:()=>S,ly:()=>i,mj:()=>c,mw:()=>v,qE:()=>_,sp:()=>p,tC:()=>r,uc:()=>l,wx:()=>m});var a=s(5008),n=s(8228);const i=a.i18n.translate("xpack.cases.customFields.title",{defaultMessage:"Custom fields"}),r=a.i18n.translate("xpack.cases.customFields.description",{defaultMessage:"Add more optional and required fields for customized case collaboration."}),l=a.i18n.translate("xpack.cases.customFields.noCustomFields",{defaultMessage:"You do not have any fields yet"}),o=a.i18n.translate("xpack.cases.customFields.addCustomField",{defaultMessage:"Add field"}),c=e=>a.i18n.translate("xpack.cases.customFields.maxCustomFieldLimit",{values:{maxCustomFields:e},defaultMessage:"Maximum number of {maxCustomFields} custom fields reached."}),u=(a.i18n.translate("xpack.cases.customFields.saveField",{defaultMessage:"Save field"}),a.i18n.translate("xpack.cases.customFields.fieldLabel",{defaultMessage:"Field label"})),d=(a.i18n.translate("xpack.cases.customFields.fieldLabelHelpText",{defaultMessage:"50 characters max"}),a.i18n.translate("xpack.cases.customFields.textLabel",{defaultMessage:"Text"})),p=a.i18n.translate("xpack.cases.customFields.toggleLabel",{defaultMessage:"Toggle"}),g=a.i18n.translate("xpack.cases.customFields.textLabel",{defaultMessage:"Number"}),m=a.i18n.translate("xpack.cases.customFields.fieldType",{defaultMessage:"Field type"}),f=a.i18n.translate("xpack.cases.customFields.fieldOptions",{defaultMessage:"Options"}),y=a.i18n.translate("xpack.cases.customFields.defaultValue",{defaultMessage:"Default value"}),b=a.i18n.translate("xpack.cases.customFields.fieldOptions.Required",{defaultMessage:"Make this field required"}),v=a.i18n.translate("xpack.cases.customFields.required",{defaultMessage:"Required"}),h=e=>a.i18n.translate("xpack.cases.customFields.requiredField",{values:{fieldName:e},defaultMessage:"{fieldName} is required."}),x=e=>a.i18n.translate("xpack.cases.caseView.editCustomFieldsAriaLabel",{values:{customFieldLabel:e},defaultMessage:"click to edit {customFieldLabel}"}),k=a.i18n.translate("xpack.cases.caseView.noCustomFieldSet",{defaultMessage:"No value is added"}),_=e=>a.i18n.translate("xpack.cases.customFields.deleteField",{values:{fieldName:e},defaultMessage:'Delete field "{fieldName}"?'}),C=a.i18n.translate("xpack.cases.customFields.deleteFieldDescription",{defaultMessage:"The field will be removed from all cases and data will be lost."}),T=a.i18n.translate("xpack.cases.customFields.fieldOptions.Delete",{defaultMessage:"Delete"}),w=a.i18n.translate("xpack.cases.customFields.tableFilters.toggle.on",{defaultMessage:"On"}),A=a.i18n.translate("xpack.cases.customFields.tableFilters.toggle.off",{defaultMessage:"Off"}),S=a.i18n.translate("xpack.cases.customFields.fieldOptions.populatedWithDefault",{defaultMessage:"This field is populated with the default value."})},1745:(e,t,s)=>{"use strict";s.d(t,{$M:()=>_,BC:()=>l,C4:()=>o,EM:()=>g,Hh:()=>m,KY:()=>r,L:()=>i,Oq:()=>h,Q7:()=>T,S:()=>x,SJ:()=>S,Uy:()=>k,WC:()=>b,ZE:()=>f,gK:()=>M,iZ:()=>C,jj:()=>w,kl:()=>n,ny:()=>v,o7:()=>u,o_:()=>p,xD:()=>y,xf:()=>A,yk:()=>E,yq:()=>c,zs:()=>d});var a=s(5008);const n=a.i18n.translate("xpack.cases.caseView.files.actions",{defaultMessage:"Actions"}),i=a.i18n.translate("xpack.cases.caseView.files.addFile",{defaultMessage:"Add file"}),r=(a.i18n.translate("xpack.cases.caseView.files.closeModal",{defaultMessage:"Close"}),a.i18n.translate("xpack.cases.caseView.files.dateAdded",{defaultMessage:"Date added"})),l=a.i18n.translate("xpack.cases.caseView.files.deleteFile",{defaultMessage:"Delete file"}),o=a.i18n.translate("xpack.cases.caseView.files.downloadFile",{defaultMessage:"Download file"}),c=a.i18n.translate("xpack.cases.caseView.files.copyFileHash",{defaultMessage:"Copy file hash"}),u=e=>a.i18n.translate("xpack.cases.caseView.files.copyFileHashSuccess",{values:{hashName:e},defaultMessage:"Copied {hashName} file hash successfully"}),d=a.i18n.translate("xpack.cases.caseView.files.filesTable",{defaultMessage:"Files table"}),p=a.i18n.translate("xpack.cases.caseView.files.name",{defaultMessage:"Name"}),g=a.i18n.translate("xpack.cases.caseView.files.noFilesAvailable",{defaultMessage:"No files available"}),m=a.i18n.translate("xpack.cases.caseView.files.noPreviewAvailable",{defaultMessage:"No preview available"}),f=(a.i18n.translate("xpack.cases.caseView.files.resultsCount",{defaultMessage:"Showing"}),a.i18n.translate("xpack.cases.caseView.files.type",{defaultMessage:"Type"})),y=a.i18n.translate("xpack.cases.caseView.files.searchPlaceholder",{defaultMessage:"Search files"}),b=a.i18n.translate("xpack.cases.caseView.files.failedUpload",{defaultMessage:"Failed to upload file"}),v=a.i18n.translate("xpack.cases.caseView.files.unknownMimeType",{defaultMessage:"Unknown"}),h=a.i18n.translate("xpack.cases.caseView.files.imageMimeType",{defaultMessage:"Image"}),x=a.i18n.translate("xpack.cases.caseView.files.textMimeType",{defaultMessage:"Text"}),k=a.i18n.translate("xpack.cases.caseView.files.compressedMimeType",{defaultMessage:"Compressed"}),_=a.i18n.translate("xpack.cases.caseView.files.pdfMimeType",{defaultMessage:"PDF"}),C=e=>a.i18n.translate("xpack.cases.caseView.files.successfulUploadFileName",{defaultMessage:"File {fileName} uploaded successfully",values:{fileName:e}}),T=e=>a.i18n.translate("xpack.cases.caseView.files.showingFilesTitle",{values:{totalFiles:e},defaultMessage:"Showing {totalFiles} {totalFiles, plural, =1 {file} other {files}}"}),w=a.i18n.translate("xpack.cases.caseView.files.added",{defaultMessage:"added "}),A=a.i18n.translate("xpack.cases.caseView.files.addedUnknownFile",{defaultMessage:"added an unknown file"}),S=a.i18n.translate("xpack.cases.caseView.files.delete",{defaultMessage:"Delete"}),E=a.i18n.translate("xpack.cases.caseView.files.deleteThisFile",{defaultMessage:"Delete this file?"}),M=a.i18n.translate("xpack.cases.caseView.files.removedFile",{defaultMessage:"removed file"})},7178:(e,t,s)=>{"use strict";s.d(t,{Ej:()=>l,Uf:()=>o,wu:()=>r,xV:()=>c});var a=s(6013),n=s(8760),i=s(1745);const r=e=>{var t;return null===(t=e.mimeType)||void 0===t?void 0:t.startsWith("image/")},l=e=>{if(void 0===e)return i.ny;if(n.fT.has(e))return i.Oq;if(n.Tq.includes(e))return i.S;if(n.EK.includes(e))return i.Uy;if(n.QI.includes(e))return i.$M;const t=e.split("/");return t.length<=1||""===t[0]?i.ny:t[0].charAt(0).toUpperCase()+t[0].slice(1)},o=e=>{var t;return a.Bs.is(e)&&(null==e||null===(t=e.files)||void 0===t?void 0:t.length)>=1},c=({fileId:e,externalReferenceMetadata:t})=>({id:e,...t.files[0]})},2712:(e,t,s)=>{"use strict";s.d(t,{CW:()=>i,H3:()=>n,ID:()=>a});const a="lens",n=`!{${a}`,i="xpack.cases.commentDraft"},7778:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var a=s(1319),n=(s(4286),s(8228));const i=(0,s(6791).jsx)(a.EuiText,{color:"subdued",size:"xs","data-test-subj":"form-optional-field-label"},n.pk)},7115:(e,t,s)=>{"use strict";s.d(t,{$K:()=>u,Al:()=>m,HQ:()=>y,HR:()=>o,J3:()=>v,M4:()=>c,SE:()=>n,WK:()=>d,at:()=>b,eX:()=>f,kk:()=>l,o:()=>g,po:()=>r,qn:()=>p,vb:()=>i});var a=s(5008);const n=a.i18n.translate("xpack.cases.systemActions.casesConnector.selectMessageText",{defaultMessage:"Create a case in Kibana."}),i=a.i18n.translate("xpack.cases.systemActions.casesConnector.groupByLabel",{defaultMessage:"Group by alert field"}),r=a.i18n.translate("xpack.cases.systemActions.casesConnector.timeWindowLabel",{defaultMessage:"Time window"}),l=a.i18n.translate("xpack.cases.systemActions.casesConnector.timeWindowValueLabel",{defaultMessage:"Time window value"}),o=a.i18n.translate("xpack.cases.systemActions.casesConnector.timeWindowUnitLabel",{defaultMessage:"Time window unit"}),c=a.i18n.translate("xpack.cases.systemActions.casesConnector.timeWindowSizeError",{defaultMessage:"Invalid time window."}),u=a.i18n.translate("xpack.cases.systemActions.casesConnector.minTimeWindowSizeError",{defaultMessage:"Time window should be at least 5 minutes"}),d=a.i18n.translate("xpack.cases.systemActions.casesConnector.reopenWhenCaseIsClosed",{defaultMessage:"Reopen when the case is closed"}),p=e=>a.i18n.translate("xpack.cases.systemActions.casesConnector.daysLabel",{defaultMessage:"{timeValue, plural, one {day} other {days}}",values:{timeValue:e}}),g=e=>a.i18n.translate("xpack.cases.systemActions.casesConnector.weeksLabel",{defaultMessage:"{timeValue, plural, one {week} other {weeks}}",values:{timeValue:e}}),m=e=>a.i18n.translate("xpack.cases.systemActions.casesConnector.hoursLabel",{defaultMessage:"{timeValue, plural, one {hour} other {hours}}",values:{timeValue:e}}),f=e=>a.i18n.translate("xpack.cases.systemActions.casesConnector.minutesLabel",{defaultMessage:"{timeValue, plural, one {minute} other {minutes}}",values:{timeValue:e}}),y=a.i18n.translate("xpack.cases.systemActions.casesConnector.defaultEmptyTemplateName",{defaultMessage:"No template selected"}),b=(a.i18n.translate("xpack.cases.systemActions.casesConnector.groupByAlertOptionalField",{defaultMessage:"Optional"}),a.i18n.translate("xpack.cases.systemActions.casesConnector.timeWindowWarning",{defaultMessage:"Setting a time window of 20 minutes or less may increase the number of cases generated by this action."})),v=a.i18n.translate("xpack.cases.systemActions.casesConnector.attackDiscoveryTemplateTooltip",{defaultMessage:"Attack Discovery Schedules fully manage Case actions, automatically filling in all fields for new Cases."})},3480:(e,t,s)=>{"use strict";s.d(t,{G:()=>o});var a=s(4286),n=s.n(a),i=s(6791);const r=(0,i.css)("text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:",3,";-webkit-box-orient:vertical;overflow:hidden;word-break:break-word;",""),l=({text:e})=>(0,i.jsx)("span",{css:r,title:e},e);l.displayName="TruncatedText";const o=n().memo(l)},2432:(e,t,s)=>{"use strict";s.d(t,{$_:()=>y,Ez:()=>b,HV:()=>i.HV,I_:()=>u,L9:()=>r,S0:()=>g,Yr:()=>f,ab:()=>l,l5:()=>p,nh:()=>o,o2:()=>d,yD:()=>c,yt:()=>m});var a=s(5008),n=s(6735),i=s(8228);const r=a.i18n.translate("xpack.cases.userProfile.removeAssigneeToolTip",{defaultMessage:"Remove assignee"}),l=a.i18n.translate("xpack.cases.userProfile.removeAssigneeAriaLabel",{defaultMessage:"click to remove assignee"}),o=a.i18n.translate("xpack.cases.userProfile.missingProfile",{defaultMessage:"Unable to find user profile"}),c=a.i18n.translate("xpack.cases.userProfile.selectableSearchPlaceholder",{defaultMessage:"Search users"}),u=a.i18n.translate("xpack.cases.userProfile.editAssignees",{defaultMessage:"Edit assignees"}),d=a.i18n.translate("xpack.cases.userProfile.suggestUsers.removeAssignees",{defaultMessage:"Remove all assignees"}),p=a.i18n.translate("xpack.cases.userProfile.assigneesTitle",{defaultMessage:"Assignees"}),g=a.i18n.translate("xpack.cases.userProfiles.userDoesNotExist",{defaultMessage:"User doesn't exist or is unavailable"}),m=a.i18n.translate("xpack.cases.userProfiles.learnPrivileges",{defaultMessage:"Learn what privileges grant access to cases."}),f=a.i18n.translate("xpack.cases.userProfiles.modifySearch",{defaultMessage:"Modify your search or check the user's privileges."}),y=a.i18n.translate("xpack.cases.create.invalidAssignees",{defaultMessage:"You cannot assign more than {maxAssignees} assignees to a case.",values:{maxAssignees:n.TO}}),b=e=>a.i18n.translate("xpack.cases.userProfile.maxSelectedAssignees",{defaultMessage:"You've selected the maximum number of {count, plural, one {# assignee} other {# assignees}}",values:{count:e}})},240:(e,t,s)=>{"use strict";s.d(t,{a:()=>n,d:()=>l});var a=s(770);const n=(e,t)=>{const s=e.username;if(null!=e.profileUid){const a=null==t?void 0:t.get(e.profileUid);return null!=a?{key:a.uid,userInfo:a}:i(s)?r(s,e):{key:e.profileUid,userInfo:{}}}if(i(s))return r(s,e)},i=e=>!(0,a.isEmpty)(e),r=(e,t)=>{var s,a;return{key:e,userInfo:{user:{username:e,full_name:null!==(s=t.fullName)&&void 0!==s?s:void 0,email:null!==(a=t.email)&&void 0!==a?a:void 0}}}},l=e=>({uid:e.profileUid,user:{email:e.email,full_name:e.fullName,username:e.username}})},7402:(e,t,s)=>{"use strict";s.d(t,{Gq:()=>h,Ho:()=>m,Kd:()=>C,WP:()=>g,Xm:()=>_,Xv:()=>T,Zl:()=>f,b1:()=>u,mm:()=>w,n_:()=>y,sK:()=>l,s_:()=>c,sn:()=>b,tu:()=>k,vx:()=>v,xN:()=>d}),s(6791);var a=s(770),n=s(6013),i=s(9049),r=s(240);const l=(e,t)=>{var s;return null!==(s=t.find((t=>t.id===e)))&&void 0!==s?s:null},o={[n.J4.swimlane]:i.Y},c=({connectors:e=[],config:t={}})=>({...t,validations:[{validator:({value:t})=>{const s=l(t,e);if(null!=s)return(e=>{if(e.isDeprecated)return{message:"Deprecated connector"}})(s)}},{validator:({value:t})=>{const s=l(t,e);var a;if(null!=s)return null===(a=o[s.actionTypeId])||void 0===a?void 0:a.call(o,s)}}]}),u=e=>{if(e.fields){const t=d(e.fields);return{...e,fields:t}}return e},d=e=>e?Object.entries(e).reduce(((e,[t,s])=>({...e,[t]:p(s)?null:s})),{}):null,p=e=>null==e||"object"==typeof e&&0===Object.keys(e).length||"string"==typeof e&&0===e.trim().length,g=e=>{if(e.fields){const t=Object.entries(e.fields).reduce(((e,[t,s])=>({...e,[t]:null===s?void 0:s})),{});return{...e,fields:t}}return e},m=(e,t)=>{if(null==t)return"";try{if(e.actionTypeRegistry.has(t))return e.actionTypeRegistry.get(t).iconClass}catch{return""}return""},f=e=>{var t;return null!==(t=null==e?void 0:e.isDeprecated)&&void 0!==t&&t},y=e=>{window.sessionStorage.removeItem(e)},b=e=>new URLSearchParams(e).toString(),v=e=>Object.fromEntries(new URLSearchParams(e)),h=({caseUsers:e,createdBy:t})=>{const s=new Map,a=null!=(null==e?void 0:e.reporter)?[e.reporter]:[(0,r.d)(t)];if(e)for(const t of[...e.assignees,...e.participants,e.reporter,...e.unassignedUsers])null!=t.uid&&null!=t.user.username&&s.set(t.uid,{uid:t.uid,user:t.user,data:{avatar:t.avatar}});return{userProfiles:s,reporterAsArray:a}},x=({value:e,type:t})=>"string"==typeof e&&(0,a.isEmpty)(e)?null:t===n.je.NUMBER?null!==e&&Number.isSafeInteger(Number(e))?Number(e):null:e,k=(e,t)=>-1===e.findIndex((e=>e.key===t.key))?[...e,t]:e.map((e=>e.key!==t.key?e:t));function _(e){return Object.fromEntries(Object.entries(e).filter((([e,t])=>!(0,a.isEmpty)(t)||"boolean"==typeof t)).map((([e,t])=>[e,t!==Object(t)||Array.isArray(t)?t:_(t)])))}const C=e=>e&&e.length?e.reduce(((e,t)=>({...e,[t.key]:t.value})),{}):null,T=(e,t)=>{const s=[];if(!e||!t.length)return[];for(const[a,n]of Object.entries(e)){const e=t.find((e=>e.key===a));e&&s.push({key:e.key,type:e.type,value:x({value:n,type:e.type})})}return s},w={name:"1aspmgj",styles:"& .euiMarkdownFormat img{max-width:100%;height:auto;}"}},3628:(e,t,s)=>{"use strict";s.d(t,{_:()=>a});const a="embeddable_addToExistingCase"},509:(e,t,s)=>{"use strict";s.d(t,{M:()=>c});var a=s(4286),n=s.n(a),i=s(6791),r=s(1319),l=s(3867);const o=({attributes:e,timeRange:t,metadata:s})=>{const{lens:{EmbeddableComponent:a}}=(0,l.o1)().services,{euiTheme:o}=(0,r.useEuiTheme)();return e?(0,i.jsx)(n().Fragment,null,s&&s.description&&(0,i.jsx)(n().Fragment,null,s.description,(0,i.jsx)(r.EuiSpacer,{size:"s"})),(0,i.jsx)("div",{css:(0,i.css)("min-height:",200,"px;","")},(0,i.jsx)(a,{id:"",style:{height:200},timeRange:t,attributes:e,renderMode:"view",disableTriggers:!0,executionContext:{type:"cases"},syncTooltips:!1,syncCursor:!1}),(0,i.jsx)(i.Global,{styles:(0,i.css)("div.euiOverlayMask[data-relative-to-header='above']~[id^='echTooltipPortal']{z-index:",o.levels.modal,"!important;}","")}))):null};o.displayName="LensRenderer";const c=n().memo(o)},4711:(e,t,s)=>{"use strict";s.d(t,{AE:()=>n,Yr:()=>i,et:()=>r});var a=s(5008);const n=a.i18n.translate("xpack.cases.caseView.visualizations.addedVisualization",{defaultMessage:"added visualization"}),i=a.i18n.translate("xpack.cases.caseView.visualizations.removedVisualization",{defaultMessage:"removed visualization"}),r=a.i18n.translate("xpack.cases.caseView.visualizations.openVisualizationButtonLabel",{defaultMessage:"Open visualization"})},9962:(e,t,s)=>{"use strict";s.d(t,{fY:()=>D,N2:()=>j,ny:()=>E,Tu:()=>S,w2:()=>F,f2:()=>L,QL:()=>v,k_:()=>b,aE:()=>O,x5:()=>N,MM:()=>h,Vw:()=>R,Eh:()=>k,bW:()=>f,TG:()=>P,v5:()=>$,ig:()=>y,Q2:()=>m,bz:()=>C,IQ:()=>A,GY:()=>V,Dw:()=>_,Sh:()=>I,zZ:()=>M,aM:()=>w,l7:()=>g,bZ:()=>T});var a=s(9219),n=s(6013),i=s(3844),r=s(3192),l=s(6735),o=s(8849),c=s(3867),u=s(9614),d=s(6338),p=s(2196);const g=async({caseId:e,signal:t})=>{const s=await c.P7.get().http.fetch(`${(0,r.Yt)(e)}/resolve`,{method:"GET",query:{includeComments:!0},signal:t});return(0,u.vZ)((0,d._T)(s))},m=async({owner:e,signal:t})=>{const s=await c.P7.get().http.fetch(l.$J,{method:"GET",signal:t,query:{...e.length>0?{owner:e}:{}}});return null!=s?s:[]},f=async({owner:e,signal:t})=>{const s=await c.P7.get().http.fetch(l.N3,{method:"GET",signal:t,query:{...e.length>0?{owner:e}:{}}});return null!=s?s:[]},y=async(e,t,s)=>{const a=await c.P7.get().http.fetch((0,r.ZY)(e),{method:"GET",signal:s,query:{features:JSON.stringify(t)}});return(0,u.fp)((0,d.d9)(a))},b=async(e,t)=>{const s=await c.P7.get().http.fetch(`${l.qd}`,{method:"POST",body:JSON.stringify({alertIds:e,caseIds:t})});return(0,d.XC)(s)},v=async(e,t,s)=>{const a={types:"all"!==t.type?[t.type]:[],sortOrder:t.sortOrder,page:t.page,perPage:t.perPage},n=await c.P7.get().http.fetch((0,r.T)(e),{method:"GET",query:a,signal:s});return{...n,userActions:(0,u.XA)((0,d._o)(n.userActions)),latestAttachments:(0,u.T2)(n.latestAttachments)}},h=async(e,t)=>{const s=await c.P7.get().http.fetch((0,r.Y2)(e),{method:"GET",signal:t});return(0,u.fp)((0,d.Y_)(s))},x=({filterKey:e,filterOptions:t,optionToBeRemoved:s})=>{const a=t.filter((e=>e!==s));return 0===a.length?{}:{[e]:a}},k=async({filterOptions:e={search:"",searchFields:[],severity:[],assignees:[],reporters:[],status:[],tags:[],owner:[],category:[],customFields:{}},queryParams:t={page:1,perPage:20,sortField:i.xv.createdAt,sortOrder:"desc"},signal:s})=>{const a={...x({filterKey:"status",filterOptions:e.status,optionToBeRemoved:"all"}),...x({filterKey:"severity",filterOptions:e.severity,optionToBeRemoved:"all"}),...(0,d.oD)(e.assignees),...(0,d.Gd)(e.reporters),...e.tags.length>0?{tags:e.tags}:{},...e.search.length>0?{search:e.search}:{},...e.searchFields.length>0?{searchFields:e.searchFields}:{},...e.owner.length>0?{owner:e.owner}:{},...e.category.length>0?{category:e.category}:{},...(0,d.oe)(e.customFields),...t},n=await c.P7.get().http.fetch(`${l.__}/_search`,{method:"POST",body:JSON.stringify(a),signal:s});return(0,u.Dl)((0,p.wl)(n))},_=async({newCase:e,signal:t})=>{const s={...e,...null!=e.category?{category:e.category}:{category:null}},a=await c.P7.get().http.fetch(l.gv,{method:"POST",body:JSON.stringify(s),signal:t});return(0,u.FA)((0,d.cv)(a))},C=async({caseId:e,updatedCase:t,version:s,signal:a})=>{const n=await c.P7.get().http.fetch(l.gv,{method:"PATCH",body:JSON.stringify({cases:[{...t,id:e,version:s}]}),signal:a});return(0,u.eD)((0,d.Rl)(n))},T=async({cases:e,signal:t})=>{if(0===e.length)return[];const s=await c.P7.get().http.fetch(l.gv,{method:"PATCH",body:JSON.stringify({cases:e}),signal:t});return(0,u.eD)((0,d.Rl)(s))},w=async({caseId:e,customFieldId:t,request:s,signal:a})=>{const n=await c.P7.get().http.fetch((0,r.rB)(e,t),{method:"PUT",body:JSON.stringify(s),signal:a});return(0,u.fp)(n)},A=async({caseId:e,commentId:t,commentUpdate:s,version:a,owner:i,signal:l})=>{const o=await c.P7.get().http.fetch((0,r.uf)(e),{method:"PATCH",body:JSON.stringify({comment:s,type:n.wh.user,id:t,version:a,owner:i}),signal:l});return(0,u.FA)((0,d.cv)(o))},S=async({caseId:e,commentId:t,signal:s})=>{await c.P7.get().http.fetch((0,r.k5)(e,t),{method:"DELETE",signal:s})},E=async({caseIds:e,signal:t})=>await c.P7.get().http.fetch(l.gv,{method:"DELETE",query:{ids:JSON.stringify(e)},signal:t}),M=async({caseId:e,connectorId:t,signal:s})=>{const a=await c.P7.get().http.fetch((0,r.o$)(e,t),{method:"POST",body:JSON.stringify({}),signal:s});return(0,u.FA)((0,d.cv)(a))},O=async e=>{const t=await c.P7.get().http.fetch((0,o.bW)(),{method:"GET",signal:e});return(0,u.cq)(t)},j=async({attachments:e,caseId:t,signal:s})=>{const a=await c.P7.get().http.fetch(l.ZY.replace("{case_id}",t),{method:"POST",body:JSON.stringify(e),signal:s});return(0,u.FA)((0,d.cv)(a))},F=async({caseId:e,fileIds:t,signal:s})=>{await c.P7.get().http.fetch((0,r.Ic)(e),{method:"POST",body:JSON.stringify({ids:t}),signal:s})},P=async({query:e,signal:t})=>c.P7.get().http.post("/internal/rac/alerts/find",{method:"POST",body:JSON.stringify({aggs:{consumer:{terms:{field:a.fJ,size:100}},producer:{terms:{field:a.Rn,size:100}},ruleTypeIds:{terms:{field:a.tV,size:100}}},query:e}),signal:t}),N=async(e,t)=>{const s=await c.P7.get().http.fetch((0,r.Q1)(e),{method:"GET",signal:t});return Object.keys(s).reduce(((e,t)=>(e[t]={...(0,u.fp)(s[t])},e)),{})},R=async({caseId:e,signal:t})=>c.P7.get().http.fetch((0,r.Mi)(e),{method:"GET",signal:t}),I=async(e,t,s)=>{const a=await c.P7.get().http.fetch((0,r.NH)(t),{method:"POST",body:JSON.stringify({observable:e.observable}),signal:s});return(0,u.FA)((0,d.cv)(a))},V=async(e,t,s,a)=>{const n=await c.P7.get().http.fetch((0,r.gX)(t,s),{method:"PATCH",body:JSON.stringify({observable:e.observable}),signal:a});return(0,u.FA)((0,d.cv)(n))},L=async(e,t,s)=>{await c.P7.get().http.fetch((0,r.CZ)(e,t),{method:"DELETE",signal:s})},D=async(e,t)=>{const s=await c.P7.get().http.fetch((0,r.Mf)(e.caseId),{method:"POST",body:JSON.stringify({caseId:e.caseId,observables:e.observables}),signal:t});return(0,u.FA)((0,d.cv)(s))},$=async({caseId:e,signal:t,perPage:s,page:a})=>{const n=await c.P7.get().http.fetch((0,r.Ot)(e),{method:"POST",body:JSON.stringify({page:a,perPage:s}),signal:t});return(0,u.dh)((0,p._p)(n))}},6990:(e,t,s)=>{"use strict";s.d(t,{tO:()=>o,CY:()=>r,EV:()=>l,wU:()=>i,Yy:()=>n});var a=s(7297);const n={all:["cases"],users:["users"],connectors:["connectors"],alerts:["alerts"],userActions:["user-actions"],connectorsList:()=>[...n.connectors,"list"],casesList:()=>[...n.all,"list"],casesMetrics:()=>[...n.casesList(),"metrics"],casesStatuses:()=>[...n.casesList(),"statuses"],cases:e=>[...n.casesList(),"all-cases",e],similarCases:(e,t)=>[...n.caseView(),e,"similar",t],caseView:()=>[...n.all,"case"],case:e=>[...n.caseView(),e],caseFiles:(e,t)=>[...n.case(e),"files",t],caseFileStats:e=>[...n.case(e),"files","stats"],caseMetrics:(e,t)=>[...n.case(e),"metrics",t],caseConnectors:e=>[...n.case(e),"connectors"],caseUsers:e=>[...n.case(e),"users"],caseUserActions:(e,t)=>[...n.case(e),...n.userActions,t],caseUserActionsStats:e=>[...n.case(e),...n.userActions,"stats"],userProfiles:()=>[...n.users,"user-profiles"],userProfilesList:e=>[...n.userProfiles(),e],currentUser:()=>[...n.users,"current-user"],suggestUsers:e=>[...n.users,"suggest",e],connectorTypes:()=>[...n.connectors,"types"],license:()=>[...n.connectors,"license"],tags:()=>[...n.all,"tags"],categories:()=>[...n.all,"categories"],alertFeatureIds:e=>[...n.alerts,"features",e],configuration:e=>[...n.all,"configuration",e]},i={createCase:["create-case"],deleteCases:["delete-cases"],updateCase:["update-case"],updateCases:["update-cases"],pushCase:["push-case"],updateComment:["update-comment"],deleteComment:["delete-comment"],deleteFileAttachment:["delete-file-attachment"],bulkCreateAttachments:["bulk-create-attachments"],persistCaseConfiguration:["persist-case-configuration"],replaceCustomField:["replace-custom-field"],postObservable:["post-observable"],patchObservable:["patch-observable"],deleteObservable:["delete-observable"],bulkPostObservables:["bulk-post-observables"]},r={search:"",searchFields:["title","description","incremental_id.text"],severity:[],assignees:[],reporters:[],status:[],tags:[],owner:[],category:[],customFields:{}},l={page:1,perPage:10,sortField:a.xv.createdAt,sortOrder:"desc"},o={filterOptions:r,queryParams:l}},3423:(e,t,s)=>{"use strict";s.d(t,{Fe:()=>l,Fl:()=>g,PR:()=>c,Qz:()=>v,TQ:()=>m,To:()=>y,_Y:()=>x,a2:()=>n,ah:()=>i,fe:()=>p,gE:()=>r,hZ:()=>d,jx:()=>f,kk:()=>h,lb:()=>b,nH:()=>u,s$:()=>o});var a=s(5008);s(8228);const n=a.i18n.translate("xpack.cases.containers.errorTitle",{defaultMessage:"Error fetching data"}),i=a.i18n.translate("xpack.cases.containers.errorCreatingCaseTitle",{defaultMessage:"Error creating case"}),r=a.i18n.translate("xpack.cases.containers.errorDeletingTitle",{defaultMessage:"Error deleting data"}),l=a.i18n.translate("xpack.cases.containers.errorDeletingFile",{defaultMessage:"Error deleting file"}),o=a.i18n.translate("xpack.cases.containers.errorUpdatingTitle",{defaultMessage:"Error updating data"}),c=e=>a.i18n.translate("xpack.cases.containers.updatedCase",{values:{caseTitle:e},defaultMessage:'Updated "{caseTitle}"'}),u=(a.i18n.translate("xpack.cases.containers.updatedCases",{defaultMessage:"Updated cases"}),e=>a.i18n.translate("xpack.cases.containers.pushToExternalService",{values:{serviceName:e},defaultMessage:"Successfully sent to { serviceName }"})),d=e=>a.i18n.translate("xpack.cases.containers.syncCase",{values:{caseTitle:e},defaultMessage:'Alerts in "{caseTitle}" have been synced'}),p=e=>a.i18n.translate("xpack.cases.containers.extractObservables",{values:{caseTitle:e},defaultMessage:'Auto-extract observables setting in "{caseTitle}" have been updated'}),g=a.i18n.translate("xpack.cases.containers.statusChangeToasterText",{defaultMessage:"Updated the statuses of attached alerts."}),m=a.i18n.translate("xpack.cases.containers.deleteSuccess",{defaultMessage:"File deleted successfully"}),f=a.i18n.translate("xpack.cases.containers.categoriesErrorTitle",{defaultMessage:"Error fetching categories"}),y=a.i18n.translate("xpack.cases.caseView.observables.created",{defaultMessage:"Observable created"}),b=a.i18n.translate("xpack.cases.caseView.observables.removed",{defaultMessage:"Observable removed"}),v=a.i18n.translate("xpack.cases.caseView.observables.updated",{defaultMessage:"Observable updated"}),h=a.i18n.translate("xpack.cases.caseView.observables.bulkCreated",{defaultMessage:"Observables added"}),x=e=>a.i18n.translate("xpack.cases.caseView.observables.maxReached",{values:{maxObservables:e},defaultMessage:"You've reached the maximum number of observables {maxObservables} that can be added to a case. Some observables were not added."})},1199:(e,t,s)=>{"use strict";s.d(t,{U:()=>c});var a=s(3530),n=s(6735),i=s(9962),r=s(3423),l=s(4621),o=s(6990);const c=()=>{const{showErrorToast:e,showInfoToast:t}=(0,l.a)();return(0,a.useMutation)((e=>(0,i.fY)(e)),{mutationKey:o.wU.bulkPostObservables,onError:t=>{e(t,{title:r.a2})},onSuccess:e=>{e.observables.length>=n.zz&&t(r.kk,(0,r._Y)(n.zz))}})}},5498:(e,t,s)=>{"use strict";s.d(t,{Q:()=>o});var a=s(3530),n=s(9962),i=s(3423),r=s(4621),l=s(6990);const o=()=>{const{showErrorToast:e}=(0,r.a)();return(0,a.useMutation)((e=>{const t=e.attachments.map((t=>({...t,owner:e.caseOwner})));return(0,n.N2)({attachments:t,caseId:e.caseId})}),{mutationKey:l.wU.bulkCreateAttachments,onError:t=>{e(t,{title:i.a2})}})}},6338:(e,t,s)=>{"use strict";s.d(t,{AC:()=>k,Be:()=>O,D1:()=>A,Gd:()=>E,Rl:()=>h,XC:()=>T,Xw:()=>x,Y_:()=>C,_T:()=>b,_o:()=>_,cv:()=>y,d9:()=>v,jT:()=>f,oD:()=>S,oe:()=>M,v1:()=>m});var a=s(8915),n=s(770),i=s(1639),r=s(166),l=s(6730),o=s(1119),c=s(6013),u=s(3198),d=s(6735),p=s(3192),g=s(3423);const m=e=>e,f=e=>new ToasterError([e]),y=e=>(0,l.pipe)(c.xv.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),b=e=>(0,l.pipe)(u.EO.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),v=e=>(0,l.pipe)(u.P6.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),h=e=>(0,l.pipe)(c.Wm.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),x=e=>(0,l.pipe)(c.wp.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),k=e=>(0,l.pipe)(c.Vv.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),_=e=>(0,l.pipe)(c.fm.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),C=e=>(0,l.pipe)(u.oW.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),T=e=>(0,r.pipe)(u.kd.decode(e),(0,i.fold)((0,p.kB)(f),r.identity)),w=(e,t)=>"settings"===e;class ToasterError extends Error{constructor(e){super(e[0]),(0,a.default)(this,"messages",void 0),this.name="ToasterError",this.messages=e}}const A=(e,t,s,a)=>{const n=e.comments.some((e=>e.type===c.wh.alert)),i={title:g.PR(t.title),className:"eui-textBreakWord"};return w(s)&&null!=a&&a.syncAlerts&&n&&e.settings.syncAlerts!==(null==a?void 0:a.syncAlerts)?{...i,title:g.hZ(t.title)}:w(s)&&e.settings.extractObservables!==(null==a?void 0:a.extractObservables)?{...i,title:g.fe(t.title)}:(e=>"status"===e)(s)&&n&&e.settings.syncAlerts?{...i,text:g.Fl}:i},S=e=>{var t;return e.length>0?{assignees:null!==(t=null==e?void 0:e.map((e=>null===e?d._y:e)))&&void 0!==t?t:[d._y]}:{}},E=e=>e.length>0?{reporters:e.map((e=>{var t;return null!=e.profile_uid?e.profile_uid:null!==(t=e.username)&&void 0!==t?t:""})).filter((e=>!(0,n.isEmpty)(e)))}:{},M=e=>{if(!e||0===Object.keys(e).length)return{};const t={};for(const[s,a]of Object.entries(e)){const{type:e,options:n}=a;if(o.k[e]){const{filterOptions:a=[]}=o.k[e](),i=n.map((e=>{const t=a.find((t=>t.key===e));return t?t.value:void 0})).filter((e=>void 0!==e));i.length>0&&(t[s]=i)}}return Object.keys(t).length?{customFields:t}:{}},O=e=>{var t;const s=/^#(\d{1,50})\s*$/;let a={},n=null==e?void 0:e.trim();const i=s.test(null!==(t=n)&&void 0!==t?t:"");var r,l;return n&&i&&(n=null!==(r=null===(l=s.exec(n))||void 0===l?void 0:l[1])&&void 0!==r?r:n,a={searchFields:["incremental_id.text"],search:n}),a}},9942:(e,t,s)=>{"use strict";s.d(t,{q:()=>c,J:()=>u});var a=s(6735),n=s(2194),i=s(5008);const r=e=>i.i18n.translate("xpack.cases.files.deleteReason",{values:{owner:e},defaultMessage:"This file is managed by Cases. Navigate to the Cases page under {owner} to delete it."}),l=e=>{switch(e){case a.tn:return"Security";case a.qN:return"Observability";case a.V0:return"Stack Management";default:return e}},o=(e,t)=>{var s;return{id:(0,n.Ng)(t),allowedMimeTypes:e.allowedMimeTypes,maxSizeBytes:null!==(s=e.maxSize)&&void 0!==s?s:a.dG,managementUiActions:{delete:{enabled:!1,reason:r(l(t))}}}},c=e=>a.H1.includes(e),u=(e,t)=>{const s=(e=>{const t=new Map;for(const s of a.H1)t.set(s,o(e,s));return t})(e);for(const e of s.values())t.registerFileKind(e)}},7455:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CasesDeepLinkId:()=>ge.Bu,DRAFT_COMMENT_STORAGE_ID:()=>pe.CW,generateCaseViewPath:()=>ge._M,getCasesDeepLinks:()=>ge.Rh,plugin:()=>me});var a=s(8915),n=s(1215);const i=__kbnSharedDeps__.History;var r=s(3867),l=s(6735),o=s(8228),c=s(4407),u=s(921),d=s(4756);const p=()=>{const{selectCaseModal:e,createCaseFlyout:t}=(0,d.J)();return e.isModalOpen||t.isFlyoutOpen};var g=s(3192),m=s(2537);const f=({http:e})=>({getRelatedCases:async(t,s)=>e.get((0,g.uE)(t),{query:s}),cases:{find:(t,s)=>(0,m.Eh)({http:e,query:t,signal:s}),getCasesMetrics:(t,s)=>(0,m.lY)({http:e,signal:s,query:t}),bulkGet:(t,s)=>(0,m.es)({http:e,signal:s,params:t})}});var y=s(5630),b=s(9219),v=s(1060);function h(e){var t,s,a,n;const i=e&&e.data.find((({field:e})=>e===b._9)),r=e&&e.data.find((({field:e})=>e===b.qT)),l=i&&i.value&&i.value[0],o=r&&r.value&&r.value[0];return{id:null!==(t=null!==(s=null!=l?l:(0,v.get)(`ecs.${b._9}[0]`,e))&&void 0!==s?s:(0,v.get)("ecs.signal.rule.id[0]",e))&&void 0!==t?t:null,name:null!==(a=null!==(n=null!=o?o:(0,v.get)(`ecs.${b.qT}[0]`,e))&&void 0!==n?n:(0,v.get)("ecs.signal.rule.name[0]",e))&&void 0!==a?a:null}}var x=s(7033),k=s(7659),_=s(3185),C=s(1319),T=s(4286),w=s.n(T),A=s(6791);const S=(0,T.lazy)((()=>Promise.resolve().then(s.bind(s,6558)))),E=({externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,owner:s,permissions:a,features:n,children:i,releasePhase:r,getFilesClient:l})=>(0,A.jsx)(T.Suspense,{fallback:(0,A.jsx)(C.EuiLoadingSpinner,null)},(0,A.jsx)(S,{value:{externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,owner:s,permissions:a,features:n,releasePhase:r,getFilesClient:l}},i));E.displayName="CasesProviderLazyWrapper";var M=s(6558);const O=(0,T.lazy)((()=>Promise.all([s.e(678),s.e(312)]).then(s.bind(s,5312))));var j=s(6013);const F=e=>{const t=e.reduce(((e,t)=>{const s=h(t);e[s.id]||(e[s.id]={alertId:[],index:[],type:j.wh.alert,rule:s});const a=e[s.id].alertId,n=e[s.id].index;var i,r;return Array.isArray(a)&&Array.isArray(n)&&(a.push(null!==(i=t.ecs._id)&&void 0!==i?i:""),n.push(null!==(r=t.ecs._index)&&void 0!==r?r:"")),e}),{});return Object.values(t)};var P=s(3222),N=s(5008);class AttachmentTypeRegistry{constructor(e){(0,a.default)(this,"collection",new Map),this.name=e}has(e){return this.collection.has(e)}register(e){if(this.has(e.id))throw new Error(N.i18n.translate("xpack.cases.registry.register.duplicateItemErrorMessage",{defaultMessage:'Item "{id}" is already registered on registry {name}',values:{id:e.id,name:this.name}}));this.collection.set(e.id,e)}get(e){const t=this.collection.get(e);if(!t)throw new Error(N.i18n.translate("xpack.cases.registry.get.missingItemErrorMessage",{defaultMessage:'Item "{id}" is not registered on registry {name}',values:{id:e,name:this.name}}));return t}list(){return Array.from(this.collection.values())}}class ExternalReferenceAttachmentTypeRegistry extends AttachmentTypeRegistry{constructor(){super("ExternalReferenceAttachmentTypeRegistry")}}class PersistableStateAttachmentTypeRegistry extends AttachmentTypeRegistry{constructor(){super("PersistableStateAttachmentTypeRegistry")}}var R=s(9942),I=s(8274),V=s(1745),L=s(7178);const D=(0,T.lazy)((()=>s.e(942).then(s.bind(s,4942)).then((e=>({default:e.FileAttachmentEvent}))))),$=(0,T.lazy)((()=>s.e(254).then(s.bind(s,5254)).then((e=>({default:e.FileDeleteButton}))))),U=(0,T.lazy)((()=>s.e(469).then(s.bind(s,2469)).then((e=>({default:e.FileDownloadButton}))))),B=(0,T.lazy)((()=>s.e(38).then(s.bind(s,6038)).then((e=>({default:e.FileThumbnail})))));function z(e,t){return(0,A.jsx)(T.Suspense,{fallback:(0,A.jsx)(C.EuiLoadingSpinner,null)},(0,A.jsx)($,{caseId:e,fileId:t,isIcon:!1}))}const q=e=>{const t=e.caseData.id,s=e.externalReferenceId;if(!(0,L.Uf)(e.externalReferenceMetadata))return{event:V.xf,timelineAvatar:"document",getActions:()=>[{type:I.A.CUSTOM,render:()=>z(t,s),isPrimary:!1}],hideDefaultActions:!0};const a=(0,L.xV)({fileId:s,externalReferenceMetadata:e.externalReferenceMetadata});return{event:(0,A.jsx)(T.Suspense,{fallback:(0,A.jsx)(C.EuiLoadingSpinner,null)},(0,A.jsx)(D,{file:a})),timelineAvatar:(0,L.wu)(a)?"image":"document",getActions:()=>(({caseId:e,fileId:t})=>[{type:I.A.CUSTOM,render:()=>function(e){return(0,A.jsx)(T.Suspense,{fallback:(0,A.jsx)(C.EuiLoadingSpinner,null)},(0,A.jsx)(U,{fileId:e,isIcon:!1}))}(t),isPrimary:!1},{type:I.A.CUSTOM,render:()=>z(e,t),isPrimary:!1}])({caseId:t,fileId:s}),hideDefaultActions:!0,children:(0,L.wu)(a)?B:void 0}};var G=s(4513),H=s.n(G),W=s(7),Y=s(4711),K=s(5964);const Z=({attachmentId:e,attributes:t,timeRange:s})=>{const{lens:{navigateToPrefilledEditor:a,canUseEditor:n}}=(0,r.o1)().services,i=(0,T.useCallback)((()=>{a({id:e,timeRange:s,attributes:t},{openInNewTab:!0})}),[e,t,a,s]),l=n(),o=(0,K.isOfAggregateQueryType)(t.state.query);return!l||o?null:(0,A.jsx)(C.EuiButtonEmpty,{"aria-label":Y.et,"data-test-subj":"cases-open-in-visualization-btn",iconType:"lensApp",isDisabled:!l,onClick:i},Y.et)};Z.displayName="OpenLensButton";const J=w().memo(Z);var Q=s(509);const X=w().memo((e=>{const{attributes:t,timeRange:s,metadata:a}=e.persistableStateAttachmentState;return(0,A.jsx)(Q.M,{attributes:t,timeRange:s,metadata:a})}),((e,t)=>H()(e.persistableStateAttachmentState,t.persistableStateAttachmentState)));X.displayName="LensAttachment";const ee=w().lazy((async()=>({default:X}))),te=({attachmentId:e,persistableStateAttachmentState:t})=>{const{attributes:s,timeRange:a}=t;return{event:Y.AE,timelineAvatar:"lensApp",getActions:()=>((e,t)=>[{type:I.A.CUSTOM,render:()=>function(e,t){return(0,A.jsx)(J,{attachmentId:e,attributes:t.attributes,timeRange:t.timeRange,metadata:t.metadata})}(e,t),isPrimary:!1}])(e,{attributes:s,timeRange:a}),hideDefaultActions:!1,children:ee}};var se=s(7546),ae=s(3628),ne=s(7115);var ie=s(770),re=s(4578);const le=e=>e.includes(":")?"IPV6":"IPV4",oe=["cdhash","md5","sha1","sha256","sha384","sha512","ssdeep","tlsh"],ce=["dll","file","process"],ue=(e,t,s,a)=>{const n=`${s}-${t}`;e.has(n)||e.set(n,{typeKey:s,value:t,description:a})},de=e=>{const t=new Map,s=N.i18n.translate("xpack.cases.caseView.observables.autoExtract.description",{defaultMessage:"Auto extracted observable"}),a=ce.map((e=>oe.map((t=>`${e}.hash.${t}`)))).flat();for(const n of e)for(const e of n)e.value&&("source.ip"===e.field&&(0,ie.castArray)(e.value).forEach((e=>{const a=le(e);ue(t,e,"IPV4"===a?re.zX.key:re.lB.key,s)})),"destination.ip"===e.field&&(0,ie.castArray)(e.value).forEach((e=>{const a=le(e);ue(t,e,"IPV4"===a?re.zX.key:re.lB.key,s)})),"host.name"===e.field&&(0,ie.castArray)(e.value).forEach((e=>{e&&ue(t,e,re.vg.key,s)})),a.includes(e.field)&&(0,ie.castArray)(e.value).forEach((e=>{ue(t,e,re.N2.key,s)})),"file.path"===e.field&&(0,ie.castArray)(e.value).forEach((e=>{ue(t,e,re.w2.key,s)})),"dns.question.name"===e.field&&(0,ie.castArray)(e.value).forEach((e=>{ue(t,e,re.qT.key,s)})),"agent.id"===e.field&&(0,ie.castArray)(e.value).forEach((e=>{ue(t,e,re.Bq.key,s)})));return Array.from(t.values())};class CasesUiPlugin{constructor(e){(0,a.default)(this,"kibanaVersion",void 0),(0,a.default)(this,"storage",new n.Storage(localStorage)),(0,a.default)(this,"externalReferenceAttachmentTypeRegistry",void 0),(0,a.default)(this,"persistableStateAttachmentTypeRegistry",void 0),this.initializerContext=e,this.kibanaVersion=e.env.packageInfo.version,this.externalReferenceAttachmentTypeRegistry=new ExternalReferenceAttachmentTypeRegistry,this.persistableStateAttachmentTypeRegistry=new PersistableStateAttachmentTypeRegistry}setup(e,t){const a=this.kibanaVersion,n=this.storage,i=this.externalReferenceAttachmentTypeRegistry,r=this.persistableStateAttachmentTypeRegistry;var c;c=r,i.register({id:l.mR,icon:"document",displayName:"Files",getAttachmentViewObject:q,getAttachmentRemovalObject:()=>({event:V.gK})}),c.register({id:W.I,icon:"document",displayName:"Visualizations",getAttachmentViewObject:te,getAttachmentRemovalObject:()=>({event:Y.Yr})});const u=this.initializerContext.config.get();return(0,R.J)(u.files,t.files),t.home&&t.home.featureCatalogue.register({id:l.sZ,title:o.B_,description:o.Un,icon:"casesApp",path:l.y1,showOnHomePage:!1,category:"admin"}),u.stack.enabled&&t.management.sections.section.insightsAndAlerting.registerApp({id:l.sZ,title:o.B_,order:1,async mount(t){const[l,o]=await e.getStartServices(),{renderApp:c}=await s.e(106).then(s.bind(s,3106));return c({mountParams:t,coreStart:l,pluginsStart:o,storage:n,kibanaVersion:a,externalReferenceAttachmentTypeRegistry:i,persistableStateAttachmentTypeRegistry:r})}}),t.triggersActionsUi.actionTypeRegistry.register({id:l.Eg,iconClass:"casesApp",selectMessage:ne.SE,actionTypeTitle:l.pl,actionConnectorFields:null,isExperimental:!1,validateParams:async e=>{const t={timeWindow:[]},s={errors:t},a=new RegExp(l.L,"g");if(e.subActionParams){if(!e.subActionParams.timeWindow||!e.subActionParams.timeWindow.length||!a.test(e.subActionParams.timeWindow))return t.timeWindow.push(ne.M4),s;if(e.subActionParams.timeWindow){const s=e.subActionParams.timeWindow,a=s.slice(0,-1),n=s.slice(-1),i=Number(a);"m"===n&&i<5&&t.timeWindow.push(ne.$K)}}return s},actionParamsFields:(0,T.lazy)((()=>Promise.all([s.e(937),s.e(667)]).then(s.bind(s,667)))),isSystemActionType:!0}),(({analyticsService:e})=>{e.registerEventType({eventType:l.XR,schema:{owner:{type:"keyword",_meta:{description:"The solution ID (owner) that rendered the Cases page",optional:!1}}}}),e.registerEventType({eventType:l.L8,schema:{owner:{type:"keyword",_meta:{description:"The solution ID (owner) that created event attachments",optional:!1}},attachment_source:{type:"keyword",_meta:{description:"The exact place in the app where the attachment comes from",optional:!1}}}})})({analyticsService:e.analytics}),{attachmentFramework:{registerExternalReference:e=>{this.externalReferenceAttachmentTypeRegistry.register(e)},registerPersistableState:e=>{this.persistableStateAttachmentTypeRegistry.register(e)}}}}start(e,t){const a=this.initializerContext.config.get();r.P7.init({...e,...t,kibanaVersion:this.kibanaVersion,config:a});const n=(({externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s})=>{const a=({children:a,...n})=>(0,A.jsx)(E,(0,_.default)({},n,{externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s}),a);return a.displayName="CasesProviderLazyWrapperWithRegistry",()=>a})({externalReferenceAttachmentTypeRegistry:this.externalReferenceAttachmentTypeRegistry,persistableStateAttachmentTypeRegistry:this.persistableStateAttachmentTypeRegistry,getFilesClient:t.files.filesClientFactory.asScoped});var l,o;return l={externalReferenceAttachmentTypeRegistry:this.externalReferenceAttachmentTypeRegistry,persistableStateAttachmentTypeRegistry:this.persistableStateAttachmentTypeRegistry,getFilesClient:t.files.filesClientFactory.asScoped},(o={core:e,plugins:t,history:(0,i.createBrowserHistory)(),storage:this.storage}).plugins.uiActions.addTriggerActionAsync(se.CONTEXT_MENU_TRIGGER,ae._,(async()=>{const{createAddToExistingCaseLensAction:e}=await s.e(634).then(s.bind(s,8634));return e(l,o)})),{api:f({http:e.http}),ui:{getCases:e=>(0,k.M)({...e,externalReferenceAttachmentTypeRegistry:this.externalReferenceAttachmentTypeRegistry,persistableStateAttachmentTypeRegistry:this.persistableStateAttachmentTypeRegistry,getFilesClient:t.files.filesClientFactory.asScoped}),getCasesContext:n,getRecentCases:e=>(({externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s,owner:a,permissions:n,maxCasesToShow:i})=>(0,A.jsx)(M.CasesProvider,{value:{externalReferenceAttachmentTypeRegistry:e,persistableStateAttachmentTypeRegistry:t,getFilesClient:s,owner:a,permissions:n}},(0,A.jsx)(T.Suspense,{fallback:(0,A.jsx)(C.EuiLoadingSpinner,null)},(0,A.jsx)(O,{maxCasesToShow:i}))))({...e,externalReferenceAttachmentTypeRegistry:this.externalReferenceAttachmentTypeRegistry,persistableStateAttachmentTypeRegistry:this.persistableStateAttachmentTypeRegistry,getFilesClient:t.files.filesClientFactory.asScoped}),getAllCasesSelectorModal:e=>(0,x.z)({...e,externalReferenceAttachmentTypeRegistry:this.externalReferenceAttachmentTypeRegistry,persistableStateAttachmentTypeRegistry:this.persistableStateAttachmentTypeRegistry,getFilesClient:t.files.filesClientFactory.asScoped})},hooks:{useCasesAddToNewCaseFlyout:u.I,useCasesAddToExistingCaseModal:c.P,useIsAddToCaseOpen:p},helpers:{canUseCases:(0,y.$)(e.application.capabilities),getUICapabilities:P.r,getRuleIdFromEvent:h,groupAlertsByRule:F,getObservablesFromEcs:de}}}stop(){}}var pe=s(2712),ge=s(4345);function me(e){return new CasesUiPlugin(e)}},4513:e=>{"use strict";e.exports=function e(t,s){if(t===s)return!0;if(t&&s&&"object"==typeof t&&"object"==typeof s){if(t.constructor!==s.constructor)return!1;var a,n,i;if(Array.isArray(t)){if((a=t.length)!=s.length)return!1;for(n=a;0!==n--;)if(!e(t[n],s[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if((a=(i=Object.keys(t)).length)!==Object.keys(s).length)return!1;for(n=a;0!==n--;)if(!Object.prototype.hasOwnProperty.call(s,i[n]))return!1;for(n=a;0!==n--;){var r=i[n];if(!e(t[r],s[r]))return!1}return!0}return t!=t&&s!=s}},6563:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNavigator=t.isBrowser=t.off=t.on=t.noop=void 0,t.noop=function(){},t.on=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];e&&e.addEventListener&&e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)},t.isBrowser="undefined"!=typeof window,t.isNavigator="undefined"!=typeof navigator},6943:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(4286),n=s(6563).isBrowser?a.useLayoutEffect:a.useEffect;t.default=n},7880:(e,t,s)=>{"use strict";var a=s(1941),n=s(4286),i=a.__importDefault(s(6943));t.A=function(e,t){var s=n.useState(t),a=s[0],r=s[1];return i.default((function(){var t=e.subscribe(r);return function(){return t.unsubscribe()}}),[e]),a}},8638:(e,t,s)=>{s.p=window.__kbnPublicPath__.cases},6728:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/actions/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},7195:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},7546:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},8744:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},5296:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},791:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},2602:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},3631:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/esUiShared/static/validators/string");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1156:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/files/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},409:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},1215:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},227:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/lens/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},6260:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/savedObjectsFinder/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},4839:(e,t,s)=>{s.r(t);var a=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(a))},3185:(e,t,s)=>{e.exports=s(2497)(51858)},8915:(e,t,s)=>{e.exports=s(2497)(67493)},5927:e=>{"use strict";e.exports=__kbnSharedDeps__.Classnames},1319:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticEui},6752:e=>{"use strict";e.exports=__kbnSharedDeps__.ElasticNumeral},6791:e=>{"use strict";e.exports=__kbnSharedDeps__.EmotionReact},1639:e=>{"use strict";e.exports=__kbnSharedDeps__.FpTs.either},166:e=>{"use strict";e.exports=__kbnSharedDeps__.FpTs.function},6730:e=>{"use strict";e.exports=__kbnSharedDeps__.FpTs.pipeable},3782:e=>{"use strict";e.exports=__kbnSharedDeps__.IoTs},9424:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnCodeEditor},5964:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnEsQuery},5008:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18n},5879:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnI18nReact},911:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnMonaco},482:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaContextRender},5804:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnReactKibanaMount},5995:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnRison},193:e=>{"use strict";e.exports=__kbnSharedDeps__.KbnSharedUxRouter},770:e=>{"use strict";e.exports=__kbnSharedDeps__.Lodash},1060:e=>{"use strict";e.exports=__kbnSharedDeps__.LodashFp},1783:e=>{"use strict";e.exports=__kbnSharedDeps__.Moment},2488:e=>{"use strict";e.exports=__kbnSharedDeps__.MomentTimezone},4286:e=>{"use strict";e.exports=__kbnSharedDeps__.React},2874:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactDom},3530:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQuery},5692:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactQueryDevtools},1493:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactRouterDom},7583:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useDebounce},693:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.usePrevious},4897:e=>{"use strict";e.exports=__kbnSharedDeps__.ReactUse.useSessionStorage},190:e=>{"use strict";e.exports=__kbnSharedDeps__.Rxjs},5079:e=>{"use strict";e.exports=__kbnSharedDeps__.SaferLodashSet},1941:e=>{"use strict";e.exports=__kbnSharedDeps__.TsLib},9472:e=>{"use strict";e.exports=__kbnSharedDeps__.Uuid},2497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return n[e].call(s.exports,s,s.exports,r),s.exports}r.m=n,r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(s,a){if(1&a&&(s=this(s)),8&a)return s;if("object"==typeof s&&s){if(4&a&&s.__esModule)return s;if(16&a&&"function"==typeof s.then)return s}var n=Object.create(null);r.r(n);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&a&&s;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>i[e]=()=>s[e]));return i.default=()=>s,r.d(n,i),n},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,s)=>(r.f[s](e,t),t)),[])),r.u=e=>"cases.chunk."+e+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s={},a="@kbn/cases-plugin:",r.l=(e,t,n,i)=>{if(s[e])s[e].push(t);else{var l,o;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==a+n){l=d;break}}l||(o=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.setAttribute("data-webpack",a+n),l.src=e),s[e]=[t];var p=(t,a)=>{l.onerror=l.onload=null,clearTimeout(g);var n=s[e];if(delete s[e],l.parentNode&&l.parentNode.removeChild(l),n&&n.forEach((e=>e(a))),t)return t(a)},g=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),o&&document.head.appendChild(l)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var a=s.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=s[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={794:0};r.f.j=(t,s)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)s.push(a[2]);else{var n=new Promise(((s,n)=>a=e[t]=[s,n]));s.push(a[2]=n);var i=r.p+r.u(t),l=new Error;r.l(i,(s=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var n=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",l.name="ChunkLoadError",l.type=n,l.request=i,a[1](l)}}),"chunk-"+t,t)}};var t=(t,s)=>{var a,n,[i,l,o]=s,c=0;if(i.some((t=>0!==e[t]))){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);o&&o(r)}for(t&&t(s);c<i.length;c++)n=i[c],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0},s=self.cases_bundle_jsonpfunction=self.cases_bundle_jsonpfunction||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),r(8638),__kbnBundles__.define("plugin/cases/public",r,7455),__kbnBundles__.define("plugin/cases/common",r,9113)})();