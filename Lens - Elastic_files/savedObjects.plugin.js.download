(()=>{var e={588:(e,t,s)=>{"use strict";let i;s.r(t),s.d(t,{SavedObjectSaveModal:()=>h,SavedObjectSaveModalOrigin:()=>g,SavedObjectSaveModalWithSaveResult:()=>v,isErrorNonFatal:()=>S,plugin:()=>O,showSaveModal:()=>m});const a=()=>i.rendering;class SavedObjectsPublicPlugin{setup(){return{}}start(e,{data:t,dataViews:s}){return function(e){i=e}(e),{}}}var o=s(915);const n=__kbnSharedDeps__.ElasticEui,r=__kbnSharedDeps__.KbnI18nReact,l=__kbnSharedDeps__.React;var p=s.n(l);const d=__kbnSharedDeps__.KbnI18n,u=__kbnSharedDeps__.EmotionReact,c=(0,n.htmlIdGenerator)();class SavedObjectSaveModalComponent extends p().Component{constructor(...e){super(...e),(0,o.default)(this,"warning",p().createRef()),(0,o.default)(this,"formId",c("form")),(0,o.default)(this,"state",{title:this.props.title,copyOnSave:Boolean(this.props.initialCopyOnSave),isTitleDuplicateConfirmed:!1,hasTitleDuplicate:!1,isSaving:!1,visualizationDescription:this.props.description?this.props.description:"",hasAttemptedSubmit:!1}),(0,o.default)(this,"renderViewDescription",(()=>{if(this.props.showDescription)return(0,u.jsx)(n.EuiFormRow,{fullWidth:!0,labelAppend:(0,u.jsx)(n.EuiText,{size:"xs",color:"subdued"},(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.optional",defaultMessage:"Optional"})),label:(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.descriptionLabel",defaultMessage:"Description"})},(0,u.jsx)(n.EuiTextArea,{fullWidth:!0,"data-test-subj":"savedObjectDescription",value:this.state.visualizationDescription,onChange:this.onDescriptionChange}))})),(0,o.default)(this,"onDescriptionChange",(e=>{this.setState({visualizationDescription:e.target.value})})),(0,o.default)(this,"onTitleDuplicate",(()=>{this.setState({isSaving:!1,isTitleDuplicateConfirmed:!0,hasTitleDuplicate:!0}),this.warning.current&&this.warning.current.focus()})),(0,o.default)(this,"saveSavedObject",(async()=>{if(!this.state.isSaving){this.setState({isSaving:!0});try{await this.props.onSave({newTitle:this.state.title,newCopyOnSave:Boolean(this.props.mustCopyOnSaveMessage)||this.state.copyOnSave,isTitleDuplicateConfirmed:this.state.isTitleDuplicateConfirmed,onTitleDuplicate:this.onTitleDuplicate,newDescription:this.state.visualizationDescription})}finally{this.setState({isSaving:!1})}}})),(0,o.default)(this,"onTitleChange",(e=>{this.setState({title:e.target.value,isTitleDuplicateConfirmed:!1,hasTitleDuplicate:!1})})),(0,o.default)(this,"handleTitleDuplication",(()=>{const e=/\s*\[(\d+)\]$/,t=this.state.title.match(e);if(t){const s=Number(t[1])+1;this.setState({title:this.state.title.replace(e,` [${s}]`)})}else this.setState({title:this.state.title+" [1]"})})),(0,o.default)(this,"onCopyOnSaveChange",(e=>{this.props.title===this.state.title&&e.target.checked&&this.handleTitleDuplication(),this.setState({copyOnSave:e.target.checked}),this.props.onCopyOnSaveChange&&this.props.onCopyOnSaveChange(e.target.checked)})),(0,o.default)(this,"onFormSubmit",(e=>{e.preventDefault();const{hasAttemptedSubmit:t,title:s}=this.state;t||this.setState({hasAttemptedSubmit:!0});const i=void 0===this.props.isValid||this.props.isValid;0!==s.length&&i&&this.saveSavedObject()})),(0,o.default)(this,"renderConfirmButton",(()=>{const{isSaving:e}=this.state;let t=d.i18n.translate("savedObjects.saveModal.saveButtonLabel",{defaultMessage:"Save"});return this.props.confirmButtonLabel&&(t=this.props.confirmButtonLabel),(0,u.jsx)(n.EuiButton,{fill:!0,"data-test-subj":"confirmSaveSavedObjectButton",isLoading:e,type:"submit",form:this.formId},t)})),(0,o.default)(this,"renderDuplicateTitleCallout",(e=>{if(this.state.hasTitleDuplicate)return(0,u.jsx)(p().Fragment,null,(0,u.jsx)("div",{ref:this.warning,tabIndex:-1},(0,u.jsx)(n.EuiCallOut,{title:(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.duplicateTitleLabel",defaultMessage:"This {objectType} already exists",values:{objectType:this.props.objectType}}),color:"warning","data-test-subj":"titleDuplicateWarnMsg",id:e},(0,u.jsx)("p",null,(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.duplicateTitleDescription",defaultMessage:"Saving ''{title}'' creates a duplicate title.",values:{title:this.state.title}})))),(0,u.jsx)(n.EuiSpacer,null))})),(0,o.default)(this,"renderCopyOnSave",(()=>(0,u.jsx)(p().Fragment,null,(0,u.jsx)(n.EuiFlexItem,{grow:!1},(0,u.jsx)(n.EuiSwitch,{"data-test-subj":"saveAsNewCheckbox",checked:Boolean(this.props.mustCopyOnSaveMessage)||this.state.copyOnSave,disabled:Boolean(this.props.mustCopyOnSaveMessage),onChange:this.onCopyOnSaveChange,label:(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.saveAsNewLabel",defaultMessage:"Save as new {objectType}",values:{objectType:this.props.objectType}})})),this.props.mustCopyOnSaveMessage&&(0,u.jsx)(n.EuiFlexItem,{css:({euiTheme:e})=>({marginLeft:`-${e.size.base}`}),grow:!1},(0,u.jsx)(n.EuiIconTip,{type:"info",content:this.props.mustCopyOnSaveMessage})),(0,u.jsx)(n.EuiFlexItem,{grow:!0}))))}render(){const{theme:e}=this.props,{isTitleDuplicateConfirmed:t,hasTitleDuplicate:s,title:i,hasAttemptedSubmit:a}=this.state,o=c(),l=c("saveModal"),h=!!this.props.rightOptions,v=a&&(!t&&s||0===i.length),g=(0,u.jsx)(p().Fragment,null,(0,u.jsx)(n.EuiFormRow,{fullWidth:!0,label:(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.titleLabel",defaultMessage:"Title"}),isInvalid:v,error:d.i18n.translate("savedObjects.saveModal.titleRequired",{defaultMessage:"A title is required"})},(0,u.jsx)(n.EuiFieldText,{fullWidth:!0,"data-test-subj":"savedObjectTitle",value:i,onChange:this.onTitleChange,isInvalid:v,"aria-describedby":this.state.hasTitleDuplicate?o:void 0})),this.renderViewDescription(),"function"==typeof this.props.options?this.props.options(this.state):this.props.options),b=h?(0,u.jsx)(n.EuiFlexGroup,{gutterSize:"m"},(0,u.jsx)(n.EuiFlexItem,null,g),(0,u.jsx)(n.EuiFlexItem,null,"function"==typeof this.props.rightOptions?this.props.rightOptions(this.state):this.props.rightOptions)):g,m=(0,u.css)({width:h?(0,n.mathWithUnits)(e.euiTheme.size.xxl,(e=>20*e)):(0,n.mathWithUnits)(e.euiTheme.size.xxl,(e=>15*e))},"","");return(0,u.jsx)(n.EuiModal,{"data-test-subj":"savedObjectSaveModal",onClose:this.props.onClose,css:m,"aria-labelledby":l},(0,u.jsx)(n.EuiModalHeader,null,(0,u.jsx)(n.EuiModalHeaderTitle,{id:l},this.props.customModalTitle?this.props.customModalTitle:(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.saveTitle",defaultMessage:"Save {objectType}",values:{objectType:this.props.objectType}}))),(0,u.jsx)(n.EuiModalBody,null,this.renderDuplicateTitleCallout(o),(0,u.jsx)(n.EuiForm,{component:"form",onSubmit:this.onFormSubmit,id:this.formId},!this.props.showDescription&&this.props.description&&(0,u.jsx)(n.EuiText,{size:"s",color:"subdued"},this.props.description),b)),(0,u.jsx)(n.EuiModalFooter,null,(0,u.jsx)(n.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},this.props.showCopyOnSave&&this.renderCopyOnSave(),(0,u.jsx)(n.EuiFlexItem,{grow:!1},(0,u.jsx)(n.EuiButtonEmpty,{"data-test-subj":"saveCancelButton",onClick:this.props.onClose},(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModal.cancelButtonLabel",defaultMessage:"Cancel"}))),(0,u.jsx)(n.EuiFlexItem,{grow:!1},this.renderConfirmButton()))))}}const h=(0,n.withEuiTheme)(SavedObjectSaveModalComponent),v=(0,n.withEuiTheme)(SavedObjectSaveModalComponent);function g(e){const[t,s]=(0,l.useState)(Boolean(e.originatingApp)),{documentInfo:i}=e,a=d.i18n.translate("savedObjects.saveModalOrigin.returnToOriginLabel",{defaultMessage:"Return"}),o=d.i18n.translate("savedObjects.saveModalOrigin.addToOriginLabel",{defaultMessage:"Add"}),p=t?d.i18n.translate("savedObjects.saveModalOrigin.saveAndReturnLabel",{defaultMessage:"Save and return"}):null;return(0,u.jsx)(v,{onSave:async s=>e.onSave({...s,returnToOrigin:t}),onClose:e.onClose,title:i.title,showCopyOnSave:!!i.id,initialCopyOnSave:Boolean(i.id)&&t,confirmButtonLabel:p,objectType:e.objectType,options:p=>{const d="function"==typeof e.options?e.options(p):e.options;if(!e.originatingApp)return d;const c=e.getAppNameFromId&&e.getAppNameFromId(e.originatingApp)||e.originatingApp;if(p.copyOnSave&&"dashboards"!==e.originatingApp)return s(!1),d;{var h;const v=!i.id||p.copyOnSave?o:a;return(0,u.jsx)(l.Fragment,null,d,(0,u.jsx)(n.EuiFormRow,null,(0,u.jsx)(n.EuiSwitch,{"data-test-subj":"returnToOriginModeSwitch",checked:t,onChange:e=>{s(e.target.checked)},label:null!==(h=e.returnToOriginSwitchLabel)&&void 0!==h?h:(0,u.jsx)(r.FormattedMessage,{id:"savedObjects.saveModalOrigin.originAfterSavingSwitchLabel",defaultMessage:"{originVerb} to {origin} after saving",values:{originVerb:v,origin:c}})})))}},description:i.description,showDescription:!0})}const b=__kbnSharedDeps__.KbnReactKibanaMount;function m(e,t){let s;const i=(0,b.toMountPoint)(p().createElement((function(){const i=()=>{s(),setTimeout((()=>{var t,s;null===(t=(s=e.props).onClose)||void 0===t||t.call(s)}),0)},a=e.props.onSave,o=p().cloneElement(e,{onSave:async(...e)=>{try{const t=await a(...e);return Boolean("id"in t?t.id:t.error)&&i(),t}catch(e){return i(),{error:e}}},onClose:i});return p().createElement(null!=t?t:p().Fragment,{children:o})})),a());s=i(document.createElement("div"))}const j=d.i18n.translate("savedObjects.overwriteRejectedDescription",{defaultMessage:"Overwrite confirmation was rejected"}),f=d.i18n.translate("savedObjects.saveDuplicateRejectedDescription",{defaultMessage:"Save with duplicate title confirmation was rejected"});function S(e){return!!e&&(e.message===j||e.message===f)}const O=()=>new SavedObjectsPublicPlugin},529:(e,t,s)=>{s.p=window.__kbnPublicPath__.savedObjects},915:(e,t,s)=>{e.exports=s(497)(67493)},497:e=>{"use strict";e.exports=__kbnSharedDeps_npm__}},t={};function s(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var a=i.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=i[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),s(529),__kbnBundles__.define("plugin/savedObjects/public",s,588)})();